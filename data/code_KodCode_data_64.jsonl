{"id": "21054f68d6cdf48e207a39c7666dd60562dac74c25298dcee5f2054c1118dd37", "source": "KodCode", "difficulty": "0.8", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef min_jumps(X: int, M: int, heights: List[int]) -> int:\n    \"\"\" \n    Returns the minimum number of jumps required to reach the top of the staircase.\n    :param X: int, maximum steps that can be taken in a single jump\n    :param M: int, the number of steps in the staircase\n    :param heights: list of int, heights of each step\n    :return: int, minimum number of jumps to reach the top \n\n    >>> min_jumps(3, 5, [1, 1, 1, 1, 1])\n    2\n    >>> min_jumps(5, 5, [1, 1, 1, 1, 1])\n    1\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef min_jumps(X: int, M: int, heights: List[int]) -> int:\\n    \\\"\\\"\\\" \\n    Returns the minimum number of jumps required to reach the top of the staircase.\\n    :param X: int, maximum steps that can be taken in a single jump\\n    :param M: int, the number of steps in the staircase\\n    :param heights: list of int, heights of each step\\n    :return: int, minimum number of jumps to reach the top \\n\\n    >>> min_jumps(3, 5, [1, 1, 1, 1, 1])\\n    2\\n    >>> min_jumps(5, 5, [1, 1, 1, 1, 1])\\n    1\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def min_jumps(X, M, heights):\\n    \\\"\\\"\\\"\\n    Returns the minimum number of jumps required to reach the top of the staircase.\\n    :param X: int, maximum steps that can be taken in a single jump\\n    :param M: int, the number of steps in the staircase\\n    :param heights: list of int, heights of each step (though in this problem, the heights do not matter)\\n    :return: int, minimum number of jumps to reach the top\\n    \\\"\\\"\\\"\\n    # To reach the top (M steps), we calculate the jumps by dividing M by X and \\n    # rounding up to cover any remaining steps.\\n    min_jumps = (M + X - 1) // X\\n    return min_jumps\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_min_jumps_basic():\\n    assert min_jumps(3, 5, [1, 1, 1, 1, 1]) == 2\\n\\ndef test_min_jumps_single_jump():\\n    assert min_jumps(5, 5, [1, 1, 1, 1, 1]) == 1\\n\\ndef test_min_jumps_max_steps():\\n    assert min_jumps(4, 10, [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]) == 3\\n\\ndef test_min_jumps_small_steps():\\n    assert min_jumps(1, 100, [1]*100) == 100\\n\\ndef test_min_jumps_edges():\\n    assert min_jumps(1, 1, [1]) == 1\\n    assert min_jumps(2, 1, [1]) == 1\\n    assert min_jumps(1, 2, [1, 1]) == 2\\n    assert min_jumps(3, 7, [1, 1, 1, 1, 1, 1, 1]) == 3\\n    assert min_jumps(6, 17, [1]*17) == 3\"}]", "tag": "KodCode"}
{"id": "483388da7d5346300942904e25b2cc5b36882944e52874a086ac9eece2c22134", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Create a Python function to find the median of a list of numbers. The function should handle both even and odd lengths of the list and return the correct median value. If the list is empty, the function should return `None`. Make sure to write a function that is self-contained, clear, and uses a check function to verify correctness with provided data points.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef find_median(numbers):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Create a Python function to find the median of a list of numbers. The function should handle both even and odd lengths of the list and return the correct median value. If the list is empty, the function should return `None`. Make sure to write a function that is self-contained, clear, and uses a check function to verify correctness with provided data points.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef find_median(numbers):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def find_median(numbers):\\n    \\\"\\\"\\\"\\n    Finds the median of a list of numbers.\\n    \\n    Args:\\n    numbers (list of float or int): The list of numbers.\\n    \\n    Returns:\\n    float or int or None: The median of the list, or None if the list is empty.\\n    \\\"\\\"\\\"\\n    if not numbers:\\n        return None\\n    \\n    sorted_numbers = sorted(numbers)\\n    n = len(sorted_numbers)\\n    mid = n // 2\\n    \\n    if n % 2 == 0:\\n        # For even-length list, median is the average of the two middle numbers\\n        return (sorted_numbers[mid - 1] + sorted_numbers[mid]) / 2\\n    else:\\n        # For odd-length list, median is the middle number\\n        return sorted_numbers[mid]\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_find_median_empty():\\n    assert find_median([]) == None\\n\\ndef test_find_median_single_element():\\n    assert find_median([5]) == 5\\n\\ndef test_find_median_odd_length():\\n    assert find_median([3, 1, 2]) == 2\\n\\ndef test_find_median_even_length():\\n    assert find_median([4, 2, 3, 1]) == 2.5\\n\\ndef test_find_median_unsorted_list():\\n    assert find_median([7, 1, 5, 3, 9]) == 5\\n\\ndef test_find_median_floats():\\n    assert find_median([1.1, 2.2, 3.3, 4.4]) == 2.75\\n\\ndef test_find_median_mixed_numbers():\\n    assert find_median([1, -1, 0, -2, 2]) == 0\\n\\ndef test_find_median_large_numbers():\\n    assert find_median(list(range(1000000))) == 499999.5\\n\\ndef test_find_median_negative_numbers():\\n    assert find_median([-5, -1, -3, -2, -4]) == -3\"}]", "tag": "KodCode"}
{"id": "7e33f1b156bed90de65f353ecf6a155b0174e5935568c14655e052acf41c0738", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Alice has recently learned about the concept of \"bitwise AND\" and is excited to apply it to solve some challenges. She has an array `a` of `n` integers `a0, a1, ..., an-1`. She also has an integer `k`. Alice is curious to know what is the minimum bitwise AND value that can be obtained by considering any contiguous subarray of length exactly `k`.\n\nGiven the array `a` and the integer `k`, help Alice find the minimum bitwise AND value among all possible contiguous subarrays of length `k`.\n\nThe bitwise AND of a subarray [ai, ai+1, ..., ai+k-1] is defined as `ai AND ai+1 AND ... AND ai+k-1`.\n\n-----Input-----\n\nThe first line contains two integers `n` (1 ≤ n ≤ 10^5) and `k` (1 ≤ k ≤ n) — the number of elements in the array and the length of the subarray respectively. The second line contains `n` space-separated integers `a0, a1, ..., an-1` (0 ≤ ai ≤ 10^6) — the elements of the array a.\n\n-----Output-----\n\nPrint a single integer — the minimum bitwise AND value among all contiguous subarrays of length `k`.\n\n-----Examples-----\nInput\n4 2\n1 2 3 4\n\nOutput\n0\n\nInput\n3 2\n5 5 5\n\nOutput\n5\n\nInput\n5 3\n6 7 8 9 10\n\nOutput\n0\n\n-----Note-----\n\nIn the first test case, the contiguous subarrays of length 2 are:\n- [1, 2] with bitwise AND = 1 AND 2 = 0\n- [2, 3] with bitwise AND = 2 AND 3 = 2\n- [3, 4] with bitwise AND = 3 AND 4 = 0\n\nThe minimum bitwise AND value among these subarrays is 0.\n\nIn the second test case, the only contiguous subarrays of length 2 is:\n- [5, 5] with bitwise AND = 5 AND 5 = 5\n\nThe minimum bitwise AND value among this subarray is 5.\n\nIn the third test case, the contiguous subarrays of length 3 are:\n- [6, 7, 8] with bitwise AND = 6 AND 7 AND 8 = 0\n- [7, 8, 9] with bitwise AND = 7 AND 8 AND 9 = 0\n- [8, 9, 10] with bitwise AND = 8 AND 9 AND 10 = 0\n\nThe minimum bitwise AND value among these subarrays is 0.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef min_bitwise_and_subarray(n, k, a):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Alice has recently learned about the concept of \\\"bitwise AND\\\" and is excited to apply it to solve some challenges. She has an array `a` of `n` integers `a0, a1, ..., an-1`. She also has an integer `k`. Alice is curious to know what is the minimum bitwise AND value that can be obtained by considering any contiguous subarray of length exactly `k`.\\n\\nGiven the array `a` and the integer `k`, help Alice find the minimum bitwise AND value among all possible contiguous subarrays of length `k`.\\n\\nThe bitwise AND of a subarray [ai, ai+1, ..., ai+k-1] is defined as `ai AND ai+1 AND ... AND ai+k-1`.\\n\\n-----Input-----\\n\\nThe first line contains two integers `n` (1 ≤ n ≤ 10^5) and `k` (1 ≤ k ≤ n) — the number of elements in the array and the length of the subarray respectively. The second line contains `n` space-separated integers `a0, a1, ..., an-1` (0 ≤ ai ≤ 10^6) — the elements of the array a.\\n\\n-----Output-----\\n\\nPrint a single integer — the minimum bitwise AND value among all contiguous subarrays of length `k`.\\n\\n-----Examples-----\\nInput\\n4 2\\n1 2 3 4\\n\\nOutput\\n0\\n\\nInput\\n3 2\\n5 5 5\\n\\nOutput\\n5\\n\\nInput\\n5 3\\n6 7 8 9 10\\n\\nOutput\\n0\\n\\n-----Note-----\\n\\nIn the first test case, the contiguous subarrays of length 2 are:\\n- [1, 2] with bitwise AND = 1 AND 2 = 0\\n- [2, 3] with bitwise AND = 2 AND 3 = 2\\n- [3, 4] with bitwise AND = 3 AND 4 = 0\\n\\nThe minimum bitwise AND value among these subarrays is 0.\\n\\nIn the second test case, the only contiguous subarrays of length 2 is:\\n- [5, 5] with bitwise AND = 5 AND 5 = 5\\n\\nThe minimum bitwise AND value among this subarray is 5.\\n\\nIn the third test case, the contiguous subarrays of length 3 are:\\n- [6, 7, 8] with bitwise AND = 6 AND 7 AND 8 = 0\\n- [7, 8, 9] with bitwise AND = 7 AND 8 AND 9 = 0\\n- [8, 9, 10] with bitwise AND = 8 AND 9 AND 10 = 0\\n\\nThe minimum bitwise AND value among these subarrays is 0.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef min_bitwise_and_subarray(n, k, a):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def min_bitwise_and_subarray(n, k, a):\\n    min_and = float('inf')\\n    \\n    for i in range(n - k + 1):\\n        current_and = a[i]\\n        for j in range(1, k):\\n            current_and &= a[i + j]\\n        if current_and < min_and:\\n            min_and = current_and\\n\\n    return min_and\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_example_1():\\n    assert min_bitwise_and_subarray(4, 2, [1, 2, 3, 4]) == 0\\n\\ndef test_example_2():\\n    assert min_bitwise_and_subarray(3, 2, [5, 5, 5]) == 5\\n\\ndef test_example_3():\\n    assert min_bitwise_and_subarray(5, 3, [6, 7, 8, 9, 10]) == 0\\n\\ndef test_single_element_array():\\n    assert min_bitwise_and_subarray(1, 1, [7]) == 7\\n\\ndef test_all_zeros():\\n    assert min_bitwise_and_subarray(5, 3, [0, 0, 0, 0, 0]) == 0\\n\\ndef test_increasing_sequence():\\n    assert min_bitwise_and_subarray(5, 2, [1, 2, 3, 4, 5]) == 0\\n\\ndef test_max_values():\\n    assert min_bitwise_and_subarray(3, 2, [10**6, 10**6, 10**6]) == 10**6\"}]", "tag": "KodCode"}
{"id": "1aecdd77497afde9fec5254ec332efc9f63a714adc60964554a836fc972eb2b7", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: How can I create a Python script that monitors a directory for changes, such as new files being added, and then processes these files by moving them to another directory? I want to ensure that the script runs continuously and efficiently handles multiple files being added at once.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\n# Update the processed files set\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: How can I create a Python script that monitors a directory for changes, such as new files being added, and then processes these files by moving them to another directory? I want to ensure that the script runs continuously and efficiently handles multiple files being added at once.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\n# Update the processed files set\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"import os\\nimport time\\nimport shutil\\n\\ndef monitor_directory(source_dir, dest_dir, interval=1):\\n    \\\"\\\"\\\"\\n    Monitors the source directory for new files and moves them to the destination directory.\\n\\n    :param source_dir: Path to the directory to monitor.\\n    :param dest_dir: Path to the directory where new files should be moved.\\n    :param interval: Time in seconds between checks of the source directory.\\n    \\\"\\\"\\\"\\n    # Check if source and destination directories exist\\n    if not os.path.exists(source_dir):\\n        raise FileNotFoundError(f\\\"The source directory '{source_dir}' does not exist\\\")\\n    if not os.path.exists(dest_dir):\\n        raise FileNotFoundError(f\\\"The destination directory '{dest_dir}' does not exist\\\")\\n    \\n    # Set of already processed files\\n    processed_files = set()\\n\\n    while True:\\n        # Get the current list of files in the source directory\\n        current_files = set(os.listdir(source_dir))\\n        \\n        # Determine new files by finding the difference between current files and processed files\\n        new_files = current_files - processed_files\\n        \\n        for file_name in new_files:\\n            source_path = os.path.join(source_dir, file_name)\\n            dest_path = os.path.join(dest_dir, file_name)\\n            \\n            # Move the file from the source to destination directory\\n            shutil.move(source_path, dest_path)\\n            print(f\\\"Moved file: {file_name}\\\")\\n        \\n        # Update the processed files set\\n        processed_files.update(new_files)\\n        \\n        # Wait for the given interval before checking again\\n        time.sleep(interval)\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\nimport os\\nimport pytest\\nimport shutil\\nimport threading\\nimport time\\n\\nSOURCE_DIR = \\\"test_source_dir\\\"\\nDEST_DIR = \\\"test_dest_dir\\\"\\n\\n@pytest.fixture(scope=\\\"module\\\", autouse=True)\\ndef setup_and_teardown():\\n    # Setup: Create test directories\\n    os.makedirs(SOURCE_DIR, exist_ok=True)\\n    os.makedirs(DEST_DIR, exist_ok=True)\\n    yield\\n    # Teardown: Cleanup test directories and files\\n    shutil.rmtree(SOURCE_DIR)\\n    shutil.rmtree(DEST_DIR)\\n\\ndef test_monitor_directory():\\n    def create_test_files():\\n        # Simulate adding files to the source directory\\n        time.sleep(1)  # Ensure monitor_directory has time to start\\n        with open(os.path.join(SOURCE_DIR, \\\"file1.txt\\\"), \\\"w\\\") as f:\\n            f.write(\\\"This is a test file 1.\\\")\\n        with open(os.path.join(SOURCE_DIR, \\\"file2.txt\\\"), \\\"w\\\") as f:\\n            f.write(\\\"This is a test file 2.\\\")\\n    \\n    # Start the directory monitor in a separate thread\\n    monitor_thread = threading.Thread(target=monitor_directory, args=(SOURCE_DIR, DEST_DIR, 0.5), daemon=True)\\n    monitor_thread.start()\\n    \\n    # Create test files\\n    create_test_files()\\n\\n    # Allow some time for the monitor to process the files\\n    time.sleep(2)\\n    \\n    # Check if files are moved to the destination directory\\n    assert not os.listdir(SOURCE_DIR)  # Source directory should be empty\\n    assert set(os.listdir(DEST_DIR)) == {\\\"file1.txt\\\", \\\"file2.txt\\\"}  # Files should be in the destination directory\"}]", "tag": "KodCode"}
{"id": "2a29cd070a83d95b26901893efb7699108778fdba8756d09da0a725c042f8582", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: ### Question: Managing Accelerator Devices with PyTorch\n\nIn this question, you are required to demonstrate your understanding of managing computational accelerators (e.g., GPUs) using the `torch.accelerator` module. You will write a function that performs the following tasks:\n\n1. Checks if an accelerator is available.\n2. Retrieves and prints the number of available devices.\n3. Sets the device to a specified index (if it's within the range of available devices).\n4. Retrieves and prints the current device index.\n5. Synchronizes the device.\n\nComplete the function `manage_accelerator(index)` which takes an integer `index` as input and performs the tasks mentioned above. If the provided `index` is out of range, the function should raise a `ValueError`.\n\n#### Function Signature\n```python\ndef manage_accelerator(index: int) -> None:\n    pass\n```\n\n#### Input\n- `index` (int): The index of the device to be set.\n\n#### Output\n- None: The function should print the relevant information and raise exceptions as required.\n\n#### Constraints\n- Use the functions from the `torch.accelerator` module to achieve the desired functionality.\n- The function should handle scenarios where the specified device index is out of range gracefully by raising a `ValueError`.\n\n#### Example\n```python\n# Assuming the system has 1 accelerator available.\nmanage_accelerator(0)\n# Output:\n# Accelerators available: Yes\n# Number of devices: 1\n# Current device index set to: 0\n# Device index now: 0\n# Device synchronized\n```\n\n```python\n# Assuming the system has 2 accelerators available.\nmanage_accelerator(3)\n# Output:\n# Accelerators available: Yes\n# Number of devices: 2\n# ValueError: Device index out of range\n```\n\n#### Note\nMake sure you handle synchronization properly by utilizing the `synchronize` function after setting the device.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef manage_accelerator(index: int) -> None:\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: ### Question: Managing Accelerator Devices with PyTorch\\n\\nIn this question, you are required to demonstrate your understanding of managing computational accelerators (e.g., GPUs) using the `torch.accelerator` module. You will write a function that performs the following tasks:\\n\\n1. Checks if an accelerator is available.\\n2. Retrieves and prints the number of available devices.\\n3. Sets the device to a specified index (if it's within the range of available devices).\\n4. Retrieves and prints the current device index.\\n5. Synchronizes the device.\\n\\nComplete the function `manage_accelerator(index)` which takes an integer `index` as input and performs the tasks mentioned above. If the provided `index` is out of range, the function should raise a `ValueError`.\\n\\n#### Function Signature\\n```python\\ndef manage_accelerator(index: int) -> None:\\n    pass\\n```\\n\\n#### Input\\n- `index` (int): The index of the device to be set.\\n\\n#### Output\\n- None: The function should print the relevant information and raise exceptions as required.\\n\\n#### Constraints\\n- Use the functions from the `torch.accelerator` module to achieve the desired functionality.\\n- The function should handle scenarios where the specified device index is out of range gracefully by raising a `ValueError`.\\n\\n#### Example\\n```python\\n# Assuming the system has 1 accelerator available.\\nmanage_accelerator(0)\\n# Output:\\n# Accelerators available: Yes\\n# Number of devices: 1\\n# Current device index set to: 0\\n# Device index now: 0\\n# Device synchronized\\n```\\n\\n```python\\n# Assuming the system has 2 accelerators available.\\nmanage_accelerator(3)\\n# Output:\\n# Accelerators available: Yes\\n# Number of devices: 2\\n# ValueError: Device index out of range\\n```\\n\\n#### Note\\nMake sure you handle synchronization properly by utilizing the `synchronize` function after setting the device.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef manage_accelerator(index: int) -> None:\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"import torch\\n\\ndef manage_accelerator(index: int) -> None:\\n    \\\"\\\"\\\"\\n    Manages the accelerator device based on the provided index.\\n    \\n    Args:\\n    - index (int): The index of the device to set.\\n    \\n    Raises:\\n    - ValueError: If the index is out of range of available devices.\\n    \\\"\\\"\\\"\\n    # Check if any accelerator devices are available\\n    if torch.cuda.is_available():\\n        print(\\\"Accelerators available: Yes\\\")\\n        \\n        num_devices = torch.cuda.device_count()\\n        print(f\\\"Number of devices: {num_devices}\\\")\\n        \\n        # Verify that the provided index is within range\\n        if index < 0 or index >= num_devices:\\n            raise ValueError(\\\"Device index out of range\\\")\\n        \\n        # Set the current device\\n        torch.cuda.set_device(index)\\n        print(f\\\"Current device index set to: {index}\\\")\\n        \\n        # Retrieve and print the current device index\\n        current_device = torch.cuda.current_device()\\n        print(f\\\"Device index now: {current_device}\\\")\\n        \\n        # Synchronize the device\\n        torch.cuda.synchronize()\\n        print(\\\"Device synchronized\\\")\\n    else:\\n        print(\\\"Accelerators available: No\\\")\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\nimport pytest\\nfrom io import StringIO\\nimport sys\\n\\n\\ndef capture_output(func, *args, **kwargs):\\n    \\\"\\\"\\\"\\n    Helper function to capture the stdout output for testing.\\n    \\\"\\\"\\\"\\n    old_out = sys.stdout\\n    sys.stdout = mystdout = StringIO()\\n    try:\\n        func(*args, **kwargs)\\n    finally:\\n        sys.stdout = old_out\\n    return mystdout.getvalue()\\n\\ndef test_manage_accelerator_no_devices(monkeypatch):\\n    \\\"\\\"\\\"\\n    Test the scenario when no accelerators are available.\\n    \\\"\\\"\\\"\\n    def mock_is_available():\\n        return False\\n\\n    monkeypatch.setattr(torch.cuda, 'is_available', mock_is_available)\\n    \\n    output = capture_output(manage_accelerator, 0)\\n    assert \\\"Accelerators available: No\\\" in output\\n\\ndef test_manage_accelerator_single_device(monkeypatch):\\n    \\\"\\\"\\\"\\n    Test managing a single available device.\\n    \\\"\\\"\\\"\\n    def mock_is_available():\\n        return True\\n        \\n    def mock_device_count():\\n        return 1\\n    \\n    def mock_set_device(index):\\n        pass\\n    \\n    def mock_current_device():\\n        return 0\\n    \\n    def mock_synchronize():\\n        pass\\n\\n    monkeypatch.setattr(torch.cuda, 'is_available', mock_is_available)\\n    monkeypatch.setattr(torch.cuda, 'device_count', mock_device_count)\\n    monkeypatch.setattr(torch.cuda, 'set_device', mock_set_device)\\n    monkeypatch.setattr(torch.cuda, 'current_device', mock_current_device)\\n    monkeypatch.setattr(torch.cuda, 'synchronize', mock_synchronize)\\n    \\n    output = capture_output(manage_accelerator, 0)\\n    assert \\\"Accelerators available: Yes\\\" in output\\n    assert \\\"Number of devices: 1\\\" in output\\n    assert \\\"Current device index set to: 0\\\" in output\\n    assert \\\"Device index now: 0\\\" in output\\n    assert \\\"Device synchronized\\\" in output\\n\\ndef test_manage_accelerator_index_out_of_range(monkeypatch):\\n    \\\"\\\"\\\"\\n    Test managing a scenario where the provided index is out of range.\\n    \\\"\\\"\\\"\\n    def mock_is_available():\\n        return True\\n        \\n    def mock_device_count():\\n        return 2\\n\\n    monkeypatch.setattr(torch.cuda, 'is_available', mock_is_available)\\n    monkeypatch.setattr(torch.cuda, 'device_count', mock_device_count)\\n    \\n    with pytest.raises(ValueError) as excinfo:\\n        manage_accelerator(3)\\n    assert \\\"Device index out of range\\\" in str(excinfo.value)\"}]", "tag": "KodCode"}
{"id": "1bf7302507c00dbf305d50d15d696ad2a8fe8b36afc28197fd48b781550f583f", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: You are given an array A of N integers. You can perform the following operation any number of times (including zero times):\n\nChoose any two indices i and j (1 ≤ i, j ≤ N, i ≠ j) and replace A_{i} with gcd(A_{i}, A_{j}), where gcd(a, b) is the greatest common divisor of a and b.\n\nDetermine the maximum possible GCD of the array after performing any number of operations.\n\n------ Input Format ------ \n\n- The first line contains an integer T denoting the number of test cases. The T test cases then follow.\n- The first line of each test case contains an integer N - the size of the array.\n- The second line of each test case contains N space-separated integers A_{1}, A_{2}, \\dots, A_{N}.\n\n------ Output Format ------ \n\nFor each test case, output the maximum possible GCD of the array after performing any number of operations.\n\n------ Constraints ------ \n\n$1 ≤ T ≤ 100$\n$2 ≤ N ≤ 1000$\n$1 ≤ A_{i} ≤ 10^{5}$\n\n----- Sample Input 1 ------ \n2\n3\n2 4 8\n4\n3 9 27 81\n\n----- Sample Output 1 ------ \n2\n3\n\n----- Explanation 1 ------\n- Test case $1$: The maximum GCD that can be achieved by performing some finite number of operations on the given array is $2$. For instance, perform the operation on the entire array using indices $1, 2, 3$, such that every element becomes gcd(2, 4, 8) = 2.\n- Test case $2$: The maximum GCD that can be achieved by performing some finite number of operations on the given array is $3$. For instance, perform the operation on the entire array using indices $1, 2, 3, 4$, such that every element becomes gcd(3, 9, 27, 81) = 3.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\nprint(max_gcd_of_array(T, test_cases))  # Output: [2, 3]\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: You are given an array A of N integers. You can perform the following operation any number of times (including zero times):\\n\\nChoose any two indices i and j (1 ≤ i, j ≤ N, i ≠ j) and replace A_{i} with gcd(A_{i}, A_{j}), where gcd(a, b) is the greatest common divisor of a and b.\\n\\nDetermine the maximum possible GCD of the array after performing any number of operations.\\n\\n------ Input Format ------ \\n\\n- The first line contains an integer T denoting the number of test cases. The T test cases then follow.\\n- The first line of each test case contains an integer N - the size of the array.\\n- The second line of each test case contains N space-separated integers A_{1}, A_{2}, \\\\dots, A_{N}.\\n\\n------ Output Format ------ \\n\\nFor each test case, output the maximum possible GCD of the array after performing any number of operations.\\n\\n------ Constraints ------ \\n\\n$1 ≤ T ≤ 100$\\n$2 ≤ N ≤ 1000$\\n$1 ≤ A_{i} ≤ 10^{5}$\\n\\n----- Sample Input 1 ------ \\n2\\n3\\n2 4 8\\n4\\n3 9 27 81\\n\\n----- Sample Output 1 ------ \\n2\\n3\\n\\n----- Explanation 1 ------\\n- Test case $1$: The maximum GCD that can be achieved by performing some finite number of operations on the given array is $2$. For instance, perform the operation on the entire array using indices $1, 2, 3$, such that every element becomes gcd(2, 4, 8) = 2.\\n- Test case $2$: The maximum GCD that can be achieved by performing some finite number of operations on the given array is $3$. For instance, perform the operation on the entire array using indices $1, 2, 3, 4$, such that every element becomes gcd(3, 9, 27, 81) = 3.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\nprint(max_gcd_of_array(T, test_cases))  # Output: [2, 3]\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"from math import gcd\\nfrom functools import reduce\\n\\ndef max_gcd_of_array(T, test_cases):\\n    def gcd_of_list(numbers):\\n        return reduce(gcd, numbers)\\n    \\n    results = []\\n    for i in range(T):\\n        N = test_cases[i][0]\\n        A = test_cases[i][1]\\n        results.append(gcd_of_list(A))\\n    \\n    return results\\n\\n# Example usage:\\nT = 2\\ntest_cases = [(3, [2, 4, 8]), (4, [3, 9, 27, 81])]\\nprint(max_gcd_of_array(T, test_cases))  # Output: [2, 3]\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_max_gcd_of_array():\\n    assert max_gcd_of_array(2, [(3, [2, 4, 8]), (4, [3, 9, 27, 81])]) == [2, 3]\\n    assert max_gcd_of_array(1, [(2, [10, 15])]) == [5]\\n    assert max_gcd_of_array(1, [(5, [5, 10, 15, 20, 25])]) == [5]\\n    assert max_gcd_of_array(1, [(3, [7, 14, 21])]) == [7]\\n    assert max_gcd_of_array(1, [(4, [8, 16, 24, 32])]) == [8]\\n\\ndef test_edge_cases():\\n    assert max_gcd_of_array(1, [(2, [1, 1])]) == [1]\\n    assert max_gcd_of_array(1, [(2, [99991, 999979])]) == [1]  # Large primes\\n    assert max_gcd_of_array(1, [(3, [2, 3, 5])]) == [1]  # Coprime numbers\\n    assert max_gcd_of_array(0, []) == []\\n\\ndef test_single_test_case():\\n    assert max_gcd_of_array(1, [(3, [12, 15, 21])]) == [3]\"}]", "tag": "KodCode"}
{"id": "74b663f8e9d28789bc9591241ee92b9b50381f457c5918a41ef727c52ffa5cbd", "source": "KodCode", "difficulty": "0.6", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef find_misspelled_words(correct_words: List[str], text: str) -> List[str]:\n    \"\"\" Implement a function that mimics the behavior of a basic spell checker.\n    The function will receive a list of correct words and a string containing a paragraph of text. \n    It should output a list of words from the paragraph that are misspelled. \n    Assume that the input text contains only alphabetic characters and spaces, and words are separated by a single space. \n    Case sensitivity should be ignored (i.e., assume all inputs are in lowercase).\n\n    >>> find_misspelled_words([\"this\", \"is\", \"a\", \"test\"], \"this is a test\")\n    []\n    >>> find_misspelled_words([\"correct\", \"spelling\", \"list\", \"of\", \"words\"], \"this is a test\")\n    [\"this\", \"is\", \"a\", \"test\"]\n    >>> find_misspelled_words([\"this\", \"is\", \"a\", \"correct\", \"test\"], \"this is a spell checker test\")\n    [\"spell\", \"checker\"]\n    >>> find_misspelled_words([\"this\", \"is\", \"a\", \"test\"], \"\")\n    []\n    >>> find_misspelled_words([], \"this is a test\")\n    [\"this\", \"is\", \"a\", \"test\"]\n    >>> find_misspelled_words([\"THIS\", \"IS\", \"A\", \"TEST\"], \"this is a test\")\n    [\"this\", \"is\", \"a\", \"test\"]\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef find_misspelled_words(correct_words: List[str], text: str) -> List[str]:\\n    \\\"\\\"\\\" Implement a function that mimics the behavior of a basic spell checker.\\n    The function will receive a list of correct words and a string containing a paragraph of text. \\n    It should output a list of words from the paragraph that are misspelled. \\n    Assume that the input text contains only alphabetic characters and spaces, and words are separated by a single space. \\n    Case sensitivity should be ignored (i.e., assume all inputs are in lowercase).\\n\\n    >>> find_misspelled_words([\\\"this\\\", \\\"is\\\", \\\"a\\\", \\\"test\\\"], \\\"this is a test\\\")\\n    []\\n    >>> find_misspelled_words([\\\"correct\\\", \\\"spelling\\\", \\\"list\\\", \\\"of\\\", \\\"words\\\"], \\\"this is a test\\\")\\n    [\\\"this\\\", \\\"is\\\", \\\"a\\\", \\\"test\\\"]\\n    >>> find_misspelled_words([\\\"this\\\", \\\"is\\\", \\\"a\\\", \\\"correct\\\", \\\"test\\\"], \\\"this is a spell checker test\\\")\\n    [\\\"spell\\\", \\\"checker\\\"]\\n    >>> find_misspelled_words([\\\"this\\\", \\\"is\\\", \\\"a\\\", \\\"test\\\"], \\\"\\\")\\n    []\\n    >>> find_misspelled_words([], \\\"this is a test\\\")\\n    [\\\"this\\\", \\\"is\\\", \\\"a\\\", \\\"test\\\"]\\n    >>> find_misspelled_words([\\\"THIS\\\", \\\"IS\\\", \\\"A\\\", \\\"TEST\\\"], \\\"this is a test\\\")\\n    [\\\"this\\\", \\\"is\\\", \\\"a\\\", \\\"test\\\"]\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"from typing import List\\n\\ndef find_misspelled_words(correct_words: List[str], text: str) -> List[str]:\\n    # Convert the list of correct words to a set for O(1) average time complexity lookups\\n    correct_set = set(correct_words)\\n    \\n    # Split the text into individual words\\n    words = text.split()\\n    \\n    # Check each word in the text against the set of correct words\\n    misspelled_words = [word for word in words if word not in correct_set]\\n    \\n    return misspelled_words\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_no_misspelled_words():\\n    assert find_misspelled_words([\\\"this\\\", \\\"is\\\", \\\"a\\\", \\\"test\\\"], \\\"this is a test\\\") == []\\n\\ndef test_all_misspelled_words():\\n    assert find_misspelled_words([\\\"correct\\\", \\\"spelling\\\", \\\"list\\\", \\\"of\\\", \\\"words\\\"], \\\"this is a test\\\") == [\\\"this\\\", \\\"is\\\", \\\"a\\\", \\\"test\\\"]\\n\\ndef test_some_misspelled_words():\\n    assert find_misspelled_words([\\\"this\\\", \\\"is\\\", \\\"a\\\", \\\"correct\\\", \\\"test\\\"], \\\"this is a spell checker test\\\") == [\\\"spell\\\", \\\"checker\\\"]\\n\\ndef test_empty_text():\\n    assert find_misspelled_words([\\\"this\\\", \\\"is\\\", \\\"a\\\", \\\"test\\\"], \\\"\\\") == []\\n\\ndef test_empty_correct_words():\\n    assert find_misspelled_words([], \\\"this is a test\\\") == [\\\"this\\\", \\\"is\\\", \\\"a\\\", \\\"test\\\"]\\n\\ndef test_correct_words_case_insensitivity():\\n    assert find_misspelled_words([\\\"THIS\\\", \\\"IS\\\", \\\"A\\\", \\\"TEST\\\"], \\\"this is a test\\\") == [\\\"this\\\", \\\"is\\\", \\\"a\\\", \\\"test\\\"]\"}]", "tag": "KodCode"}
{"id": "0801d864f64f86c55d634b5860f7663b6c4c72cd22e9f2e12b99603f47a0e05c", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: How can I create a Python script that automatically checks if a website is up and sends an email notification if the website is down? I want to check the website every 5 minutes.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\nif not check_website(url):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: How can I create a Python script that automatically checks if a website is up and sends an email notification if the website is down? I want to check the website every 5 minutes.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\nif not check_website(url):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"import smtplib\\nimport requests\\nimport time\\nfrom email.mime.text import MIMEText\\nfrom email.mime.multipart import MIMEMultipart\\n\\ndef check_website(url):\\n    \\\"\\\"\\\"\\n    Checks if the website is up. Returns True if the website is up, False otherwise.\\n    \\\"\\\"\\\"\\n    try:\\n        response = requests.get(url)\\n        return response.status_code == 200\\n    except requests.exceptions.RequestException:\\n        return False\\n\\ndef send_email_notification(to_email, subject, body):\\n    \\\"\\\"\\\"\\n    Sends an email notification.\\n    \\\"\\\"\\\"\\n    from_email = \\\"your_email@example.com\\\"\\n    from_password = \\\"your_password\\\"\\n\\n    msg = MIMEMultipart()\\n    msg['From'] = from_email\\n    msg['To'] = to_email\\n    msg['Subject'] = subject\\n\\n    msg.attach(MIMEText(body, 'plain'))\\n\\n    try:\\n        server = smtplib.SMTP('smtp.gmail.com', 587)\\n        server.starttls()\\n        server.login(from_email, from_password)\\n        text = msg.as_string()\\n        server.sendmail(from_email, to_email, text)\\n        server.quit()\\n        return True\\n    except Exception as e:\\n        print(f\\\"Failed to send email: {e}\\\")\\n        return False\\n\\ndef monitor_website(url, to_email, check_interval=300):\\n    \\\"\\\"\\\"\\n    Monitors the website and sends an email notification if the website is down.\\n    \\\"\\\"\\\"\\n    while True:\\n        if not check_website(url):\\n            subject = \\\"Website Down Alert\\\"\\n            body = f\\\"The website {url} is down!\\\"\\n            send_email_notification(to_email, subject, body)\\n        time.sleep(check_interval)\\n\\n# Example usage (uncomment to run):\\n# monitor_website(\\\"http://example.com\\\", \\\"recipient@example.com\\\")\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\nimport pytest\\nfrom unittest.mock import patch, MagicMock\\n\\n@patch(\\\"solution.requests.get\\\")\\ndef test_check_website_up(mock_get):\\n    mock_get.return_value.status_code = 200\\n    assert check_website(\\\"http://example.com\\\") == True\\n\\n@patch(\\\"solution.requests.get\\\")\\ndef test_check_website_down(mock_get):\\n    mock_get.side_effect = requests.exceptions.RequestException\\n    assert check_website(\\\"http://example.com\\\") == False\\n\\n@patch(\\\"solution.smtplib.SMTP\\\")\\ndef test_send_email_notification_success(mock_smtp):\\n    instance = mock_smtp.return_value\\n    instance.sendmail.return_value = {}\\n    assert send_email_notification(\\\"recipient@example.com\\\", \\\"Test Subject\\\", \\\"Test Body\\\") == True\\n\\n@patch(\\\"solution.smtplib.SMTP\\\", side_effect=Exception(\\\"Failed to send email\\\"))\\ndef test_send_email_notification_failure(mock_smtp):\\n    assert send_email_notification(\\\"recipient@example.com\\\", \\\"Test Subject\\\", \\\"Test Body\\\") == False\"}]", "tag": "KodCode"}
{"id": "2e50a544a94b8fb726c432ee7e5a7e15b3c2b6dcc67f45bc77c87538257b2713", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Alice is participating in a coding marathon, and one of the challenges she faces involves dealing with word sorting.\n\nAlice is given a list of words and is tasked with sorting them in alphabetical order. However, there is a twist. Each word can be in uppercase or lowercase, and the sorting should be case-insensitive.\n\nCan you help Alice in writing a program that sorts the words according to the rules?\n\n*Input :-*\n\nThe first line of input contains a single integer t, the number of test cases. For each test case:\n- The first line contains an integer n, the number of words.\n- The next line contains n words separated by spaces.\n\n*Output :-*\n\nFor each test case, print the sorted list of words in a single line, maintaining the original case of the words.\n\nConstraints:-\n\n1 ≤ t ≤ 10 (t = Number of test cases)\n1 ≤ n ≤ 10^3 (n = Number of words in each test case)\n1 ≤ length of each word ≤ 100\n\nSAMPLE INPUT\n2\n3\nBanana apple Grape\n4\norange JAM apricot kiwi\n\nSAMPLE OUTPUT\napple Banana Grape\napricot JAM kiwi orange\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef sort_words_case_insensitive(test_cases):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Alice is participating in a coding marathon, and one of the challenges she faces involves dealing with word sorting.\\n\\nAlice is given a list of words and is tasked with sorting them in alphabetical order. However, there is a twist. Each word can be in uppercase or lowercase, and the sorting should be case-insensitive.\\n\\nCan you help Alice in writing a program that sorts the words according to the rules?\\n\\n*Input :-*\\n\\nThe first line of input contains a single integer t, the number of test cases. For each test case:\\n- The first line contains an integer n, the number of words.\\n- The next line contains n words separated by spaces.\\n\\n*Output :-*\\n\\nFor each test case, print the sorted list of words in a single line, maintaining the original case of the words.\\n\\nConstraints:-\\n\\n1 ≤ t ≤ 10 (t = Number of test cases)\\n1 ≤ n ≤ 10^3 (n = Number of words in each test case)\\n1 ≤ length of each word ≤ 100\\n\\nSAMPLE INPUT\\n2\\n3\\nBanana apple Grape\\n4\\norange JAM apricot kiwi\\n\\nSAMPLE OUTPUT\\napple Banana Grape\\napricot JAM kiwi orange\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef sort_words_case_insensitive(test_cases):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def sort_words_case_insensitive(test_cases):\\n    \\\"\\\"\\\"\\n    Sorts words in a case-insensitive manner for each test case.\\n    \\n    Parameters:\\n    test_cases (list of tuple): Each tuple contains an integer n and a list of words\\n    \\n    Returns:\\n    list of list: Each list contains words sorted in case-insensitive manner\\n    \\\"\\\"\\\"\\n    sorted_cases = []\\n    \\n    for n, words in test_cases:\\n        sorted_words = sorted(words, key=lambda x: x.lower())\\n        sorted_cases.append(sorted_words)\\n    \\n    return sorted_cases\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_single_test_case():\\n    test_cases = [(3, [\\\"Banana\\\", \\\"apple\\\", \\\"Grape\\\"])]\\n    result = sort_words_case_insensitive(test_cases)\\n    assert result == [[\\\"apple\\\", \\\"Banana\\\", \\\"Grape\\\"]]\\n\\ndef test_multiple_test_cases():\\n    test_cases = [\\n        (3, [\\\"Banana\\\", \\\"apple\\\", \\\"Grape\\\"]),\\n        (4, [\\\"orange\\\", \\\"JAM\\\", \\\"apricot\\\", \\\"kiwi\\\"])\\n    ]\\n    result = sort_words_case_insensitive(test_cases)\\n    assert result == [\\n        [\\\"apple\\\", \\\"Banana\\\", \\\"Grape\\\"],\\n        [\\\"apricot\\\", \\\"JAM\\\", \\\"kiwi\\\", \\\"orange\\\"]\\n    ]\\n\\ndef test_single_word():\\n    test_cases = [(1, [\\\"banana\\\"])]\\n    result = sort_words_case_insensitive(test_cases)\\n    assert result == [[\\\"banana\\\"]]\\n\\ndef test_mixed_case_words():\\n    test_cases = [(4, [\\\"Kiwi\\\", \\\"apple\\\", \\\"Mango\\\", \\\"banana\\\"])]\\n    result = sort_words_case_insensitive(test_cases)\\n    assert result == [[\\\"apple\\\", \\\"banana\\\", \\\"Kiwi\\\", \\\"Mango\\\"]]\\n\\ndef test_capitalized_and_lower_case():\\n    test_cases = [(4, [\\\"banana\\\", \\\"Banana\\\", \\\"banana\\\", \\\"BANANA\\\"])]\\n    result = sort_words_case_insensitive(test_cases)\\n    assert result == [[\\\"banana\\\", \\\"Banana\\\", \\\"banana\\\", \\\"BANANA\\\"]]\"}]", "tag": "KodCode"}
{"id": "0c664da0f3caa92030ab9af38e7847d435cdbd77ff1ea2f815ba60f3a66ffd87", "source": "KodCode", "difficulty": "0.3", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: ### Question: Data Analysis with Pandas\n\nYou are provided with a dataset representing sales data for a retail store. The dataset contains the following columns:\n- `Date`: Date of the sale\n- `Store`: Store identifier\n- `Product`: Product identifier\n- `Quantity`: Number of units sold\n- `Revenue`: Total revenue from the sale\n\nYou need to implement a function named `analyze_sales` that performs the following operations:\n\n1. **Load the data**: Read the data from a CSV file.\n2. **Filter and Create Columns**:\n   - Filter the data to select sales that occurred in 2023.\n   - Create a new column `RevenuePerUnit` which is calculated as `Revenue / Quantity`.\n   - Create another column `HighRevenue` which is `True` if the `Revenue` is greater than 500, otherwise `False`.\n3. **Group and Aggregate**:\n   - Group the data by `Store` and `Product`, and calculate the following for each group:\n     - Total `Quantity` sold.\n     - Maximum `RevenuePerUnit`.\n     - Count of `HighRevenue` transactions.\n     - The date of the earliest and latest sale in each group.\n4. **Output Format**: Return the result as a pandas DataFrame with the columns: `Store`, `Product`, `TotalQuantity`, `MaxRevenuePerUnit`, `HighRevenueCount`, `FirstSaleDate`, `LastSaleDate`.\n5. **Performance consideration**: Ensure your function handles large datasets efficiently.\n\n### Input:\n- The path to the CSV file (string).\n\n### Output:\n- A pandas DataFrame with the aggregated results.\n\n### Constraints:\n- Assume the CSV file is correctly formatted with valid data in the described columns.\n- The date format in the `Date` column is `YYYY-MM-DD`.\n\n### Example:\nSuppose the CSV file content is:\n```\nDate,Store,Product,Quantity,Revenue\n2023-01-15,StoreA,Product1,5,250.00\n2023-01-20,StoreA,Product1,3,600.00\n2023-02-05,StoreB,Product2,10,700.00\n2022-12-11,StoreA,Product1,4,400.00\n```\n\nThe function call `analyze_sales(\"sales_data.csv\")` should return a DataFrame:\n```\n  Store   Product  TotalQuantity  MaxRevenuePerUnit  HighRevenueCount FirstSaleDate LastSaleDate\n0 StoreA Product1             8               200.0                 1    2023-01-15   2023-01-20\n1 StoreB Product2            10                70.0                 1    2023-02-05   2023-02-05\n```\n\n### Implementation\n```python\nimport pandas as pd\n\ndef analyze_sales(file_path):\n    # Step 1: Load the data\n    df = pd.read_csv(file_path)\n    \n    # Step 2: Filter data for the year 2023\n    df['Date'] = pd.to_datetime(df['Date'])\n    df_2023 = df[df['Date'].dt.year == 2023]\n    \n    # Step 3: Create new columns\n    df_2023['RevenuePerUnit'] = df_2023['Revenue'] / df_2023['Quantity']\n    df_2023['HighRevenue'] = df_2023['Revenue'] > 500\n    \n    # Step 4: Group and aggregate\n    grouped = df_2023.groupby(['Store', 'Product']).agg(\n        TotalQuantity=('Quantity', 'sum'),\n        MaxRevenuePerUnit=('RevenuePerUnit', 'max'),\n        HighRevenueCount=('HighRevenue', 'sum'),\n        FirstSaleDate=('Date', 'min'),\n        LastSaleDate=('Date', 'max')\n    ).reset_index()\n    \n    return grouped\n```\n\nYou can download the sample CSV file [here](path-to-sample-csv).\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef analyze_sales(file_path):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: ### Question: Data Analysis with Pandas\\n\\nYou are provided with a dataset representing sales data for a retail store. The dataset contains the following columns:\\n- `Date`: Date of the sale\\n- `Store`: Store identifier\\n- `Product`: Product identifier\\n- `Quantity`: Number of units sold\\n- `Revenue`: Total revenue from the sale\\n\\nYou need to implement a function named `analyze_sales` that performs the following operations:\\n\\n1. **Load the data**: Read the data from a CSV file.\\n2. **Filter and Create Columns**:\\n   - Filter the data to select sales that occurred in 2023.\\n   - Create a new column `RevenuePerUnit` which is calculated as `Revenue / Quantity`.\\n   - Create another column `HighRevenue` which is `True` if the `Revenue` is greater than 500, otherwise `False`.\\n3. **Group and Aggregate**:\\n   - Group the data by `Store` and `Product`, and calculate the following for each group:\\n     - Total `Quantity` sold.\\n     - Maximum `RevenuePerUnit`.\\n     - Count of `HighRevenue` transactions.\\n     - The date of the earliest and latest sale in each group.\\n4. **Output Format**: Return the result as a pandas DataFrame with the columns: `Store`, `Product`, `TotalQuantity`, `MaxRevenuePerUnit`, `HighRevenueCount`, `FirstSaleDate`, `LastSaleDate`.\\n5. **Performance consideration**: Ensure your function handles large datasets efficiently.\\n\\n### Input:\\n- The path to the CSV file (string).\\n\\n### Output:\\n- A pandas DataFrame with the aggregated results.\\n\\n### Constraints:\\n- Assume the CSV file is correctly formatted with valid data in the described columns.\\n- The date format in the `Date` column is `YYYY-MM-DD`.\\n\\n### Example:\\nSuppose the CSV file content is:\\n```\\nDate,Store,Product,Quantity,Revenue\\n2023-01-15,StoreA,Product1,5,250.00\\n2023-01-20,StoreA,Product1,3,600.00\\n2023-02-05,StoreB,Product2,10,700.00\\n2022-12-11,StoreA,Product1,4,400.00\\n```\\n\\nThe function call `analyze_sales(\\\"sales_data.csv\\\")` should return a DataFrame:\\n```\\n  Store   Product  TotalQuantity  MaxRevenuePerUnit  HighRevenueCount FirstSaleDate LastSaleDate\\n0 StoreA Product1             8               200.0                 1    2023-01-15   2023-01-20\\n1 StoreB Product2            10                70.0                 1    2023-02-05   2023-02-05\\n```\\n\\n### Implementation\\n```python\\nimport pandas as pd\\n\\ndef analyze_sales(file_path):\\n    # Step 1: Load the data\\n    df = pd.read_csv(file_path)\\n    \\n    # Step 2: Filter data for the year 2023\\n    df['Date'] = pd.to_datetime(df['Date'])\\n    df_2023 = df[df['Date'].dt.year == 2023]\\n    \\n    # Step 3: Create new columns\\n    df_2023['RevenuePerUnit'] = df_2023['Revenue'] / df_2023['Quantity']\\n    df_2023['HighRevenue'] = df_2023['Revenue'] > 500\\n    \\n    # Step 4: Group and aggregate\\n    grouped = df_2023.groupby(['Store', 'Product']).agg(\\n        TotalQuantity=('Quantity', 'sum'),\\n        MaxRevenuePerUnit=('RevenuePerUnit', 'max'),\\n        HighRevenueCount=('HighRevenue', 'sum'),\\n        FirstSaleDate=('Date', 'min'),\\n        LastSaleDate=('Date', 'max')\\n    ).reset_index()\\n    \\n    return grouped\\n```\\n\\nYou can download the sample CSV file [here](path-to-sample-csv).\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef analyze_sales(file_path):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"import pandas as pd\\n\\ndef analyze_sales(file_path):\\n    # Step 1: Load the data\\n    df = pd.read_csv(file_path)\\n    \\n    # Step 2: Filter data for the year 2023\\n    df['Date'] = pd.to_datetime(df['Date'])\\n    df_2023 = df[df['Date'].dt.year == 2023]\\n    \\n    # Step 3: Create new columns\\n    df_2023['RevenuePerUnit'] = df_2023['Revenue'] / df_2023['Quantity']\\n    df_2023['HighRevenue'] = df_2023['Revenue'] > 500\\n    \\n    # Step 4: Group and aggregate\\n    grouped = df_2023.groupby(['Store', 'Product']).agg(\\n        TotalQuantity=('Quantity', 'sum'),\\n        MaxRevenuePerUnit=('RevenuePerUnit', 'max'),\\n        HighRevenueCount=('HighRevenue', 'sum'),\\n        FirstSaleDate=('Date', 'min'),\\n        LastSaleDate=('Date', 'max')\\n    ).reset_index()\\n    \\n    return grouped\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\nimport pandas as pd\\nfrom io import StringIO\\n\\ndef test_analyze_sales():\\n    test_data = StringIO(\\\"\\\"\\\"Date,Store,Product,Quantity,Revenue\\n2023-01-15,StoreA,Product1,5,250.00\\n2023-01-20,StoreA,Product1,3,600.00\\n2023-02-05,StoreB,Product2,10,700.00\\n2022-12-11,StoreA,Product1,4,400.00\\n\\\"\\\"\\\")\\n    \\n    expected_output = pd.DataFrame({\\n        'Store': ['StoreA', 'StoreB'],\\n        'Product': ['Product1', 'Product2'],\\n        'TotalQuantity': [8, 10],\\n        'MaxRevenuePerUnit': [200.0, 70.0],\\n        'HighRevenueCount': [1, 1],\\n        'FirstSaleDate': [pd.Timestamp('2023-01-15'), pd.Timestamp('2023-02-05')],\\n        'LastSaleDate': [pd.Timestamp('2023-01-20'), pd.Timestamp('2023-02-05')]\\n    })\\n\\n    # Save the test data to a temporary CSV file\\n    test_data_path = 'test_sales_data.csv'\\n    with open(test_data_path, 'w') as f:\\n        f.write(test_data.getvalue())\\n\\n    # Run the function with the test data\\n    result = analyze_sales(test_data_path)\\n    \\n    # Verify the results\\n    pd.testing.assert_frame_equal(result, expected_output)\\n\\n# Run the test\\ntest_analyze_sales()\"}]", "tag": "KodCode"}
{"id": "9ce886dc98958eb0b751979ac2b3bb5baa7cdbcb8765b2b5ee7261a46552043e", "source": "KodCode", "difficulty": "0.4", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\ndef visualize_data(df):\n    \"\"\"\n    Generates a series of visualizations to explore the dataset using seaborn.\n    \n    Parameters:\n    df (pd.DataFrame): The input data frame containing at least three numerical columns and \n                       two categorical columns.\n    \"\"\"\n    pass\n\n# Load the tips dataset as an example\ndf = sns.load_dataset(\"tips\")\ndf = df.rename(\n    columns={\n        'total_bill': 'num_col1',\n        'tip': 'num_col2',\n        'size': 'num_col3',\n        'sex': 'cat_col1',\n        'smoker': 'cat_col2'\n    }\n)\n\ndef test_visualize_data():\n    try:\n        visualize_data(df)\n    except Exception as e:\n        assert False, f\"visualize_data raised an exception {e}\"\n    \ndef test_empty_dataframe():\n    df_empty = pd.DataFrame()\n    try:\n        visualize_data(df_empty)\n    except ValueError as e:\n        assert str(e) == \"The DataFrame should not be empty\"\n\ndef test_missing_columns():\n    df_missing = pd.DataFrame({\n        'num_col1': [1, 2, 3],\n        'num_col2': [4, 5, 6],\n        'num_col3': [7, 8, 9],\n        'cat_col1': ['A', 'B', 'C']\n    })\n    try:\n        visualize_data(df_missing)\n    except ValueError as e:\n        assert str(e) == \"Missing required column: cat_col2\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\nimport pandas as pd\\nimport seaborn as sns\\nimport matplotlib.pyplot as plt\\n\\ndef visualize_data(df):\\n    \\\"\\\"\\\"\\n    Generates a series of visualizations to explore the dataset using seaborn.\\n    \\n    Parameters:\\n    df (pd.DataFrame): The input data frame containing at least three numerical columns and \\n                       two categorical columns.\\n    \\\"\\\"\\\"\\n    pass\\n\\n# Load the tips dataset as an example\\ndf = sns.load_dataset(\\\"tips\\\")\\ndf = df.rename(\\n    columns={\\n        'total_bill': 'num_col1',\\n        'tip': 'num_col2',\\n        'size': 'num_col3',\\n        'sex': 'cat_col1',\\n        'smoker': 'cat_col2'\\n    }\\n)\\n\\ndef test_visualize_data():\\n    try:\\n        visualize_data(df)\\n    except Exception as e:\\n        assert False, f\\\"visualize_data raised an exception {e}\\\"\\n    \\ndef test_empty_dataframe():\\n    df_empty = pd.DataFrame()\\n    try:\\n        visualize_data(df_empty)\\n    except ValueError as e:\\n        assert str(e) == \\\"The DataFrame should not be empty\\\"\\n\\ndef test_missing_columns():\\n    df_missing = pd.DataFrame({\\n        'num_col1': [1, 2, 3],\\n        'num_col2': [4, 5, 6],\\n        'num_col3': [7, 8, 9],\\n        'cat_col1': ['A', 'B', 'C']\\n    })\\n    try:\\n        visualize_data(df_missing)\\n    except ValueError as e:\\n        assert str(e) == \\\"Missing required column: cat_col2\\\"\"}]", "ground_truth": "[\"import pandas as pd\\nimport seaborn as sns\\nimport matplotlib.pyplot as plt\\n\\ndef visualize_data(df):\\n    \\\"\\\"\\\"\\n    Generates a series of visualizations to explore the dataset using seaborn.\\n    \\n    Parameters:\\n    df (pd.DataFrame): The input data frame containing at least three numerical columns and \\n                       two categorical columns.\\n    \\\"\\\"\\\"\\n    \\n    if df.empty:\\n        raise ValueError(\\\"The DataFrame should not be empty\\\")\\n\\n    required_numeric_cols = ['num_col1', 'num_col2', 'num_col3']\\n    required_cat_cols = ['cat_col1', 'cat_col2']\\n    \\n    for col in required_numeric_cols + required_cat_cols:\\n        if col not in df.columns:\\n            raise ValueError(f\\\"Missing required column: {col}\\\")\\n    \\n    # Scatter plot\\n    scatter_plot = sns.relplot(\\n        data=df, x='num_col1', y='num_col2', hue='cat_col1', style='cat_col2'\\n    )\\n    scatter_plot.fig.suptitle('Relationship between Num_Col1 and Num_Col2')\\n    scatter_plot.set_axis_labels('Num_Col1', 'Num_Col2')\\n    \\n    # Distribution plot\\n    dist_plot = sns.displot(\\n        data=df, x='num_col3', hue='cat_col1', kde=True\\n    )\\n    dist_plot.fig.suptitle('Distribution of Num_Col3')\\n    dist_plot.set_axis_labels('Num_Col3', 'Density')\\n    \\n    # Bar plot\\n    bar_plot = sns.catplot(\\n        data=df, kind='bar', x='cat_col1', y='num_col1', hue='cat_col2'\\n    )\\n    bar_plot.fig.suptitle('Average Num_Col1 per Cat_Col1')\\n    bar_plot.set_axis_labels('Cat_Col1', 'Average Num_Col1')\\n    \\n    # Joint plot\\n    joint_plot = sns.jointplot(\\n        data=df, x='num_col1', y='num_col2', hue='cat_col1'\\n    )\\n    joint_plot.fig.suptitle('Joint Distribution of Num_Col1 and Num_Col2')\\n    joint_plot.set_axis_labels('Num_Col1', 'Num_Col2')\\n\\n    plt.show()\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\nimport pandas as pd\\nimport pytest\\nimport seaborn as sns\\n\\ndef test_visualize_data():\\n    # Load the tips dataset and rename columns to match the required format\\n    df = sns.load_dataset(\\\"tips\\\")\\n    df = df.rename(\\n        columns={\\n            'total_bill': 'num_col1',\\n            'tip': 'num_col2',\\n            'size': 'num_col3',\\n            'sex': 'cat_col1',\\n            'smoker': 'cat_col2'\\n        }\\n    )\\n    \\n    try:\\n        visualize_data(df)\\n    except Exception as e:\\n        assert False, f\\\"visualize_data raised an exception {e}\\\"\\n    \\ndef test_empty_dataframe():\\n    df = pd.DataFrame()\\n    with pytest.raises(ValueError, match=\\\"The DataFrame should not be empty\\\"):\\n        visualize_data(df)\\n        \\ndef test_missing_columns():\\n    df = pd.DataFrame({\\n        'num_col1': [1, 2, 3],\\n        'num_col2': [4, 5, 6],\\n        'num_col3': [7, 8, 9],\\n        'cat_col1': ['A', 'B', 'C']\\n    })\\n    with pytest.raises(ValueError, match=\\\"Missing required column: cat_col2\\\"):\\n        visualize_data(df)\"}]", "tag": "KodCode"}
{"id": "85c6dae5641a44e1c7ea844afea8c35fce337d03d3646ad5e05390bdb022130c", "source": "KodCode", "difficulty": "0.5", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef can_see_board(heights):\n    \"\"\"\n    Given heights of students in a line, returns an array representing the number\n    of students up to and including the ith student that can see the board.\n\n    Args:\n    heights (List[int]): An array of integers representing the heights of students.\n\n    Returns:\n    List[int]: An array where each element i represents the number of students up\n               to and including the ith student that can see the board.\n\n    >>> can_see_board([1, 2, 3, 4, 5]) == [1, 2, 3, 4, 5]\n    >>> can_see_board([5, 4, 3, 2, 1]) == [1, 1, 1, 1, 1]\n    >>> can_see_board([1, 3, 2, 4]) == [1, 2, 2, 4]\n    >>> can_see_board([2, 2, 2, 3, 3, 1]) == [1, 1, 1, 4, 4, 4]\n    >>> can_see_board([5]) == [1]\n    >>> can_see_board([]) == []\n    >>> can_see_board([1, 2, 3]) == [1, 2, 3]\n    >>> can_see_board([1, 3, 2, 4, 3, 5]) == [1, 2, 2, 4, 4, 6]\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef can_see_board(heights):\\n    \\\"\\\"\\\"\\n    Given heights of students in a line, returns an array representing the number\\n    of students up to and including the ith student that can see the board.\\n\\n    Args:\\n    heights (List[int]): An array of integers representing the heights of students.\\n\\n    Returns:\\n    List[int]: An array where each element i represents the number of students up\\n               to and including the ith student that can see the board.\\n\\n    >>> can_see_board([1, 2, 3, 4, 5]) == [1, 2, 3, 4, 5]\\n    >>> can_see_board([5, 4, 3, 2, 1]) == [1, 1, 1, 1, 1]\\n    >>> can_see_board([1, 3, 2, 4]) == [1, 2, 2, 4]\\n    >>> can_see_board([2, 2, 2, 3, 3, 1]) == [1, 1, 1, 4, 4, 4]\\n    >>> can_see_board([5]) == [1]\\n    >>> can_see_board([]) == []\\n    >>> can_see_board([1, 2, 3]) == [1, 2, 3]\\n    >>> can_see_board([1, 3, 2, 4, 3, 5]) == [1, 2, 2, 4, 4, 6]\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def can_see_board(heights):\\n    \\\"\\\"\\\"\\n    Given heights of students in a line, returns an array representing the number\\n    of students up to and including the ith student that can see the board.\\n\\n    Args:\\n    heights (List[int]): An array of integers representing the heights of students.\\n\\n    Returns:\\n    List[int]: An array where each element i represents the number of students up\\n               to and including the ith student that can see the board.\\n    \\\"\\\"\\\"\\n    result = []\\n    max_height_so_far = 0\\n    \\n    for height in heights:\\n        if height > max_height_so_far:\\n            max_height_so_far = height\\n        result.append(max_height_so_far)\\n    \\n    return [result.index(h) + 1 for h in result]\\n\\n# Example usage:\\n# heights = [1, 2, 3, 2, 1]\\n# output: [1, 2, 3, 3, 3]\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_all_students_can_see_board():\\n    assert can_see_board([1, 2, 3, 4, 5]) == [1, 2, 3, 4, 5]\\n\\ndef test_none_beyond_first_can_see_board():\\n    assert can_see_board([5, 4, 3, 2, 1]) == [1, 1, 1, 1, 1]\\n\\ndef test_some_students_can_see_board():\\n    assert can_see_board([1, 3, 2, 4]) == [1, 2, 2, 4]\\n\\ndef test_repeated_heights():\\n    assert can_see_board([2, 2, 2, 3, 3, 1]) == [1, 1, 1, 4, 4, 4]\\n\\ndef test_single_student():\\n    assert can_see_board([5]) == [1]\\n\\ndef test_empty_list():\\n    assert can_see_board([]) == []\\n\\ndef test_incremental_heights():\\n    assert can_see_board([1, 2, 3]) == [1, 2, 3]\\n\\ndef test_alternating_heights():\\n    assert can_see_board([1, 3, 2, 4, 3, 5]) == [1, 2, 2, 4, 4, 6]\"}]", "tag": "KodCode"}
{"id": "07473124b7e436443a0866eead45b665d4651fac8528ca825dd6898129ed71b1", "source": "KodCode", "difficulty": "0.4", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef count_valid_pairs(s: str) -> int:\n    \"\"\"\n    Returns the number of valid pairs of brackets in the given string s.\n    \n    >>> count_valid_pairs(\"(){}[]\") == 3\n    >>> count_valid_pairs(\"([)]\") == 0\n    >>> count_valid_pairs(\"(({{[[]]}}))\") == 6\n    \"\"\"\n    \nfrom solution import count_valid_pairs\n\ndef test_simple_valid_pairs():\n    assert count_valid_pairs(\"(){}[]\") == 3\n\ndef test_no_valid_pairs_invalid_order():\n    assert count_valid_pairs(\"([)]\") == 0\n\ndef test_nested_valid_pairs():\n    assert count_valid_pairs(\"(({{[[]]}}))\") == 6\n\ndef test_mixed_valid_and_invalid():\n    assert count_valid_pairs(\"(({{[[]]})}}))\") == 0\n\ndef test_single_type_pairs():\n    assert count_valid_pairs(\"(((())))\") == 4\n    assert count_valid_pairs(\"{}{}{}{}\") == 4\n    assert count_valid_pairs(\"[][][][]\") == 4\n\ndef test_empty_string():\n    assert count_valid_pairs(\"\") == 0\n\ndef test_unmatched_closing():\n    assert count_valid_pairs(\"(}\") == 0\n\ndef test_unmatched_opening():\n    assert count_valid_pairs(\"({[\") == 0\n\ndef test_complex_valid_pairs():\n    assert count_valid_pairs(\"([]){}[{()}]\") == 6\n\ndef test_sequential_pairs():\n    assert count_valid_pairs(\"()[]{}\") == 3", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef count_valid_pairs(s: str) -> int:\\n    \\\"\\\"\\\"\\n    Returns the number of valid pairs of brackets in the given string s.\\n    \\n    >>> count_valid_pairs(\\\"(){}[]\\\") == 3\\n    >>> count_valid_pairs(\\\"([)]\\\") == 0\\n    >>> count_valid_pairs(\\\"(({{[[]]}}))\\\") == 6\\n    \\\"\\\"\\\"\\n    \\nfrom solution import count_valid_pairs\\n\\ndef test_simple_valid_pairs():\\n    assert count_valid_pairs(\\\"(){}[]\\\") == 3\\n\\ndef test_no_valid_pairs_invalid_order():\\n    assert count_valid_pairs(\\\"([)]\\\") == 0\\n\\ndef test_nested_valid_pairs():\\n    assert count_valid_pairs(\\\"(({{[[]]}}))\\\") == 6\\n\\ndef test_mixed_valid_and_invalid():\\n    assert count_valid_pairs(\\\"(({{[[]]})}}))\\\") == 0\\n\\ndef test_single_type_pairs():\\n    assert count_valid_pairs(\\\"(((())))\\\") == 4\\n    assert count_valid_pairs(\\\"{}{}{}{}\\\") == 4\\n    assert count_valid_pairs(\\\"[][][][]\\\") == 4\\n\\ndef test_empty_string():\\n    assert count_valid_pairs(\\\"\\\") == 0\\n\\ndef test_unmatched_closing():\\n    assert count_valid_pairs(\\\"(}\\\") == 0\\n\\ndef test_unmatched_opening():\\n    assert count_valid_pairs(\\\"({[\\\") == 0\\n\\ndef test_complex_valid_pairs():\\n    assert count_valid_pairs(\\\"([]){}[{()}]\\\") == 6\\n\\ndef test_sequential_pairs():\\n    assert count_valid_pairs(\\\"()[]{}\\\") == 3\"}]", "ground_truth": "[\"def count_valid_pairs(s):\\n    \\\"\\\"\\\"\\n    Returns the number of valid pairs of brackets in the given string s.\\n    \\\"\\\"\\\"\\n    stack = []\\n    pairs = {')': '(', '}': '{', ']': '['}\\n    count = 0\\n\\n    for char in s:\\n        if char in pairs.values():\\n            stack.append(char)\\n        elif char in pairs:\\n            if stack and stack[-1] == pairs[char]:\\n                stack.pop()\\n                count += 1\\n            else:\\n                return 0  # invalid sequence, so return 0 immediate\\n\\n    return count\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_simple_valid_pairs():\\n    assert count_valid_pairs(\\\"(){}[]\\\") == 3\\n\\ndef test_no_valid_pairs_invalid_order():\\n    assert count_valid_pairs(\\\"([)]\\\") == 0\\n\\ndef test_nested_valid_pairs():\\n    assert count_valid_pairs(\\\"(({{[[]]}}))\\\") == 6\\n\\ndef test_mixed_valid_and_invalid():\\n    assert count_valid_pairs(\\\"(({{[[]]})}}))\\\") == 0\\n\\ndef test_single_type_pairs():\\n    assert count_valid_pairs(\\\"(((())))\\\") == 4\\n    assert count_valid_pairs(\\\"{}{}{}{}\\\") == 4\\n    assert count_valid_pairs(\\\"[][][][]\\\") == 4\\n\\ndef test_empty_string():\\n    assert count_valid_pairs(\\\"\\\") == 0\\n\\ndef test_unmatched_closing():\\n    assert count_valid_pairs(\\\"(}\\\") == 0\\n\\ndef test_unmatched_opening():\\n    assert count_valid_pairs(\\\"({[\\\") == 0\\n\\ndef test_complex_valid_pairs():\\n    assert count_valid_pairs(\\\"([]){}[{()}]\\\") == 6\\n\\ndef test_sequential_pairs():\\n    assert count_valid_pairs(\\\"()[]{}\\\") == 3\"}]", "tag": "KodCode"}
{"id": "9cc5867c070fb11df1a9ebe43aaed1345d484699a9c846a35a4156bbb65bd079", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: You are given a rectangular grid of size n by m consisting of '*' and '.' characters. Your task is to determine whether it is possible to find a square sub-grid (with side length k) in the grid such that all characters inside the square are '*'.\n\nInput\n\nThe first line contains three integers n, m, and k (1 ≤ n, m ≤ 1000, 1 ≤ k ≤ min(n, m)) — the dimensions of the grid and the side length of the square.\n\nEach of the next n lines contains m characters ('*' or '.') representing the grid.\n\nOutput\n\nPrint \"YES\" (without quotes) if there exists at least one k by k square in the grid composed entirely of '*' characters. Otherwise, print \"NO\".\n\nExamples\n\nInput\n\n4 5 2\n.*..*\n***.*\n****.\n.....\n\nOutput\n\nYES\n\nInput\n\n3 4 3\n****\n***.\n**..\n\nOutput\n\nNO\n\nInput\n\n5 5 2\n*****\n*****\n*****\n*****\n*****\n\nOutput\n\nYES\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef is_square_of_stars(grid, n, m, k):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: You are given a rectangular grid of size n by m consisting of '*' and '.' characters. Your task is to determine whether it is possible to find a square sub-grid (with side length k) in the grid such that all characters inside the square are '*'.\\n\\nInput\\n\\nThe first line contains three integers n, m, and k (1 ≤ n, m ≤ 1000, 1 ≤ k ≤ min(n, m)) — the dimensions of the grid and the side length of the square.\\n\\nEach of the next n lines contains m characters ('*' or '.') representing the grid.\\n\\nOutput\\n\\nPrint \\\"YES\\\" (without quotes) if there exists at least one k by k square in the grid composed entirely of '*' characters. Otherwise, print \\\"NO\\\".\\n\\nExamples\\n\\nInput\\n\\n4 5 2\\n.*..*\\n***.*\\n****.\\n.....\\n\\nOutput\\n\\nYES\\n\\nInput\\n\\n3 4 3\\n****\\n***.\\n**..\\n\\nOutput\\n\\nNO\\n\\nInput\\n\\n5 5 2\\n*****\\n*****\\n*****\\n*****\\n*****\\n\\nOutput\\n\\nYES\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef is_square_of_stars(grid, n, m, k):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def is_square_of_stars(grid, n, m, k):\\n    \\\"\\\"\\\"\\n    Check if there exists a k by k square in the n by m grid composed entirely of '*' characters.\\n    \\\"\\\"\\\"\\n    for i in range(n - k + 1):\\n        for j in range(m - k + 1):\\n            if all(grid[x][y] == '*' for x in range(i, i + k) for y in range(j, j + k)):\\n                return \\\"YES\\\"\\n    return \\\"NO\\\"\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_example_1():\\n    assert is_square_of_stars([\\n        \\\".*..*\\\",\\n        \\\"***.*\\\",\\n        \\\"****.\\\",\\n        \\\".....\\\"\\n    ], 4, 5, 2) == \\\"YES\\\"\\n\\ndef test_example_2():\\n    assert is_square_of_stars([\\n        \\\"****\\\",\\n        \\\"***.\\\",\\n        \\\"**..\\\"\\n    ], 3, 4, 3) == \\\"NO\\\"\\n\\ndef test_example_3():\\n    assert is_square_of_stars([\\n        \\\"*****\\\",\\n        \\\"*****\\\",\\n        \\\"*****\\\",\\n        \\\"*****\\\",\\n        \\\"*****\\\"\\n    ], 5, 5, 2) == \\\"YES\\\"\\n\\ndef test_no_square_grid():\\n    assert is_square_of_stars([\\n        \\\".*\\\",\\n        \\\"*.\\\"\\n    ], 2, 2, 2) == \\\"NO\\\"\\n\\ndef test_full_star_grid():\\n    assert is_square_of_stars([\\n        \\\"****\\\",\\n        \\\"****\\\",\\n        \\\"****\\\",\\n        \\\"****\\\"\\n    ], 4, 4, 3) == \\\"YES\\\"\\n\\ndef test_minimum_grid_size_yes():\\n    assert is_square_of_stars([\\n        \\\"*\\\"\\n    ], 1, 1, 1) == \\\"YES\\\"\\n\\ndef test_minimum_grid_size_no():\\n    assert is_square_of_stars([\\n        \\\".\\\"\\n    ], 1, 1, 1) == \\\"NO\\\"\"}]", "tag": "KodCode"}
{"id": "8efe23ded920d267ed9e6f8673879bc2829243af09e5fad6304c5a2ee419cad1", "source": "KodCode", "difficulty": "0.4", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef pacific_atlantic(matrix: List[List[int]]) -> List[List[int]]:\n    \"\"\" Determine the set of all grid cells where water can flow to both the left and top oceans.\n    >>> pacific_atlantic([])\n    []\n    >>> pacific_atlantic([[1]])\n    [[0, 0]]\n    >>> pacific_atlantic([\n        [1, 2, 2, 3, 5],\n        [3, 2, 3, 4, 4],\n        [2, 4, 5, 3, 1],\n        [6, 7, 1, 64 стр.';\necho BudgetCalculator::calculateAverageCostDescription($description);", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef pacific_atlantic(matrix: List[List[int]]) -> List[List[int]]:\\n    \\\"\\\"\\\" Determine the set of all grid cells where water can flow to both the left and top oceans.\\n    >>> pacific_atlantic([])\\n    []\\n    >>> pacific_atlantic([[1]])\\n    [[0, 0]]\\n    >>> pacific_atlantic([\\n        [1, 2, 2, 3, 5],\\n        [3, 2, 3, 4, 4],\\n        [2, 4, 5, 3, 1],\\n        [6, 7, 1, 64 стр.';\\necho BudgetCalculator::calculateAverageCostDescription($description);\"}]", "ground_truth": "[\"def pacific_atlantic(matrix):\\n    if not matrix or not matrix[0]:\\n        return []\\n\\n    def dfs(matrix, visited, height, x, y):\\n        m, n = len(matrix), len(matrix[0])\\n        if (x < 0 or x >= m or y < 0 or y >= n or \\n            visited[x][y] or matrix[x][y] < height):\\n            return\\n        visited[x][y] = True\\n        for dx, dy in [(-1,0), (1,0), (0,-1), (0,1)]:\\n            dfs(matrix, visited, matrix[x][y], x+dx, y+dy)\\n\\n    m, n = len(matrix), len(matrix[0])\\n    pacific_visited = [[False]*n for _ in range(m)]\\n    atlantic_visited = [[False]*n for _ in range(m)]\\n\\n    for i in range(m):\\n        dfs(matrix, pacific_visited, float('-inf'), i, 0)\\n        dfs(matrix, atlantic_visited, float('-inf'), i, n-1)\\n\\n    for j in range(n):\\n        dfs(matrix, pacific_visited, float('-inf'), 0, j)\\n        dfs(matrix, atlantic_visited, float('-inf'), m-1, j)\\n\\n    result = []\\n    for i in range(m):\\n        for j in range(n):\\n            if pacific_visited[i][j] and atlantic_visited[i][j]:\\n                result.append([i, j])\\n    \\n    return result\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\ndef test_empty_input():\\n    assert pacific_atlantic([]) == []\\n\\ndef test_single_element():\\n    assert pacific_atlantic([[1]]) == [[0, 0]]\\n\\ndef test_small_matrix():\\n    matrix = [\\n        [1, 2, 2, 3, 5],\\n        [3, 2, 3, 4, 4],\\n        [2, 4, 5, 3, 1],\\n        [6, 7, 1, 4, 5],\\n        [5, 1, 1, 2, 4]\\n    ]\\n    expected = [[0, 4], [1, 3], [1, 4], [2, 2], [3, 0], [3, 1], [4, 0]]\\n    result = pacific_atlantic(matrix)\\n    assert sorted(result) == sorted(expected)\\n\\ndef test_flat_matrix():\\n    matrix = [\\n        [1, 1, 1],\\n        [1, 1, 1],\\n        [1, 1, 1]\\n    ]\\n    expected = [[0, 0], [0, 1], [0, 2], [1, 0], [1, 1], [1, 2], [2, 0], [2, 1], [2, 2]]\\n    result = pacific_atlantic(matrix)\\n    assert sorted(result) == sorted(expected)\"}]", "tag": "KodCode"}
{"id": "00f16565c977b3e62a9bfbbc324f1011a9cac4c5761dc84178ebe5d43350d383", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Scientists on Earth are working on revamping a complex algorithm that deals with string manipulations. Your task is to assist them by developing a new algorithm to solve the following problem:\n\nGiven a string s of length n, you need to determine the minimum number of operations required to make the string a palindrome. An operation is defined as deleting exactly one character from the string.\n\nA string is called a palindrome if it reads the same forward and backward. For example, the strings \"madam\" and \"racecar\" are palindromes, while \"hello\" and \"world\" are not.\n\nThe first line contains an integer n (1 ≤ n ≤ 2000) — the length of the string s.\nThe second line contains the string s consisting of lowercase Latin letters.\n\nPrint one integer — the minimum number of deletions required to make the string a palindrome.\n\n**Example:**\n\nInput:\n```\n7\nabcbade\n```\nOutput:\n```\n2\n```\n\n**Explanation:**\nIn this example, one possible way to make the string a palindrome is to delete the characters 'd' and 'e' to get the string \"abcba\". Hence, the minimum number of deletions required is 2.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\nprint(min_deletions_to_make_palindrome(s))  # Output: 2\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Scientists on Earth are working on revamping a complex algorithm that deals with string manipulations. Your task is to assist them by developing a new algorithm to solve the following problem:\\n\\nGiven a string s of length n, you need to determine the minimum number of operations required to make the string a palindrome. An operation is defined as deleting exactly one character from the string.\\n\\nA string is called a palindrome if it reads the same forward and backward. For example, the strings \\\"madam\\\" and \\\"racecar\\\" are palindromes, while \\\"hello\\\" and \\\"world\\\" are not.\\n\\nThe first line contains an integer n (1 ≤ n ≤ 2000) — the length of the string s.\\nThe second line contains the string s consisting of lowercase Latin letters.\\n\\nPrint one integer — the minimum number of deletions required to make the string a palindrome.\\n\\n**Example:**\\n\\nInput:\\n```\\n7\\nabcbade\\n```\\nOutput:\\n```\\n2\\n```\\n\\n**Explanation:**\\nIn this example, one possible way to make the string a palindrome is to delete the characters 'd' and 'e' to get the string \\\"abcba\\\". Hence, the minimum number of deletions required is 2.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\nprint(min_deletions_to_make_palindrome(s))  # Output: 2\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def min_deletions_to_make_palindrome(s):\\n    \\\"\\\"\\\"\\n    Returns the minimum number of deletions required to make the string s a palindrome.\\n    \\\"\\\"\\\"\\n    n = len(s)\\n    # Create a table to store results of subproblems\\n    dp = [[0] * n for _ in range(n)]\\n    \\n    # Fill the table\\n    for length in range(2, n + 1):\\n        for i in range(n - length + 1):\\n            j = i + length - 1\\n            if s[i] == s[j]:\\n                dp[i][j] = dp[i + 1][j - 1]\\n            else:\\n                dp[i][j] = min(dp[i + 1][j], dp[i][j - 1]) + 1\\n    \\n    # The result is the minimum number of deletions for string s[0:n-1]\\n    return dp[0][n - 1]\\n\\n# Example usage\\nn = 7\\ns = \\\"abcbade\\\"\\nprint(min_deletions_to_make_palindrome(s))  # Output: 2\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_example():\\n    assert min_deletions_to_make_palindrome(\\\"abcbade\\\") == 2\\n\\ndef test_already_palindrome():\\n    assert min_deletions_to_make_palindrome(\\\"madam\\\") == 0\\n    assert min_deletions_to_make_palindrome(\\\"racecar\\\") == 0\\n\\ndef test_single_character():\\n    assert min_deletions_to_make_palindrome(\\\"a\\\") == 0\\n\\ndef test_two_characters():\\n    assert min_deletions_to_make_palindrome(\\\"aa\\\") == 0\\n    assert min_deletions_to_make_palindrome(\\\"ab\\\") == 1\\n\\ndef test_repeating_characters():\\n    assert min_deletions_to_make_palindrome(\\\"aaaa\\\") == 0\\n    assert min_deletions_to_make_palindrome(\\\"abcddcba\\\") == 0\\n    \\ndef test_mixed_characters():\\n    assert min_deletions_to_make_palindrome(\\\"abcde\\\") == 4\\n    assert min_deletions_to_make_palindrome(\\\"aabbcc\\\") == 4\\n\\ndef test_long_string():\\n    assert min_deletions_to_make_palindrome(\\\"abcdef\\\") == 5\\n\\n# Running the tests\\nif __name__ == \\\"__main__\\\":\\n    import pytest\\n    pytest.main([__file__])\"}]", "tag": "KodCode"}
{"id": "7999de498c953d7af667e908490f89a506c0df12c53726f1c4a97c15d92dbf14", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Chef loves preparing dishes using ingredients from his enchanting garden. Each ingredient in his garden has a magical property and can only be harvested during a specific range of months in the year. Chef wants to maximize the number of unique dishes he can prepare using the ingredients available to him. Each dish requires exactly one type of ingredient.\n\nGiven that you have information about N different types of ingredients and their respective harvesting months, determine the maximum number of unique dishes Chef can prepare within the given constraints.\n\n**Input:**\n- The first line contains an integer T, the number of test cases.\n- For each test case, the first line contains an integer N, the number of different types of ingredients.\n- Each of the next N lines contains two integers Li and Ri, the start and end month (1 ≤ Li ≤ Ri ≤ 12) of the i-th ingredient's harvesting period.\n\n**Output:**\nFor each test case, print the maximum number of unique dishes Chef can prepare.\n\n**Constraints:**\n1. 1 ≤ T ≤ 10\n2. 1 ≤ N ≤ 1000\n3. 1 ≤ Li ≤ Ri ≤ 12\n\n**Example:**\n\n**Input:**\n```\n2\n3\n1 4\n2 6\n5 8\n4\n1 3\n2 5\n4 6\n7 9\n```\n\n**Output:**\n```\n2\n3\n```\n\n**Explanation:**\n- In the first test case, Chef can use the ingredients available from 1 to 4 for one dish and the ingredients from 5 to 8 for another dish, making a total of 2 dishes.\n- In the second test case, Chef can use the ingredients available from 1 to 3 for one dish, 4 to 6 for another dish, and 7 to 9 for another dish, making a total of 3 dishes.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\nprint(max_unique_dishes(T, test_cases))  # Output should be [2, 3]\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Chef loves preparing dishes using ingredients from his enchanting garden. Each ingredient in his garden has a magical property and can only be harvested during a specific range of months in the year. Chef wants to maximize the number of unique dishes he can prepare using the ingredients available to him. Each dish requires exactly one type of ingredient.\\n\\nGiven that you have information about N different types of ingredients and their respective harvesting months, determine the maximum number of unique dishes Chef can prepare within the given constraints.\\n\\n**Input:**\\n- The first line contains an integer T, the number of test cases.\\n- For each test case, the first line contains an integer N, the number of different types of ingredients.\\n- Each of the next N lines contains two integers Li and Ri, the start and end month (1 ≤ Li ≤ Ri ≤ 12) of the i-th ingredient's harvesting period.\\n\\n**Output:**\\nFor each test case, print the maximum number of unique dishes Chef can prepare.\\n\\n**Constraints:**\\n1. 1 ≤ T ≤ 10\\n2. 1 ≤ N ≤ 1000\\n3. 1 ≤ Li ≤ Ri ≤ 12\\n\\n**Example:**\\n\\n**Input:**\\n```\\n2\\n3\\n1 4\\n2 6\\n5 8\\n4\\n1 3\\n2 5\\n4 6\\n7 9\\n```\\n\\n**Output:**\\n```\\n2\\n3\\n```\\n\\n**Explanation:**\\n- In the first test case, Chef can use the ingredients available from 1 to 4 for one dish and the ingredients from 5 to 8 for another dish, making a total of 2 dishes.\\n- In the second test case, Chef can use the ingredients available from 1 to 3 for one dish, 4 to 6 for another dish, and 7 to 9 for another dish, making a total of 3 dishes.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\nprint(max_unique_dishes(T, test_cases))  # Output should be [2, 3]\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def max_unique_dishes(T, test_cases):\\n    results = []\\n    for t in range(T):\\n        N = test_cases[t]['N']\\n        periods = test_cases[t]['periods']\\n        periods.sort(key=lambda x: x[1])  # Sorting by the end month (Ri)\\n\\n        count = 0\\n        current_end = 0\\n        \\n        for period in periods:\\n            if period[0] > current_end:\\n                count += 1\\n                current_end = period[1]\\n        \\n        results.append(count)\\n    \\n    return results\\n\\n# Example usage\\nT = 2\\ntest_cases = [\\n    {'N': 3, 'periods': [(1, 4), (2, 6), (5, 8)]},\\n    {'N': 4, 'periods': [(1, 3), (2, 5), (4, 6), (7, 9)]}\\n]\\nprint(max_unique_dishes(T, test_cases))  # Output should be [2, 3]\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_case_1():\\n    assert max_unique_dishes(2, [\\n        {'N': 3, 'periods': [(1, 4), (2, 6), (5, 8)]},\\n        {'N': 4, 'periods': [(1, 3), (2, 5), (4, 6), (7, 9)]}\\n    ]) == [2, 3]\\n\\ndef test_case_2():\\n    assert max_unique_dishes(1, [\\n        {'N': 2, 'periods': [(1, 12), (1, 3)]}\\n    ]) == [1]\\n\\ndef test_case_3():\\n    assert max_unique_dishes(1, [\\n        {'N': 5, 'periods': [(1, 2), (3, 4), (5, 6), (7, 8), (9, 10)]}\\n    ]) == [5]\\n\\ndef test_case_4():\\n    assert max_unique_dishes(1, [\\n        {'N': 3, 'periods': [(1, 3), (2, 4), (3, 5)]}\\n    ]) == [1]\\n\\ndef test_case_5():\\n    assert max_unique_dishes(2, [\\n        {'N': 4, 'periods': [(6, 7), (1, 3), (2, 6), (9, 10)]},\\n        {'N': 3, 'periods': [(1, 4), (5, 8), (9, 12)]}\\n    ]) == [3, 3]\"}]", "tag": "KodCode"}
{"id": "6dd29e44df75237b4a4e97fd22340e233beba0376af57e7a684702d414918f38", "source": "KodCode", "difficulty": "0.444", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: ### Asyncio Synchronization Primitives Assessment\n\nYou are required to implement a parking lot simulator using asyncio primitives in Python. The parking lot has a limited number of parking spaces, and multiple cars (represented as asyncio tasks) will attempt to park in these spaces. Additionally, at regular intervals, an event signaling system will notify all waiting cars that a certain number of new spots have opened up.\n\nYour task includes:\n1. Implementing the parking lot using `asyncio.Semaphore` for managing the parking spots.\n2. Using an `asyncio.Event` to signal the availability of newly opened spots.\n3. Ensuring mutual exclusion using `asyncio.Lock` if necessary.\n\n### Specifications\n\n1. **Input**:\n    - `total_spots`: Total number of parking spots in the parking lot.\n    - `num_cars`: Number of cars attempting to park.\n    - `new_spots`: Number of new spots opening up at every interval.\n    - `arrival_time`: Time (in seconds) each car takes before attempting to park.\n    - `interval`: Time (in seconds) between new spot openings.\n\n2. **Output**:\n    - Print statements that indicate when each car parks and when new spots open up.\n\n3. **Constraints**:\n    - The number of cars (`num_cars`) will always be greater than or equal to `total_spots`.\n    - The number of spots opened at each interval (`new_spots`) will always be a positive integer less than or equal to `total_spots`.\n\n### Example\n```python\nimport asyncio\n\nclass ParkingLot:\n    def __init__(self, total_spots, interval, new_spots):\n        self.available_spots = asyncio.Semaphore(total_spots)\n        self.new_spots_event = asyncio.Event()\n        self.total_spots = total_spots\n        self.interval = interval\n        self.new_spots = new_spots\n\n    async def car_park(self, car_id, arrival_time):\n        await asyncio.sleep(arrival_time)\n        print(f'Car {car_id} arriving at the parking lot.')\n        async with self.available_spots:\n            print(f'Car {car_id} is parking.')\n            await self.new_spots_event.wait()\n            print(f'Car {car_id} finished parking.')\n\n    async def open_new_spots(self):\n        while True:\n            await asyncio.sleep(self.interval)\n            for _ in range(self.new_spots):\n                self.available_spots.release()\n            print(f'Opened {self.new_spots} new spots.')\n            self.new_spots_event.set()\n            self.new_spots_event.clear()\n\nasync def main(total_spots, num_cars, new_spots, arrival_time, interval):\n    parking_lot = ParkingLot(total_spots, interval, new_spots)\n    car_tasks = [parking_lot.car_park(i, arrival_time) for i in range(num_cars)]\n    open_spots_task = parking_lot.open_new_spots()\n\n    await asyncio.gather(open_spots_task, *car_tasks)\n\n# Example input\nasyncio.run(main(total_spots=3, num_cars=10, new_spots=2, arrival_time=1, interval=5))\n```\n\n**Note:** This example is just for illustration and may need adjustments based on your specific requirements.\n\n### Task\n1. Implement the `ParkingLot` class with appropriate asyncio synchronization primitives.\n2. Create the `main` coroutine that initializes the parking lot and runs the simulation.\n3. Ensure that the program runs asynchronously and efficiently.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\n\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: ### Asyncio Synchronization Primitives Assessment\\n\\nYou are required to implement a parking lot simulator using asyncio primitives in Python. The parking lot has a limited number of parking spaces, and multiple cars (represented as asyncio tasks) will attempt to park in these spaces. Additionally, at regular intervals, an event signaling system will notify all waiting cars that a certain number of new spots have opened up.\\n\\nYour task includes:\\n1. Implementing the parking lot using `asyncio.Semaphore` for managing the parking spots.\\n2. Using an `asyncio.Event` to signal the availability of newly opened spots.\\n3. Ensuring mutual exclusion using `asyncio.Lock` if necessary.\\n\\n### Specifications\\n\\n1. **Input**:\\n    - `total_spots`: Total number of parking spots in the parking lot.\\n    - `num_cars`: Number of cars attempting to park.\\n    - `new_spots`: Number of new spots opening up at every interval.\\n    - `arrival_time`: Time (in seconds) each car takes before attempting to park.\\n    - `interval`: Time (in seconds) between new spot openings.\\n\\n2. **Output**:\\n    - Print statements that indicate when each car parks and when new spots open up.\\n\\n3. **Constraints**:\\n    - The number of cars (`num_cars`) will always be greater than or equal to `total_spots`.\\n    - The number of spots opened at each interval (`new_spots`) will always be a positive integer less than or equal to `total_spots`.\\n\\n### Example\\n```python\\nimport asyncio\\n\\nclass ParkingLot:\\n    def __init__(self, total_spots, interval, new_spots):\\n        self.available_spots = asyncio.Semaphore(total_spots)\\n        self.new_spots_event = asyncio.Event()\\n        self.total_spots = total_spots\\n        self.interval = interval\\n        self.new_spots = new_spots\\n\\n    async def car_park(self, car_id, arrival_time):\\n        await asyncio.sleep(arrival_time)\\n        print(f'Car {car_id} arriving at the parking lot.')\\n        async with self.available_spots:\\n            print(f'Car {car_id} is parking.')\\n            await self.new_spots_event.wait()\\n            print(f'Car {car_id} finished parking.')\\n\\n    async def open_new_spots(self):\\n        while True:\\n            await asyncio.sleep(self.interval)\\n            for _ in range(self.new_spots):\\n                self.available_spots.release()\\n            print(f'Opened {self.new_spots} new spots.')\\n            self.new_spots_event.set()\\n            self.new_spots_event.clear()\\n\\nasync def main(total_spots, num_cars, new_spots, arrival_time, interval):\\n    parking_lot = ParkingLot(total_spots, interval, new_spots)\\n    car_tasks = [parking_lot.car_park(i, arrival_time) for i in range(num_cars)]\\n    open_spots_task = parking_lot.open_new_spots()\\n\\n    await asyncio.gather(open_spots_task, *car_tasks)\\n\\n# Example input\\nasyncio.run(main(total_spots=3, num_cars=10, new_spots=2, arrival_time=1, interval=5))\\n```\\n\\n**Note:** This example is just for illustration and may need adjustments based on your specific requirements.\\n\\n### Task\\n1. Implement the `ParkingLot` class with appropriate asyncio synchronization primitives.\\n2. Create the `main` coroutine that initializes the parking lot and runs the simulation.\\n3. Ensure that the program runs asynchronously and efficiently.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\n\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"import asyncio\\n\\nclass ParkingLot:\\n    def __init__(self, total_spots, interval, new_spots):\\n        self.total_spots = total_spots\\n        self.available_spots = asyncio.Semaphore(total_spots)\\n        self.new_spots_event = asyncio.Event()\\n        self.interval = interval\\n        self.new_spots = new_spots\\n\\n    async def car_park(self, car_id, arrival_time):\\n        await asyncio.sleep(arrival_time)\\n        print(f'Car {car_id} arriving at the parking lot.')\\n        await self.available_spots.acquire()\\n        print(f'Car {car_id} is parking.')\\n        await self.new_spots_event.wait()\\n        print(f'Car {car_id} finished parking.')\\n\\n    async def open_new_spots(self):\\n        while True:\\n            await asyncio.sleep(self.interval)\\n            for _ in range(self.new_spots):\\n                self.available_spots.release()\\n            print(f'Opened {self.new_spots} new spots.')\\n            self.new_spots_event.set()\\n            self.new_spots_event.clear()\\n\\nasync def main(total_spots, num_cars, new_spots, arrival_time, interval):\\n    parking_lot = ParkingLot(total_spots, interval, new_spots)\\n    car_tasks = [parking_lot.car_park(i, arrival_time) for i in range(num_cars)]\\n    open_spots_task = asyncio.create_task(parking_lot.open_new_spots())\\n\\n    await asyncio.gather(open_spots_task, *car_tasks)\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\nimport asyncio\\nimport pytest\\n\\n@pytest.mark.asyncio\\nasync def test_parking_lot_simulation():\\n    total_spots = 3\\n    num_cars = 5\\n    new_spots = 1\\n    arrival_time = 1\\n    interval = 2\\n\\n    await main(total_spots, num_cars, new_spots, arrival_time, interval)\"}]", "tag": "KodCode"}
{"id": "b699bba8a38ea7c72c4e0e817cbb439dd36610325039a36190e546a25f4c1095", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: You are given an integer array of length N, b_1, b_2, ..., b_N. You need to determine if you can form a non-empty subsequence such that the sum of its elements is divisible by K.\n\nConstraints\n\n- 1 ≤ N ≤ 10^5\n- 1 ≤ K ≤ 10^9\n- -10^9 ≤ b_i ≤ 10^9 (1 ≤ i ≤ N)\n- b_i is an integer.\n\nInput\n\nThe input is given from Standard Input in the following format:\n\nN K\nb_1 b_2 ... b_N\n\nOutput\n\nPrint \"YES\" if such a subsequence exists, otherwise print \"NO\".\n\nExamples\n\nInput\n\n5 3\n1 2 3 4 5\n\nOutput\n\nYES\n\nInput\n\n6 7\n10 -10 20 -20 30 -30\n\nOutput\n\nYES\n\nInput\n\n3 5\n3 6 7\n\nOutput\n\nNO\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef can_form_subsequence_divisible_by_k(N, K, seq):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: You are given an integer array of length N, b_1, b_2, ..., b_N. You need to determine if you can form a non-empty subsequence such that the sum of its elements is divisible by K.\\n\\nConstraints\\n\\n- 1 ≤ N ≤ 10^5\\n- 1 ≤ K ≤ 10^9\\n- -10^9 ≤ b_i ≤ 10^9 (1 ≤ i ≤ N)\\n- b_i is an integer.\\n\\nInput\\n\\nThe input is given from Standard Input in the following format:\\n\\nN K\\nb_1 b_2 ... b_N\\n\\nOutput\\n\\nPrint \\\"YES\\\" if such a subsequence exists, otherwise print \\\"NO\\\".\\n\\nExamples\\n\\nInput\\n\\n5 3\\n1 2 3 4 5\\n\\nOutput\\n\\nYES\\n\\nInput\\n\\n6 7\\n10 -10 20 -20 30 -30\\n\\nOutput\\n\\nYES\\n\\nInput\\n\\n3 5\\n3 6 7\\n\\nOutput\\n\\nNO\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef can_form_subsequence_divisible_by_k(N, K, seq):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def can_form_subsequence_divisible_by_k(N, K, seq):\\n    # Create a set to store all prefix sums modulo K\\n    prefix_mod = set()\\n    # Initialize the prefix sum\\n    prefix_sum = 0\\n    \\n    for num in seq:\\n        # Update the prefix sum\\n        prefix_sum += num\\n        # Take the modulo by K\\n        mod_value = prefix_sum % K\\n        \\n        # Check if the mod_value is 0 or has been seen before (indicating a valid subsequence)\\n        if mod_value == 0 or mod_value in prefix_mod:\\n            return \\\"YES\\\"\\n        \\n        # Add the current mod_value to the set\\n        prefix_mod.add(mod_value)\\n\\n    return \\\"NO\\\"\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_case1():\\n    N = 5\\n    K = 3\\n    seq = [1, 2, 3, 4, 5]\\n    assert can_form_subsequence_divisible_by_k(N, K, seq) == \\\"YES\\\"\\n\\ndef test_case2():\\n    N = 6\\n    K = 7\\n    seq = [10, -10, 20, -20, 30, -30]\\n    assert can_form_subsequence_divisible_by_k(N, K, seq) == \\\"YES\\\"\\n\\ndef test_case3():\\n    N = 3\\n    K = 5\\n    seq = [3, 6, 7]\\n    assert can_form_subsequence_divisible_by_k(N, K, seq) == \\\"NO\\\"\\n\\ndef test_case4():\\n    N = 4\\n    K = 2\\n    seq = [1, 1, 1, 1]\\n    assert can_form_subsequence_divisible_by_k(N, K, seq) == \\\"YES\\\"\\n\\ndef test_case5():\\n    N = 5\\n    K = 10\\n    seq = [10, 20, 30, 40, 50]\\n    assert can_form_subsequence_divisible_by_k(N, K, seq) == \\\"YES\\\"\\n\\ndef test_case6():\\n    N = 5\\n    K = 1\\n    seq = [0, 0, 0, 0, 0]\\n    assert can_form_subsequence_divisible_by_k(N, K, seq) == \\\"YES\\\"\\n\\ndef test_case7():\\n    N = 5\\n    K = 1000\\n    seq = [0, -2000, 3000, -1000, 4000]\\n    assert can_form_subsequence_divisible_by_k(N, K, seq) == \\\"YES\\\"\\n\\ndef test_case8():\\n    N = 1\\n    K = 1\\n    seq = [1]\\n    assert can_form_subsequence_divisible_by_k(N, K, seq) == \\\"YES\\\"\\n\\ndef test_case9():\\n    N = 1\\n    K = 2\\n    seq = [3]\\n    assert can_form_subsequence_divisible_by_k(N, K, seq) == \\\"NO\\\"\\n\\ndef test_case10():\\n    N = 6\\n    K = 15\\n    seq = [-3, 9, -6, 12, -15, 18]\\n    assert can_form_subsequence_divisible_by_k(N, K, seq) == \\\"YES\\\"\"}]", "tag": "KodCode"}
{"id": "a4a8393d61f5d077f777a0f952ad04ba41f1baf0af7c935cecafd36f492d2964", "source": "KodCode", "difficulty": "0.4", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Write a python function to find the maximum profit from a stock with the transaction fee. You are given a list of stock prices `prices` and an integer `fee`. You can complete as many transactions as you like, but you need to pay the transaction fee for each transaction. The profit is calculated as the total gains from selling the stock after paying the fee.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef max_profit_with_fee(prices, fee):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Write a python function to find the maximum profit from a stock with the transaction fee. You are given a list of stock prices `prices` and an integer `fee`. You can complete as many transactions as you like, but you need to pay the transaction fee for each transaction. The profit is calculated as the total gains from selling the stock after paying the fee.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef max_profit_with_fee(prices, fee):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def max_profit_with_fee(prices, fee):\\n    n = len(prices)\\n    if n <= 1:\\n        return 0\\n    \\n    cash = 0\\n    hold = -prices[0]\\n    \\n    for i in range(1, n):\\n        cash = max(cash, hold + prices[i] - fee)\\n        hold = max(hold, cash - prices[i])\\n    \\n    return cash\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_max_profit_with_fee_no_prices():\\n    assert max_profit_with_fee([], 1) == 0\\n\\ndef test_max_profit_with_fee_single_price():\\n    assert max_profit_with_fee([5], 1) == 0\\n\\ndef test_max_profit_with_fee_standard_case():\\n    assert max_profit_with_fee([1, 3, 2, 8, 4, 9], 2) == 8\\n\\ndef test_max_profit_with_fee_fee_is_higher():\\n    assert max_profit_with_fee([1, 3, 2, 8, 4, 9], 10) == 0\\n\\ndef test_max_profit_with_fee_profit_constant_increase():\\n    assert max_profit_with_fee([1, 2, 3, 4, 5], 1) == 3\\n\\ndef test_max_profit_with_fee_profit_with_high_volatility():\\n    assert max_profit_with_fee([10, 1, 10, 1, 10, 1, 10], 1) == 24\\n\\ndef test_max_profit_with_fee_profit_with_no_fee():\\n    assert max_profit_with_fee([1, 3, 2, 8, 4, 9], 0) == 13\"}]", "tag": "KodCode"}
{"id": "3409cf0e0d8f8dda1cef354eb8e07f97f0a938bca6d05b34c8691f25f9d95d97", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: ### Overview\nCreate a web scraper using Python using BeautifulSoup and requests libraries to scrape job postings from Indeed.com.\n\n### Requirements\n* URL of the Indeed job search page\n* List of job titles\n* Number of jobs to scrape\n* User-Agent header for HTTP request\n* Beautiful Soup parser to parse HTML content\n* Function to scrape job postings\n* Error handling for potential exceptions\n* Store job postings in a list of dictionaries\n\n### Implementation\n```python\nimport requests\nfrom bs4 import BeautifulSoup\n\ndef scrape_indeed_jobs(url, job_titles, num_jobs, user_agent):\n    \"\"\"\n    Scrape job postings from Indeed.com.\n\n    Args:\n    - url (str): URL of the Indeed job search page\n    - job_titles (list): List of job titles\n    - num_jobs (int): Number of jobs to scrape\n    - user_agent (str): User-Agent header for HTTP request\n\n    Returns:\n    - list: List of job postings, each represented as a dictionary\n    \"\"\"\n    # Initialize an empty list to store job postings\n    job_postings = []\n\n    # Set the User-Agent header for the HTTP request\n    headers = {'User-Agent': user_agent}\n\n    # Send an HTTP GET request to the Indeed job search page\n    response = requests.get(url, headers=headers)\n\n    # Check if the HTTP request was successful\n    if response.status_code == 200:\n        # Parse the HTML content of the page using Beautiful Soup\n        soup = BeautifulSoup(response.content, 'html.parser')\n\n        # Find all job posting elements on the page\n        job_elements = soup.find_all('div', class_='job')\n\n        # Iterate over each job posting element\n        for job_element in job_elements:\n            # Extract the job title and link from the job posting element\n            job_title = job_element.find('h2', class_='title').text.strip()\n            job_link = job_element.find('a')['href']\n\n            # Check if the job title is in the list of desired job titles\n            if job_title in job_titles:\n                # Extract the job summary and company from the job posting element\n                job_summary = job_element.find('div', class_='summary').text.strip()\n                company = job_element.find('span', class_='company').text.strip()\n\n                # Create a dictionary to represent the job posting\n                job_posting = {\n                    'title': job_title,\n                    'link': job_link,\n                    'summary': job_summary,\n                    'company': company\n                }\n\n                # Add the job posting to the list of job postings\n                job_postings.append(job_posting)\n\n                # Check if the desired number of jobs has been reached\n                if len(job_postings) == num_jobs:\n                    break\n\n        # Return the list of job postings\n        return job_postings\n\n    # Handle potential exceptions\n    except requests.exceptions.RequestException as e:\n        print(f\"Error: {e}\")\n        return []\n\n# Usage example\nurl = \"https://www.indeed.com/jobs?\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef scrape_indeed_jobs(url, job_titles, num_jobs, user_agent):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: ### Overview\\nCreate a web scraper using Python using BeautifulSoup and requests libraries to scrape job postings from Indeed.com.\\n\\n### Requirements\\n* URL of the Indeed job search page\\n* List of job titles\\n* Number of jobs to scrape\\n* User-Agent header for HTTP request\\n* Beautiful Soup parser to parse HTML content\\n* Function to scrape job postings\\n* Error handling for potential exceptions\\n* Store job postings in a list of dictionaries\\n\\n### Implementation\\n```python\\nimport requests\\nfrom bs4 import BeautifulSoup\\n\\ndef scrape_indeed_jobs(url, job_titles, num_jobs, user_agent):\\n    \\\"\\\"\\\"\\n    Scrape job postings from Indeed.com.\\n\\n    Args:\\n    - url (str): URL of the Indeed job search page\\n    - job_titles (list): List of job titles\\n    - num_jobs (int): Number of jobs to scrape\\n    - user_agent (str): User-Agent header for HTTP request\\n\\n    Returns:\\n    - list: List of job postings, each represented as a dictionary\\n    \\\"\\\"\\\"\\n    # Initialize an empty list to store job postings\\n    job_postings = []\\n\\n    # Set the User-Agent header for the HTTP request\\n    headers = {'User-Agent': user_agent}\\n\\n    # Send an HTTP GET request to the Indeed job search page\\n    response = requests.get(url, headers=headers)\\n\\n    # Check if the HTTP request was successful\\n    if response.status_code == 200:\\n        # Parse the HTML content of the page using Beautiful Soup\\n        soup = BeautifulSoup(response.content, 'html.parser')\\n\\n        # Find all job posting elements on the page\\n        job_elements = soup.find_all('div', class_='job')\\n\\n        # Iterate over each job posting element\\n        for job_element in job_elements:\\n            # Extract the job title and link from the job posting element\\n            job_title = job_element.find('h2', class_='title').text.strip()\\n            job_link = job_element.find('a')['href']\\n\\n            # Check if the job title is in the list of desired job titles\\n            if job_title in job_titles:\\n                # Extract the job summary and company from the job posting element\\n                job_summary = job_element.find('div', class_='summary').text.strip()\\n                company = job_element.find('span', class_='company').text.strip()\\n\\n                # Create a dictionary to represent the job posting\\n                job_posting = {\\n                    'title': job_title,\\n                    'link': job_link,\\n                    'summary': job_summary,\\n                    'company': company\\n                }\\n\\n                # Add the job posting to the list of job postings\\n                job_postings.append(job_posting)\\n\\n                # Check if the desired number of jobs has been reached\\n                if len(job_postings) == num_jobs:\\n                    break\\n\\n        # Return the list of job postings\\n        return job_postings\\n\\n    # Handle potential exceptions\\n    except requests.exceptions.RequestException as e:\\n        print(f\\\"Error: {e}\\\")\\n        return []\\n\\n# Usage example\\nurl = \\\"https://www.indeed.com/jobs?\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef scrape_indeed_jobs(url, job_titles, num_jobs, user_agent):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"import requests\\nfrom bs4 import BeautifulSoup\\n\\ndef scrape_indeed_jobs(url, job_titles, num_jobs, user_agent):\\n    \\\"\\\"\\\"\\n    Scrape job postings from Indeed.com.\\n\\n    Args:\\n    - url (str): URL of the Indeed job search page\\n    - job_titles (list): List of job titles\\n    - num_jobs (int): Number of jobs to scrape\\n    - user_agent (str): User-Agent header for HTTP request\\n\\n    Returns:\\n    - list: List of job postings, each represented as a dictionary\\n    \\\"\\\"\\\"\\n    # Initialize an empty list to store job postings\\n    job_postings = []\\n\\n    # Set the User-Agent header for the HTTP request\\n    headers = {'User-Agent': user_agent}\\n\\n    try:\\n        # Send an HTTP GET request to the Indeed job search page\\n        response = requests.get(url, headers=headers)\\n        # Check if the HTTP request was successful\\n        if response.status_code == 200:\\n            # Parse the HTML content of the page using Beautiful Soup\\n            soup = BeautifulSoup(response.content, 'html.parser')\\n\\n            # Find all job posting elements on the page\\n            job_elements = soup.find_all('div', class_='jobsearch-SerpJobCard')\\n\\n            # Iterate over each job posting element\\n            for job_element in job_elements:\\n                # Extract the job title and link from the job posting element\\n                job_title = job_element.find('h2', class_='title').text.strip()\\n                job_link = job_element.find('a')['href']\\n\\n                # Check if the job title is in the list of desired job titles\\n                if job_title in job_titles:\\n                    # Extract the job summary and company from the job posting element\\n                    job_summary = job_element.find('div', class_='summary').text.strip()\\n                    company = job_element.find('span', class_='company').text.strip()\\n\\n                    # Create a dictionary to represent the job posting\\n                    job_posting = {\\n                        'title': job_title,\\n                        'link': job_link,\\n                        'summary': job_summary,\\n                        'company': company\\n                    }\\n\\n                    # Add the job posting to the list of job postings\\n                    job_postings.append(job_posting)\\n\\n                    # Check if the desired number of jobs has been reached\\n                    if len(job_postings) == num_jobs:\\n                        break\\n\\n        return job_postings\\n\\n    # Handle potential exceptions\\n    except requests.exceptions.RequestException as e:\\n        print(f\\\"Error: {e}\\\")\\n        return []\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\nimport requests\\nfrom bs4 import BeautifulSoup\\nimport pytest\\n\\n@pytest.fixture\\ndef mock_html():\\n    return \\\"\\\"\\\"\\n    <html>\\n        <body>\\n            <div class=\\\"jobsearch-SerpJobCard\\\">\\n                <h2 class=\\\"title\\\"><a href=\\\"/job1\\\">Software Developer</a></h2>\\n                <span class=\\\"company\\\">Company A</span>\\n                <div class=\\\"summary\\\">Job summary for Software Developer</div>\\n            </div>\\n            <div class=\\\"jobsearch-SerpJobCard\\\">\\n                <h2 class=\\\"title\\\"><a href=\\\"/job2\\\">Data Scientist</a></h2>\\n                <span class=\\\"company\\\">Company B</span>\\n                <div class=\\\"summary\\\">Job summary for Data Scientist</div>\\n            </div>\\n        </body>\\n    </html>\\n    \\\"\\\"\\\"\\n\\n@pytest.fixture\\ndef mock_response(mock_html, monkeypatch):\\n    class MockResponse:\\n        status_code = 200\\n        content = mock_html\\n    \\n    def mock_get(*args, **kwargs):\\n        return MockResponse()\\n\\n    monkeypatch.setattr(requests, \\\"get\\\", mock_get)\\n\\ndef test_scrape_indeed_jobs(mock_response):\\n    url = \\\"https://www.indeed.com/jobs?q=developer\\\"\\n    job_titles = [\\\"Software Developer\\\", \\\"Data Scientist\\\"]\\n    num_jobs = 2\\n    user_agent = \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3\\\"\\n    \\n    expected_output = [\\n        {\\n            'title': 'Software Developer',\\n            'link': '/job1',\\n            'summary': 'Job summary for Software Developer',\\n            'company': 'Company A'\\n        },\\n        {\\n            'title': 'Data Scientist',\\n            'link': '/job2',\\n            'summary': 'Job summary for Data Scientist',\\n            'company': 'Company B'\\n        }\\n    ]\\n\\n    result = scrape_indeed_jobs(url, job_titles, num_jobs, user_agent)\\n    assert result == expected_output\\n\\ndef test_scrape_indeed_jobs_no_jobs(monkeypatch):\\n    def mock_get_empty(*args, **kwargs):\\n        class MockResponse:\\n            status_code = 200\\n            content = \\\"<html><body></body></html>\\\"\\n        return MockResponse()\\n\\n    monkeypatch.setattr(requests, \\\"get\\\", mock_get_empty)\\n    url = \\\"https://www.indeed.com/jobs?q=developer\\\"\\n    job_titles = [\\\"Software Developer\\\"]\\n    num_jobs = 1\\n    user_agent = \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3\\\"\\n\\n    result = scrape_indeed_jobs(url, job_titles, num_jobs, user_agent)\\n    assert result == []\\n\\ndef test_scrape_indeed_jobs_request_exception(monkeypatch):\\n    def mock_get_exception(*args, **kwargs):\\n        raise requests.exceptions.RequestException(\\\"Connection error\\\")\\n\\n    monkeypatch.setattr(requests, \\\"get\\\", mock_get_exception)\\n    url = \\\"https://www.indeed.com/jobs?q=developer\\\"\\n    job_titles = [\\\"Software Developer\\\"]\\n    num_jobs = 1\\n    user_agent = \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3\\\"\\n\\n    result = scrape_indeed_jobs(url, job_titles, num_jobs, user_agent)\\n    assert result == []\"}]", "tag": "KodCode"}
{"id": "3145c7d6ad55d560b46243d4ddacc3313522bac2babccce73046606dc91b6611", "source": "KodCode", "difficulty": "0.3", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Given an array of integers `arr` and an integer `target`, return the number of **unique pairs** of integers in `arr` whose sum is equal to `target`. A pair (arr[i], arr[j]) is considered unique if there are no other pairs (arr[k], arr[l]) where (arr[i] == arr[k] and arr[j] == arr[l]) or (arr[i] == arr[l] and arr[j] == arr[k]).\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef count_unique_pairs(arr, target):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Given an array of integers `arr` and an integer `target`, return the number of **unique pairs** of integers in `arr` whose sum is equal to `target`. A pair (arr[i], arr[j]) is considered unique if there are no other pairs (arr[k], arr[l]) where (arr[i] == arr[k] and arr[j] == arr[l]) or (arr[i] == arr[l] and arr[j] == arr[k]).\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef count_unique_pairs(arr, target):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def count_unique_pairs(arr, target):\\n    \\\"\\\"\\\"\\n    Returns the number of unique pairs of integers in `arr` whose sum is equal to `target`.\\n    \\\"\\\"\\\"\\n    seen = set()\\n    unique_pairs = set()\\n\\n    for num in arr:\\n        complement = target - num\\n        if complement in seen:\\n            pair = tuple(sorted((num, complement)))\\n            unique_pairs.add(pair)\\n        seen.add(num)\\n        \\n    return len(unique_pairs)\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_count_unique_pairs():\\n    assert count_unique_pairs([1, 2, 3, 4, 3], 6) == 2  # Pairs are (2, 4) and (3, 3)\\n    assert count_unique_pairs([1, 5, 1, 5], 6) == 1     # Pair is (1, 5)\\n    assert count_unique_pairs([1, 2, 3, 4], 8) == 0     # No pairs sum to 8\\n    assert count_unique_pairs([2, 2, 2, 2], 4) == 1     # Pair is (2, 2)\\n    assert count_unique_pairs([1, 9, 2, 8, 3, 7, 4, 6, 5], 10) == 4  # Pairs are (1, 9), (2, 8), (3, 7), (4, 6)\\n\\ndef test_count_unique_pairs_empty_array():\\n    assert count_unique_pairs([], 5) == 0  # No pairs in an empty array\\n\\ndef test_count_unique_pairs_single_element():\\n    assert count_unique_pairs([5], 5) == 0  # No pair with a single element\\n    assert count_unique_pairs([5], 10) == 0  # No pair with a single element\\n\\ndef test_count_unique_pairs_multiple_targets():\\n    assert count_unique_pairs([1, 2, 3, 4, 5], 6) == 2  # Pairs are (1, 5) and (2, 4)\\n    assert count_unique_pairs([1, 2, 3, 4, 5], 7) == 2  # Pairs are (2, 5) and (3, 4)\"}]", "tag": "KodCode"}
{"id": "8bcd0646b67e67095fdaed4065cb23f83b2f0bf6fbad0673f5815c8817410839", "source": "KodCode", "difficulty": "0.333", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef isAlmostSorted(arr):\n    \"\"\" Given an array of integers, check if it can be classified as an \"Almost Sorted Array\". An array is considered \"Almost Sorted\" if, after removing exactly one element, the remaining elements are sorted in non-decreasing order. If the array is already sorted, it is also considered \"Almost Sorted\". Write a function that returns \"YES\" if the array is Almost Sorted, otherwise return \"NO\".\n    >>> isAlmostSorted([10, 5, 7])\n    \"YES\"\n    >>> isAlmostSorted([10, 5, 1])\n    \"NO\"\n    >>> isAlmostSorted([1, 2, 3, 4, 5])\n    \"YES\"\n    >>> isAlmostSorted([1, 3, 2, 4, 5])\n    \"YES\"\n    >>> isAlmostSorted([5, 1, 2, 3, 4])\n    \"YES\"\n    >>> isAlmostSorted([4, 3, 2, 1])\n    \"NO\"\n    >>> isAlmostSorted([1])\n    \"YES\"\n    >>> isAlmostSorted([1, 2])\n    \"YES\"\n    >>> isAlmostSorted([2, 1])\n    \"YES\"\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef isAlmostSorted(arr):\\n    \\\"\\\"\\\" Given an array of integers, check if it can be classified as an \\\"Almost Sorted Array\\\". An array is considered \\\"Almost Sorted\\\" if, after removing exactly one element, the remaining elements are sorted in non-decreasing order. If the array is already sorted, it is also considered \\\"Almost Sorted\\\". Write a function that returns \\\"YES\\\" if the array is Almost Sorted, otherwise return \\\"NO\\\".\\n    >>> isAlmostSorted([10, 5, 7])\\n    \\\"YES\\\"\\n    >>> isAlmostSorted([10, 5, 1])\\n    \\\"NO\\\"\\n    >>> isAlmostSorted([1, 2, 3, 4, 5])\\n    \\\"YES\\\"\\n    >>> isAlmostSorted([1, 3, 2, 4, 5])\\n    \\\"YES\\\"\\n    >>> isAlmostSorted([5, 1, 2, 3, 4])\\n    \\\"YES\\\"\\n    >>> isAlmostSorted([4, 3, 2, 1])\\n    \\\"NO\\\"\\n    >>> isAlmostSorted([1])\\n    \\\"YES\\\"\\n    >>> isAlmostSorted([1, 2])\\n    \\\"YES\\\"\\n    >>> isAlmostSorted([2, 1])\\n    \\\"YES\\\"\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def isAlmostSorted(arr):\\n    def is_sorted(sequence):\\n        return all(sequence[i] <= sequence[i + 1] for i in range(len(sequence) - 1))\\n    \\n    if is_sorted(arr):\\n        return \\\"YES\\\"\\n    \\n    for i in range(len(arr)):\\n        if is_sorted(arr[:i] + arr[i+1:]):\\n            return \\\"YES\\\"\\n    \\n    return \\\"NO\\\"\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_example1():\\n    assert isAlmostSorted([10, 5, 7]) == \\\"YES\\\"\\n\\ndef test_example2():\\n    assert isAlmostSorted([10, 5, 1]) == \\\"NO\\\"\\n\\ndef test_already_sorted():\\n    assert isAlmostSorted([1, 2, 3, 4, 5]) == \\\"YES\\\"\\n\\ndef test_remove_one_element_to_sort():\\n    assert isAlmostSorted([1, 3, 2, 4, 5]) == \\\"YES\\\"\\n\\ndef test_remove_different_element():\\n    assert isAlmostSorted([5, 1, 2, 3, 4]) == \\\"YES\\\"\\n\\ndef test_no_possible_removal():\\n    assert isAlmostSorted([4, 3, 2, 1]) == \\\"NO\\\"\\n\\ndef test_single_element():\\n    assert isAlmostSorted([1]) == \\\"YES\\\"\\n\\ndef test_two_elements_sorted():\\n    assert isAlmostSorted([1, 2]) == \\\"YES\\\"\\n\\ndef test_two_elements_unsorted():\\n    assert isAlmostSorted([2, 1]) == \\\"YES\\\"\"}]", "tag": "KodCode"}
{"id": "48d101e48d174b646563cee71fea16788a70094b973a12fd1750f381f4b3d5db", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: ### AVL Tree Implementation and Balance Operations\n\n#### Context\nAn AVL Tree is a self-balancing binary search tree. In an AVL tree, the heights of the two child subtrees of any node differ by at most one. If at any time they differ by more than one, re-balancing is done to restore this property.\n\n#### Task\nYour task is to implement and test the AVL Tree insertion and balancing operations. Write a function `insert_avl(avl_tree, key)` that inserts a `key` into the given `avl_tree` and then balances the tree if necessary. You should use the provided AVL Tree class and its methods for this purpose.\n\n##### Function Signature\n```python\ndef insert_avl(avl_tree: AvlTree, key: int) -> None:\n    ...\n```\n\n##### Parameters\n- `avl_tree` (AvlTree): The root of the AVL tree where the key should be inserted.\n- `key` (int): The value to be inserted into the AVL tree.\n\n#### Example\n\nConsider the following example:\n```python\ntree = AvlTree()\ninsert_avl(tree, 10)\ninsert_avl(tree, 20)\ninsert_avl(tree, 30)\n\nprint(tree.in_order_traverse())  # Output should be [10, 20, 30]\n```\n\n#### Constraints\n- Assume the keys are unique integers.\n- You should handle the insertion process in such a way that the AVL tree properties are maintained (balance factor of each node is -1, 0, or 1).\n\n#### Notes\n- Ensure the balance factors are correctly updated after each insertion.\n- Handle edge cases such as inserting into an empty tree or causing rotations that affect multiple levels of the tree.\n- Focus on correct re-balancing using single and double rotations as needed.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\n\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: ### AVL Tree Implementation and Balance Operations\\n\\n#### Context\\nAn AVL Tree is a self-balancing binary search tree. In an AVL tree, the heights of the two child subtrees of any node differ by at most one. If at any time they differ by more than one, re-balancing is done to restore this property.\\n\\n#### Task\\nYour task is to implement and test the AVL Tree insertion and balancing operations. Write a function `insert_avl(avl_tree, key)` that inserts a `key` into the given `avl_tree` and then balances the tree if necessary. You should use the provided AVL Tree class and its methods for this purpose.\\n\\n##### Function Signature\\n```python\\ndef insert_avl(avl_tree: AvlTree, key: int) -> None:\\n    ...\\n```\\n\\n##### Parameters\\n- `avl_tree` (AvlTree): The root of the AVL tree where the key should be inserted.\\n- `key` (int): The value to be inserted into the AVL tree.\\n\\n#### Example\\n\\nConsider the following example:\\n```python\\ntree = AvlTree()\\ninsert_avl(tree, 10)\\ninsert_avl(tree, 20)\\ninsert_avl(tree, 30)\\n\\nprint(tree.in_order_traverse())  # Output should be [10, 20, 30]\\n```\\n\\n#### Constraints\\n- Assume the keys are unique integers.\\n- You should handle the insertion process in such a way that the AVL tree properties are maintained (balance factor of each node is -1, 0, or 1).\\n\\n#### Notes\\n- Ensure the balance factors are correctly updated after each insertion.\\n- Handle edge cases such as inserting into an empty tree or causing rotations that affect multiple levels of the tree.\\n- Focus on correct re-balancing using single and double rotations as needed.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\n\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"class AvlNode:\\n    def __init__(self, key):\\n        self.key = key\\n        self.left = None\\n        self.right = None\\n        self.height = 1\\n\\nclass AvlTree:\\n    def __init__(self):\\n        self.root = None\\n\\n    def insert(self, key):\\n        self.root = self._insert(self.root, key)\\n\\n    def _insert(self, node, key):\\n        if not node:\\n            return AvlNode(key)\\n\\n        if key < node.key:\\n            node.left = self._insert(node.left, key)\\n        else:\\n            node.right = self._insert(node.right, key)\\n\\n        node.height = 1 + max(self.get_height(node.left), self.get_height(node.right))\\n        balance = self.get_balance(node)\\n\\n        if balance > 1:\\n            if key < node.left.key:\\n                return self.right_rotate(node)\\n            else:\\n                node.left = self.left_rotate(node.left)\\n                return self.right_rotate(node)\\n\\n        if balance < -1:\\n            if key > node.right.key:\\n                return self.left_rotate(node)\\n            else:\\n                node.right = self.right_rotate(node.right)\\n                return self.left_rotate(node)\\n\\n        return node\\n\\n    def left_rotate(self, z):\\n        y = z.right\\n        T2 = y.left\\n\\n        y.left = z\\n        z.right = T2\\n\\n        z.height = 1 + max(self.get_height(z.left), self.get_height(z.right))\\n        y.height = 1 + max(self.get_height(y.left), self.get_height(y.right))\\n\\n        return y\\n\\n    def right_rotate(self, z):\\n        y = z.left\\n        T3 = y.right\\n\\n        y.right = z\\n        z.left = T3\\n\\n        z.height = 1 + max(self.get_height(z.left), self.get_height(z.right))\\n        y.height = 1 + max(self.get_height(y.left), self.get_height(y.right))\\n\\n        return y\\n\\n    def get_height(self, node):\\n        if not node:\\n            return 0\\n        return node.height\\n\\n    def get_balance(self, node):\\n        if not node:\\n            return 0\\n        return self.get_height(node.left) - self.get_height(node.right)\\n\\n    def in_order_traverse(self):\\n        return self._in_order_traverse(self.root)\\n\\n    def _in_order_traverse(self, node):\\n        res = []\\n        if node:\\n            res = self._in_order_traverse(node.left)\\n            res.append(node.key)\\n            res = res + self._in_order_traverse(node.right)\\n        return res\\n\\n\\ndef insert_avl(avl_tree: AvlTree, key: int) -> None:\\n    avl_tree.insert(key)\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_insert_single_node():\\n    tree = AvlTree()\\n    insert_avl(tree, 10)\\n    assert tree.in_order_traverse() == [10]\\n\\ndef test_insert_multiple_nodes():\\n    tree = AvlTree()\\n    insert_avl(tree, 10)\\n    insert_avl(tree, 20)\\n    insert_avl(tree, 30)\\n    assert tree.in_order_traverse() == [10, 20, 30]\\n\\ndef test_left_rotation():\\n    tree = AvlTree()\\n    insert_avl(tree, 10)\\n    insert_avl(tree, 20)\\n    insert_avl(tree, 30)\\n    assert tree.root.key == 20\\n    assert tree.root.left.key == 10\\n    assert tree.root.right.key == 30\\n\\ndef test_right_rotation():\\n    tree = AvlTree()\\n    insert_avl(tree, 30)\\n    insert_avl(tree, 20)\\n    insert_avl(tree, 10)\\n    assert tree.root.key == 20\\n    assert tree.root.left.key == 10\\n    assert tree.root.right.key == 30\\n\\ndef test_left_right_rotation():\\n    tree = AvlTree()\\n    insert_avl(tree, 30)\\n    insert_avl(tree, 10)\\n    insert_avl(tree, 20)\\n    assert tree.root.key == 20\\n    assert tree.root.left.key == 10\\n    assert tree.root.right.key == 30\\n\\ndef test_right_left_rotation():\\n    tree = AvlTree()\\n    insert_avl(tree, 10)\\n    insert_avl(tree, 30)\\n    insert_avl(tree, 20)\\n    assert tree.root.key == 20\\n    assert tree.root.left.key == 10\\n    assert tree.root.right.key == 30\"}]", "tag": "KodCode"}
{"id": "a1f7987f9dd1d9a97b67632b11d0c2043e7c969818f19c0bbebc5901e5377ddf", "source": "KodCode", "difficulty": "0.8", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef reverse_string(s: str) -> str:\n    \"\"\" Returns the reversed string of the input string s.\n    >>> reverse_string('hello') 'olleh'\n    >>> reverse_string('') ''\n    >>> reverse_string('world') 'dlrow'\n    >>> reverse_string('a') 'a'\n    >>> reverse_string('Python') 'nohtyP'\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef reverse_string(s: str) -> str:\\n    \\\"\\\"\\\" Returns the reversed string of the input string s.\\n    >>> reverse_string('hello') 'olleh'\\n    >>> reverse_string('') ''\\n    >>> reverse_string('world') 'dlrow'\\n    >>> reverse_string('a') 'a'\\n    >>> reverse_string('Python') 'nohtyP'\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def reverse_string(s):\\n    \\\"\\\"\\\"\\n    Returns the reversed string of the input string s.\\n    \\\"\\\"\\\"\\n    return s[::-1]\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_reverse_string():\\n    assert reverse_string('hello') == 'olleh'\\n    assert reverse_string('') == ''\\n    assert reverse_string('world') == 'dlrow'\\n    assert reverse_string('a') == 'a'\\n    assert reverse_string('Python') == 'nohtyP'\"}]", "tag": "KodCode"}
{"id": "abcf190c4fc208dae290b71617eca5410b92e7e401c450aa6f5fa511b946ce8d", "source": "KodCode", "difficulty": "0.3", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef numIslands(grid: List[List[int]]) -> int:\n    \"\"\" Count the number of islands in a 2D grid map of 1s (land) and 0s (water).\n    \n    >>> grid = [\n    ...     [1,1,0,0,0],\n    ...     [1,1,0,0,0],\n    ...     [0,0,1,0,0],\n    ...     [0,0,0,1,1]\n    ... ]\n    >>> numIslands(grid)\n    3\n    >>> grid = [\n    ...     [1,0],\n    ...     [0,0]\n    ... ]\n    >>> numIslands(grid)\n    1\n    >>> grid = [\n    ...     [1,1,1,0,0],\n    ...     [1,1,1,0,0],\n    ...     [1,1,1,0,0],\n    ...     [0,0,0,0,0],\n    ...     [0,0,0,0,1]\n    ... ]\n    >>> numIslands(grid)\n    2\n    >>> grid = [\n    ...     [1,0,0,1],\n    ...     [0,0,0,0],\n    ...     [0,0,1,0],\n    ...     [0,1,0,0]\n    ... ]\n    >>> numIslands(grid)\n    4\n    >>> grid = [\n    ...     [0,0],\n    ...     [0,0]\n    ... ]\n    >>> numIslands(grid)\n    0\n    >>> grid = []\n    >>> numIslands(grid)\n    0\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef numIslands(grid: List[List[int]]) -> int:\\n    \\\"\\\"\\\" Count the number of islands in a 2D grid map of 1s (land) and 0s (water).\\n    \\n    >>> grid = [\\n    ...     [1,1,0,0,0],\\n    ...     [1,1,0,0,0],\\n    ...     [0,0,1,0,0],\\n    ...     [0,0,0,1,1]\\n    ... ]\\n    >>> numIslands(grid)\\n    3\\n    >>> grid = [\\n    ...     [1,0],\\n    ...     [0,0]\\n    ... ]\\n    >>> numIslands(grid)\\n    1\\n    >>> grid = [\\n    ...     [1,1,1,0,0],\\n    ...     [1,1,1,0,0],\\n    ...     [1,1,1,0,0],\\n    ...     [0,0,0,0,0],\\n    ...     [0,0,0,0,1]\\n    ... ]\\n    >>> numIslands(grid)\\n    2\\n    >>> grid = [\\n    ...     [1,0,0,1],\\n    ...     [0,0,0,0],\\n    ...     [0,0,1,0],\\n    ...     [0,1,0,0]\\n    ... ]\\n    >>> numIslands(grid)\\n    4\\n    >>> grid = [\\n    ...     [0,0],\\n    ...     [0,0]\\n    ... ]\\n    >>> numIslands(grid)\\n    0\\n    >>> grid = []\\n    >>> numIslands(grid)\\n    0\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def numIslands(grid):\\n    if not grid:\\n        return 0\\n\\n    num_rows = len(grid)\\n    num_cols = len(grid[0])\\n    visited = [[False for _ in range(num_cols)] for _ in range(num_rows)]\\n    \\n    def dfs(row, col):\\n        if row < 0 or col < 0 or row >= num_rows or col >= num_cols or visited[row][col] or grid[row][col] == 0:\\n            return\\n        visited[row][col] = True\\n        dfs(row - 1, col)\\n        dfs(row + 1, col)\\n        dfs(row, col - 1)\\n        dfs(row, col + 1)\\n    \\n    num_islands = 0\\n    for row in range(num_rows):\\n        for col in range(num_cols):\\n            if grid[row][col] == 1 and not visited[row][col]:\\n                dfs(row, col)\\n                num_islands += 1\\n\\n    return num_islands\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_numIslands_example():\\n    grid = [\\n        [1,1,0,0,0],\\n        [1,1,0,0,0],\\n        [0,0,1,0,0],\\n        [0,0,0,1,1]\\n    ]\\n    assert numIslands(grid) == 3\\n\\ndef test_numIslands_single_cell_island():\\n    grid = [\\n        [1,0],\\n        [0,0]\\n    ]\\n    assert numIslands(grid) == 1\\n\\ndef test_numIslands_large_island():\\n    grid = [\\n        [1,1,1,0,0],\\n        [1,1,1,0,0],\\n        [1,1,1,0,0],\\n        [0,0,0,0,0],\\n        [0,0,0,0,1]\\n    ]\\n    assert numIslands(grid) == 2\\n\\ndef test_numIslands_disjoint():\\n    grid = [\\n        [1,0,0,1],\\n        [0,0,0,0],\\n        [0,0,1,0],\\n        [0,1,0,0]\\n    ]\\n    assert numIslands(grid) == 4\\n\\ndef test_numIslands_all_water():\\n    grid = [\\n        [0,0],\\n        [0,0]\\n    ]\\n    assert numIslands(grid) == 0\\n\\ndef test_numIslands_empty_grid():\\n    grid = []\\n    assert numIslands(grid) == 0\"}]", "tag": "KodCode"}
{"id": "1bf216f0ad0a7099d39bef0afe7487b075d0a4b3b79b6df8ed5ba3991494d832", "source": "KodCode", "difficulty": "0.4", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\nimport re\nfrom typing import List\n\ndef reverse_vowels(s: str) -> str:\n    \"\"\" \n    Returns a new string with the vowels reversed while keeping other characters\n    in their original positions.\n    \n    >>> reverse_vowels(\"hello\")\n    \"holle\"\n    \n    >>> reverse_vowels(\"leetcode\")\n    \"leotcede\"\n    \n    >>> reverse_vowels(\"\")\n    \"\"\n    \n    >>> reverse_vowels(\"bcdfg\")\n    \"bcdfg\"\n    \n    >>> reverse_vowels(\"aeiou\")\n    \"uoiea\"\n    \n    >>> reverse_vowels(\"AEIOU\")\n    \"UOIEA\"\n    \n    >>> reverse_vowels(\"aA\")\n    \"Aa\"\n    \n    >>> reverse_vowels(\"a\")\n    \"a\"\n    \n    >>> reverse_vowels(\"b\")\n    \"b\"\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\nimport re\\nfrom typing import List\\n\\ndef reverse_vowels(s: str) -> str:\\n    \\\"\\\"\\\" \\n    Returns a new string with the vowels reversed while keeping other characters\\n    in their original positions.\\n    \\n    >>> reverse_vowels(\\\"hello\\\")\\n    \\\"holle\\\"\\n    \\n    >>> reverse_vowels(\\\"leetcode\\\")\\n    \\\"leotcede\\\"\\n    \\n    >>> reverse_vowels(\\\"\\\")\\n    \\\"\\\"\\n    \\n    >>> reverse_vowels(\\\"bcdfg\\\")\\n    \\\"bcdfg\\\"\\n    \\n    >>> reverse_vowels(\\\"aeiou\\\")\\n    \\\"uoiea\\\"\\n    \\n    >>> reverse_vowels(\\\"AEIOU\\\")\\n    \\\"UOIEA\\\"\\n    \\n    >>> reverse_vowels(\\\"aA\\\")\\n    \\\"Aa\\\"\\n    \\n    >>> reverse_vowels(\\\"a\\\")\\n    \\\"a\\\"\\n    \\n    >>> reverse_vowels(\\\"b\\\")\\n    \\\"b\\\"\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def reverse_vowels(s):\\n    \\\"\\\"\\\"\\n    Returns a new string with the vowels reversed while keeping other characters\\n    in their original positions.\\n    \\\"\\\"\\\"\\n    vowels = set('aeiouAEIOU')\\n    s_list = list(s)\\n    left, right = 0, len(s) - 1\\n\\n    while left < right:\\n        if s_list[left] not in vowels:\\n            left += 1\\n        elif s_list[right] not in vowels:\\n            right -= 1\\n        else:\\n            s_list[left], s_list[right] = s_list[right], s_list[left]\\n            left += 1\\n            right -= 1\\n\\n    return ''.join(s_list)\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_reverse_vowels_regular_case():\\n    assert reverse_vowels(\\\"hello\\\") == \\\"holle\\\"\\n    assert reverse_vowels(\\\"leetcode\\\") == \\\"leotcede\\\"\\n\\ndef test_reverse_vowels_empty_string():\\n    assert reverse_vowels(\\\"\\\") == \\\"\\\"\\n\\ndef test_reverse_vowels_no_vowels():\\n    assert reverse_vowels(\\\"bcdfg\\\") == \\\"bcdfg\\\"\\n\\ndef test_reverse_vowels_all_vowels():\\n    assert reverse_vowels(\\\"aeiou\\\") == \\\"uoiea\\\"\\n    assert reverse_vowels(\\\"AEIOU\\\") == \\\"UOIEA\\\"\\n\\ndef test_reverse_vowels_mixed_case():\\n    assert reverse_vowels(\\\"aA\\\") == \\\"Aa\\\"\\n\\ndef test_reverse_vowels_single_characters():\\n    assert reverse_vowels(\\\"a\\\") == \\\"a\\\"\\n    assert reverse_vowels(\\\"b\\\") == \\\"b\\\"\"}]", "tag": "KodCode"}
{"id": "615a2eceaa11ea85c8cf88eef87c86f7ec15d1d58f2a6abcd9b0866ba15d69e5", "source": "KodCode", "difficulty": "0.3", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\nfrom typing import List\n\ndef find_longest_concatenated_word(words: List[str]) -> str:\n    \"\"\"Find the longest word that can be constructed by concatenating other words from the list.\n    If there are multiple possible answers, return the one that appears first in the list.\n    If no such word is found, return an empty string.\n\n    >>> find_longest_concatenated_word([\"cat\", \"cats\", \"catsdogcats\", \"dog\", \"dogcatsdog\", \"hippopotamuses\", \"rat\", \"ratcatdogcat\"]) \n    'ratcatdogcat'\n    >>> find_longest_concatenated_word([\"cat\", \"dog\", \"fish\"]) \n    ''\n    >>> find_longest_concatenated_word([\"cat\"]) \n    ''\n    >>> find_longest_concatenated_word([\"a\", \"b\", \"ab\", \"abc\", \"abcd\", \"abcde\", \"a\", \"bcde\", \"cde\", \"de\", \"e\"]) \n    'abcde'\n    >>> find_longest_concatenated_word([\"cat\", \"cats\", \"dog\", \"catsdog\", \"catdog\"]) \n    'catsdog'\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\nfrom typing import List\\n\\ndef find_longest_concatenated_word(words: List[str]) -> str:\\n    \\\"\\\"\\\"Find the longest word that can be constructed by concatenating other words from the list.\\n    If there are multiple possible answers, return the one that appears first in the list.\\n    If no such word is found, return an empty string.\\n\\n    >>> find_longest_concatenated_word([\\\"cat\\\", \\\"cats\\\", \\\"catsdogcats\\\", \\\"dog\\\", \\\"dogcatsdog\\\", \\\"hippopotamuses\\\", \\\"rat\\\", \\\"ratcatdogcat\\\"]) \\n    'ratcatdogcat'\\n    >>> find_longest_concatenated_word([\\\"cat\\\", \\\"dog\\\", \\\"fish\\\"]) \\n    ''\\n    >>> find_longest_concatenated_word([\\\"cat\\\"]) \\n    ''\\n    >>> find_longest_concatenated_word([\\\"a\\\", \\\"b\\\", \\\"ab\\\", \\\"abc\\\", \\\"abcd\\\", \\\"abcde\\\", \\\"a\\\", \\\"bcde\\\", \\\"cde\\\", \\\"de\\\", \\\"e\\\"]) \\n    'abcde'\\n    >>> find_longest_concatenated_word([\\\"cat\\\", \\\"cats\\\", \\\"dog\\\", \\\"catsdog\\\", \\\"catdog\\\"]) \\n    'catsdog'\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"from typing import List\\n\\ndef find_longest_concatenated_word(words: List[str]) -> str:\\n    def can_form(word, words_set):\\n        if word in memo:\\n            return memo[word]\\n        \\n        n = len(word)\\n        for i in range(1, n):\\n            prefix = word[:i]\\n            suffix = word[i:]\\n            if prefix in words_set:\\n                if suffix in words_set or can_form(suffix, words_set):\\n                    memo[word] = True\\n                    return True\\n        \\n        memo[word] = False\\n        return False\\n    \\n    words_set = set(words)\\n    memo = {}\\n    longest = \\\"\\\"\\n    \\n    for word in words:\\n        words_set.remove(word)\\n        if can_form(word, words_set):\\n            if len(word) > len(longest):\\n                longest = word\\n        words_set.add(word)\\n    \\n    return longest\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_find_longest_concatenated_word_example():\\n    words = [\\\"cat\\\", \\\"cats\\\", \\\"catsdogcats\\\", \\\"dog\\\", \\\"dogcatsdog\\\", \\\"hippopotamuses\\\", \\\"rat\\\", \\\"ratcatdogcat\\\"]\\n    assert find_longest_concatenated_word(words) == \\\"ratcatdogcat\\\"\\n\\ndef test_find_longest_concatenated_word_no_concatenated_word():\\n    words = [\\\"cat\\\", \\\"dog\\\", \\\"fish\\\"]\\n    assert find_longest_concatenated_word(words) == \\\"\\\"\\n    \\ndef test_find_longest_concatenated_word_single_word():\\n    words = [\\\"cat\\\"]\\n    assert find_longest_concatenated_word(words) == \\\"\\\"\\n\\ndef test_find_longest_concatenated_word_multiple_same_length():\\n    words = [\\\"a\\\", \\\"b\\\", \\\"ab\\\", \\\"abc\\\", \\\"abcd\\\", \\\"abcde\\\", \\\"a\\\", \\\"bcde\\\", \\\"cde\\\", \\\"de\\\", \\\"e\\\"]\\n    assert find_longest_concatenated_word(words) == \\\"abcde\\\"\\n\\ndef test_find_longest_concatenated_word_with_subwords():\\n    words = [\\\"cat\\\", \\\"cats\\\", \\\"dog\\\", \\\"catsdog\\\", \\\"catdog\\\"]\\n    assert find_longest_concatenated_word(words) == \\\"catsdog\\\"\"}]", "tag": "KodCode"}
{"id": "18b0fea194db23ed8a332461e6a846e08dc42a2a6d43aac469291d8b1e0875db", "source": "KodCode", "difficulty": "0.3", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Design a Python function that calculates the aggregate product of the sums of all possible subarrays within a specified list, as elucidated in this Python code snippet. This function should leverage dynamic programming principles for efficient computation. Additionally, the function should include a mechanism to cache intermediate results for optimization, ensuring that the function can handle large lists without significant performance degradation.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef aggregate_product_of_sums(arr):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Design a Python function that calculates the aggregate product of the sums of all possible subarrays within a specified list, as elucidated in this Python code snippet. This function should leverage dynamic programming principles for efficient computation. Additionally, the function should include a mechanism to cache intermediate results for optimization, ensuring that the function can handle large lists without significant performance degradation.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef aggregate_product_of_sums(arr):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def aggregate_product_of_sums(arr):\\n    \\\"\\\"\\\"\\n    Calculates the aggregate product of the sums of all possible subarrays within the list `arr`.\\n    \\\"\\\"\\\"\\n    n = len(arr)\\n    prefix_sum = [0] * (n + 1)\\n    \\n    # Calculate prefix sums\\n    for i in range(n):\\n        prefix_sum[i + 1] = prefix_sum[i] + arr[i]\\n\\n    aggregate_product = 1\\n\\n    # Calculate the product of sums of all possible subarrays\\n    for start in range(n):\\n        for end in range(start + 1, n + 1):\\n            subarray_sum = prefix_sum[end] - prefix_sum[start]\\n            aggregate_product *= subarray_sum\\n    \\n    return aggregate_product\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_single_element():\\n    assert aggregate_product_of_sums([5]) == 5\\n\\ndef test_two_elements():\\n    assert aggregate_product_of_sums([1, 2]) == (1 * 2 * 3)  # Subarrays: [1], [2], [1, 2]\\n\\ndef test_three_elements():\\n    # Subarrays: [1], [2], [3], [1, 2], [2, 3], [1, 2, 3]\\n    # Sums: 1, 2, 3, 3, 5, 6 -> Product: 1 * 2 * 3 * 3 * 5 * 6\\n    assert aggregate_product_of_sums([1, 2, 3]) == 1 * 2 * 3 * 3 * 5 * 6\\n\\ndef test_all_same_elements():\\n    # For [2, 2], Subarrays: [2], [2], [2, 2] -> Sums: 2, 2, 4 -> Product: 2 * 2 * 4\\n    assert aggregate_product_of_sums([2, 2]) == 2 * 2 * 4\\n\\ndef test_negative_elements():\\n    # Subarrays: [-1], [2], [3], [-1, 2], [2, 3], [-1, 2, 3]\\n    # Sums: -1, 2, 3, 1, 5, 4 -> Product: -1 * 2 * 3 * 1 * 5 * 4\\n    assert aggregate_product_of_sums([-1, 2, 3]) == -1 * 2 * 3 * 1 * 5 * 4\\n\\ndef test_empty_list():\\n    assert aggregate_product_of_sums([]) == 1  # No subarrays, so the product is the neutral element for multiplication\"}]", "tag": "KodCode"}
{"id": "9fa3ca81e265f52960b3db216e1b6fc597fce9f20b2a3e9a496d9c208119cb83", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: How can I create a Python script that reads a CSV file, processes the data to calculate the mean of a specific column, and then writes the result to a new CSV file? The CSV file has a header row and the column of interest is labeled 'Price'.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\n\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: How can I create a Python script that reads a CSV file, processes the data to calculate the mean of a specific column, and then writes the result to a new CSV file? The CSV file has a header row and the column of interest is labeled 'Price'.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\n\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"import csv\\nfrom statistics import mean\\n\\ndef calculate_mean_price(input_csv_path, output_csv_path):\\n    \\\"\\\"\\\"\\n    Reads a CSV file, calculates the mean of the 'Price' column, and writes the result to a new CSV file.\\n    \\n    Parameters:\\n    - input_csv_path: Path to the input CSV file.\\n    - output_csv_path: Path to the output CSV file.\\n    \\\"\\\"\\\"\\n    try:\\n        with open(input_csv_path, mode='r') as infile:\\n            reader = csv.DictReader(infile)\\n            prices = [float(row['Price']) for row in reader]\\n        \\n        mean_price = mean(prices)\\n        \\n        with open(output_csv_path, mode='w', newline='') as outfile:\\n            fieldnames = ['Mean Price']\\n            writer = csv.DictWriter(outfile, fieldnames=fieldnames)\\n            writer.writeheader()\\n            writer.writerow({'Mean Price': mean_price})\\n        \\n    except Exception as e:\\n        print(f\\\"An error occurred: {e}\\\")\\n\\n# Example usage\\n# calculate_mean_price('input.csv', 'output.csv')\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\nimport os\\nimport csv\\n\\ndef test_calculate_mean_price(tmp_path):\\n    # Create a temporary CSV file\\n    input_csv_path = tmp_path / \\\"input.csv\\\"\\n    output_csv_path = tmp_path / \\\"output.csv\\\"\\n    \\n    with open(input_csv_path, mode='w', newline='') as file:\\n        writer = csv.DictWriter(file, fieldnames=['Price'])\\n        writer.writeheader()\\n        writer.writerows([{'Price': 10.0}, {'Price': 20.0}, {'Price': 30.0}])\\n    \\n    # Call the function\\n    calculate_mean_price(input_csv_path, output_csv_path)\\n    \\n    # Verify the output CSV file\\n    assert output_csv_path.exists()\\n    \\n    with open(output_csv_path, 'r') as file:\\n        reader = csv.DictReader(file)\\n        rows = list(reader)\\n        \\n    assert len(rows) == 1\\n    assert rows[0]['Mean Price'] == '20.0'  # Mean of [10.0, 20.0, 30.0] is 20.0\\n\\ndef test_calculate_mean_price_empty_file(tmp_path):\\n    # Create an empty CSV file with header only\\n    input_csv_path = tmp_path / \\\"empty_input.csv\\\"\\n    output_csv_path = tmp_path / \\\"output.csv\\\"\\n    \\n    with open(input_csv_path, mode='w', newline='') as file:\\n        writer = csv.DictWriter(file, fieldnames=['Price'])\\n        writer.writeheader()\\n    \\n    # Call the function\\n    calculate_mean_price(input_csv_path, output_csv_path)\\n    \\n    # Verify the output CSV file should not be created since there's no data\\n    assert not output_csv_path.exists()\\n\\ndef test_calculate_mean_price_incorrect_file(tmp_path):\\n    # Create a CSV file with no 'Price' column\\n    input_csv_path = tmp_path / \\\"incorrect_input.csv\\\"\\n    output_csv_path = tmp_path / \\\"output.csv\\\"\\n    \\n    with open(input_csv_path, mode='w', newline='') as file:\\n        writer = csv.DictWriter(file, fieldnames=['NotPrice'])\\n        writer.writeheader()\\n        writer.writerows([{'NotPrice': 10.0}, {'NotPrice': 20.0}, {'NotPrice': 30.0}])\\n    \\n    # Call the function and catch the exception\\n    try:\\n        calculate_mean_price(input_csv_path, output_csv_path)\\n    except KeyError as e:\\n        assert str(e) == \\\"'Price'\\\"\"}]", "tag": "KodCode"}
{"id": "460077d263ea56dd2082fac8384921a211405c6d1a770e3f8781e7415ec29cac", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Alex is a software engineer who is working with nested comments in a text file. These nested comments follow a specific structure: a comment starts with `/*` and ends with `*/`. Comments can be nested arbitrarily deep, but Alex needs to determine whether the comment structure of a given file is correctly nested, and if so, the maximum depth of nesting.\n\nFor example, in the text `\"/* /* nested */ end */\"`, the maximum depth of nesting is `2`. In the text `\"/* /* nested /* deeper */ still nested */ end */\"`, the maximum depth is `3`. If the text contains mismatched or unclosed comment delimiters, it is considered invalid.\n\nWrite a function that, given a string representing the contents of the file, determines if the nesting is valid and if so, returns the maximum depth of nested comments. If the nesting is invalid, the function should return `-1`.\n\nThe input string may be up to `10^6` characters long.\n\n**Input:**\n- A single string `s` represents the contents of the file.\n\n**Output:**\n- Return the integer representing the maximum depth of nesting if the comment structure is valid, otherwise return `-1`.\n\n**Examples:**\n\n1. Input: `\"/* /* nested */ end */\"`\n   Output: `2`\n\n2. Input: `\"/* /* nested /* deeper */ still nested */ end */\"`\n   Output: `3`\n\n3. Input: `\"/* unclosed comment /* nested */\"`\n   Output: `-1`\n\n4. Input: `\"no comment in this text\"`\n   Output: `0`\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef max_nesting_depth(s):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Alex is a software engineer who is working with nested comments in a text file. These nested comments follow a specific structure: a comment starts with `/*` and ends with `*/`. Comments can be nested arbitrarily deep, but Alex needs to determine whether the comment structure of a given file is correctly nested, and if so, the maximum depth of nesting.\\n\\nFor example, in the text `\\\"/* /* nested */ end */\\\"`, the maximum depth of nesting is `2`. In the text `\\\"/* /* nested /* deeper */ still nested */ end */\\\"`, the maximum depth is `3`. If the text contains mismatched or unclosed comment delimiters, it is considered invalid.\\n\\nWrite a function that, given a string representing the contents of the file, determines if the nesting is valid and if so, returns the maximum depth of nested comments. If the nesting is invalid, the function should return `-1`.\\n\\nThe input string may be up to `10^6` characters long.\\n\\n**Input:**\\n- A single string `s` represents the contents of the file.\\n\\n**Output:**\\n- Return the integer representing the maximum depth of nesting if the comment structure is valid, otherwise return `-1`.\\n\\n**Examples:**\\n\\n1. Input: `\\\"/* /* nested */ end */\\\"`\\n   Output: `2`\\n\\n2. Input: `\\\"/* /* nested /* deeper */ still nested */ end */\\\"`\\n   Output: `3`\\n\\n3. Input: `\\\"/* unclosed comment /* nested */\\\"`\\n   Output: `-1`\\n\\n4. Input: `\\\"no comment in this text\\\"`\\n   Output: `0`\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef max_nesting_depth(s):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def max_nesting_depth(s):\\n    \\\"\\\"\\\"\\n    Determines if the comment structure is valid and if so, returns the maximum depth of nested comments.\\n    If the nesting is invalid, returns -1.\\n\\n    :param s: A string representing the contents of the file.\\n    :return: The maximum depth of nested comments or -1 if the nesting is invalid.\\n    \\\"\\\"\\\"\\n    max_depth = 0\\n    current_depth = 0\\n    i = 0\\n    n = len(s)\\n\\n    while i < n:\\n        if s[i:i+2] == \\\"/*\\\":\\n            current_depth += 1\\n            max_depth = max(max_depth, current_depth)\\n            i += 2\\n        elif s[i:i+2] == \\\"*/\\\":\\n            if current_depth == 0:\\n                return -1\\n            current_depth -= 1\\n            i += 2\\n        else:\\n            i += 1\\n\\n    return max_depth if current_depth == 0 else -1\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\ndef test_max_nesting_depth():\\n    # Test case 1: given example with maximum depth 2\\n    assert max_nesting_depth(\\\"/* /* nested */ end */\\\") == 2\\n    \\n    # Test case 2: given example with maximum depth 3\\n    assert max_nesting_depth(\\\"/* /* nested /* deeper */ still nested */ end */\\\") == 3\\n    \\n    # Test case 3: unclosed comment\\n    assert max_nesting_depth(\\\"/* unclosed comment /* nested */\\\") == -1\\n    \\n    # Test case 4: no comment at all\\n    assert max_nesting_depth(\\\"no comment in this text\\\") == 0\\n    \\n    # Test case 5: overlapping comments which should be invalid\\n    assert max_nesting_depth(\\\"/* /* nested */ end */ */\\\") == -1\\n    \\n    # Test case 6: correctly nested comments with higher depth\\n    assert max_nesting_depth(\\\"/* /* /* nested deeper */ nested */ end */\\\") == 3\\n    \\n    # Test case 7: no opening comment delimiter but closing exists\\n    assert max_nesting_depth(\\\"this is not a comment */\\\") == -1\\n    \\n    # Test case 8: valid comments all closed\\n    assert max_nesting_depth(\\\"text /* comment 1 /* nested comment */ */ more text\\\") == 2\\n    \\n    # Test case 9: nested comments not ending close properly\\n    assert max_nesting_depth(\\\"/* /* nested /* deeper */ still nested */\\\") == -1\\n    \\n    # Test case 10: consecutive comments without nesting\\n    assert max_nesting_depth(\\\"/* first comment */ text /* second comment */\\\") == 1\"}]", "tag": "KodCode"}
{"id": "68da399b50bf17456948bf83b8ebd25c5d55c4fab93ef0ea802e3c9c519db0a0", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: ### Problem Statement\n\nYou are given a list of integers representing the height of several buildings aligned in a row. Each building is of the same width, and the array represents the heights from left (index 0) to right (index n-1). Your task is to determine the maximum amount of water that can be trapped between these buildings after a rain.\n\nThe amount of water trapped between two buildings is determined by the shorter building of the two. For example, if the heights of the buildings are `[4, 0, 3]`, then the amount of water that can be trapped between the first and last building (index 0 and index 2) is `3` units.\n\nWrite a function to compute the maximum amount of trapped water.\n\n### Constraints\n- 1 ≤ n ≤ 10^5\n- 0 ≤ height[i] ≤ 10^4\n\n### Input\n\nThe input is given from Standard Input in the following format:\n\n```\nn\nheight_1 height_2 ... height_n\n```\n\n### Output\n\nThe output should be a single integer representing the maximum amount of trapped water.\n\n### Examples\n\n#### Example 1\n\nInput:\n```\n6\n0 1 0 2 1 0 1 3 2 1 2 1\n```\n\nOutput:\n```\n6\n```\n\nExplanation: \n\nThe maximum amount of trapped water is `6` units between the heights at index 1 (height 1), index 3 (height 2), and index 7 (height 3).\n\n#### Example 2\n\nInput:\n```\n4\n4 2 0 3\n```\n\nOutput:\n```\n4\n```\n\nExplanation:\n\nThe maximum amount of trapped water is `4` units between the heights at index 0 (height 4) and index 3 (height 3).\n\n### Function Signature\n\n```python\ndef max_trapped_water(height: List[int]) -> int:\n    pass\n```\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef max_trapped_water(height: List[int]) -> int:\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: ### Problem Statement\\n\\nYou are given a list of integers representing the height of several buildings aligned in a row. Each building is of the same width, and the array represents the heights from left (index 0) to right (index n-1). Your task is to determine the maximum amount of water that can be trapped between these buildings after a rain.\\n\\nThe amount of water trapped between two buildings is determined by the shorter building of the two. For example, if the heights of the buildings are `[4, 0, 3]`, then the amount of water that can be trapped between the first and last building (index 0 and index 2) is `3` units.\\n\\nWrite a function to compute the maximum amount of trapped water.\\n\\n### Constraints\\n- 1 ≤ n ≤ 10^5\\n- 0 ≤ height[i] ≤ 10^4\\n\\n### Input\\n\\nThe input is given from Standard Input in the following format:\\n\\n```\\nn\\nheight_1 height_2 ... height_n\\n```\\n\\n### Output\\n\\nThe output should be a single integer representing the maximum amount of trapped water.\\n\\n### Examples\\n\\n#### Example 1\\n\\nInput:\\n```\\n6\\n0 1 0 2 1 0 1 3 2 1 2 1\\n```\\n\\nOutput:\\n```\\n6\\n```\\n\\nExplanation: \\n\\nThe maximum amount of trapped water is `6` units between the heights at index 1 (height 1), index 3 (height 2), and index 7 (height 3).\\n\\n#### Example 2\\n\\nInput:\\n```\\n4\\n4 2 0 3\\n```\\n\\nOutput:\\n```\\n4\\n```\\n\\nExplanation:\\n\\nThe maximum amount of trapped water is `4` units between the heights at index 0 (height 4) and index 3 (height 3).\\n\\n### Function Signature\\n\\n```python\\ndef max_trapped_water(height: List[int]) -> int:\\n    pass\\n```\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef max_trapped_water(height: List[int]) -> int:\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"from typing import List\\n\\ndef max_trapped_water(height: List[int]) -> int:\\n    if not height or len(height) < 3:\\n        return 0\\n\\n    left, right = 0, len(height) - 1\\n    left_max, right_max = height[left], height[right]\\n    max_water = 0\\n\\n    while left < right:\\n        if height[left] < height[right]:\\n            left += 1\\n            left_max = max(left_max, height[left])\\n            max_water += max(0, left_max - height[left])\\n        else:\\n            right -= 1\\n            right_max = max(right_max, height[right])\\n            max_water += max(0, right_max - height[right])\\n\\n    return max_water\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_example1():\\n    assert max_trapped_water([0, 1, 0, 2, 1, 0, 1, 3, 2, 1, 2, 1]) == 6\\n\\ndef test_example2():\\n    assert max_trapped_water([4, 2, 0, 3]) == 4\\n\\ndef test_no_height():\\n    assert max_trapped_water([]) == 0\\n\\ndef test_single_building():\\n    assert max_trapped_water([5]) == 0\\n\\ndef test_two_buildings():\\n    assert max_trapped_water([1, 2]) == 0\\n\\ndef test_decreasing_slope():\\n    assert max_trapped_water([5, 4, 3, 2, 1]) == 0\\n\\ndef test_increasing_slope():\\n    assert max_trapped_water([1, 2, 3, 4, 5]) == 0\\n\\ndef test_valleys():\\n    assert max_trapped_water([0, 2, 0, 2, 0, 2]) == 4\\n\\ndef test_flat():\\n    assert max_trapped_water([3, 3, 3, 3]) == 0\\n\\ndef test_mixed_height():\\n    assert max_trapped_water([2, 0, 2, 0, 2, 0, 2]) == 6\"}]", "tag": "KodCode"}
{"id": "0e3aa9b30f772d1ddf3e45694c5a791b4032193ff29a62f9612c6fb7e55a3ff1", "source": "KodCode", "difficulty": "0.333", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\nimport doctest\nimport unittest\n\ndef add(a, b):\n    \"\"\"\n    Returns the sum of `a` and `b`.\n\n    >>> add(2, 3)\n    5\n    >>> add(-1, 1)\n    0\n    >>> add(1.5, 2.5)\n    4.0\n    \"\"\"\n    # Your implementation here\n\ndef subtract(a, b):\n    \"\"\"\n    Returns the difference of `a` and `b`.\n\n    >>> subtract(5, 3)\n    2\n    >>> subtract(2, 5)\n    -3\n    >>> subtract(5.5, 2.0)\n    3.5\n    \"\"\"\n    # Your implementation here\n\ndef multiply(a, b):\n    \"\"\"\n    Returns the product of `a` and `b`.\n\n    >>> multiply(3, 4)\n    12\n    >>> multiply(-2, 3)\n    -6\n    >>> multiply(2.5, 2)\n    5.0\n    \"\"\"\n    # Your implementation here\n\ndef divide(a, b):\n    \"\"\"\n    Returns the division of `a` by `b`. Raises ValueError if `b` is zero.\n\n    >>> divide(6, 3)\n    2.0\n    >>> divide(5, 2)\n    2.5\n    >>> divide(1, 0)\n    Traceback (most recent call last):\n        ...\n    ValueError: division by zero\n    \"\"\"\n    # Your implementation here\n\nclass TrailingNewlineOutputChecker(doctest.OutputChecker):\n    def check_output(self, want, got, optionflags):\n        if want.rstrip() == got.rstrip():\n            return True\n        return super().check_output(want, got, optionflags)\n\ndef load_tests(loader, tests, ignore):\n    tests.addTests(doctest.DocTestSuite(checker=TrailingNewlineOutputChecker()))\n    return tests\n\nif __name__ == \"__main__\":\n    import sys\n    if len(sys.argv) > 1 and sys.argv[1] == 'unittest':\n        unittest.main()\n    else:\n        doctest.testmod(optionflags=doctest.REPORT_ONLY_FIRST_FAILURE)", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\nimport doctest\\nimport unittest\\n\\ndef add(a, b):\\n    \\\"\\\"\\\"\\n    Returns the sum of `a` and `b`.\\n\\n    >>> add(2, 3)\\n    5\\n    >>> add(-1, 1)\\n    0\\n    >>> add(1.5, 2.5)\\n    4.0\\n    \\\"\\\"\\\"\\n    # Your implementation here\\n\\ndef subtract(a, b):\\n    \\\"\\\"\\\"\\n    Returns the difference of `a` and `b`.\\n\\n    >>> subtract(5, 3)\\n    2\\n    >>> subtract(2, 5)\\n    -3\\n    >>> subtract(5.5, 2.0)\\n    3.5\\n    \\\"\\\"\\\"\\n    # Your implementation here\\n\\ndef multiply(a, b):\\n    \\\"\\\"\\\"\\n    Returns the product of `a` and `b`.\\n\\n    >>> multiply(3, 4)\\n    12\\n    >>> multiply(-2, 3)\\n    -6\\n    >>> multiply(2.5, 2)\\n    5.0\\n    \\\"\\\"\\\"\\n    # Your implementation here\\n\\ndef divide(a, b):\\n    \\\"\\\"\\\"\\n    Returns the division of `a` by `b`. Raises ValueError if `b` is zero.\\n\\n    >>> divide(6, 3)\\n    2.0\\n    >>> divide(5, 2)\\n    2.5\\n    >>> divide(1, 0)\\n    Traceback (most recent call last):\\n        ...\\n    ValueError: division by zero\\n    \\\"\\\"\\\"\\n    # Your implementation here\\n\\nclass TrailingNewlineOutputChecker(doctest.OutputChecker):\\n    def check_output(self, want, got, optionflags):\\n        if want.rstrip() == got.rstrip():\\n            return True\\n        return super().check_output(want, got, optionflags)\\n\\ndef load_tests(loader, tests, ignore):\\n    tests.addTests(doctest.DocTestSuite(checker=TrailingNewlineOutputChecker()))\\n    return tests\\n\\nif __name__ == \\\"__main__\\\":\\n    import sys\\n    if len(sys.argv) > 1 and sys.argv[1] == 'unittest':\\n        unittest.main()\\n    else:\\n        doctest.testmod(optionflags=doctest.REPORT_ONLY_FIRST_FAILURE)\"}]", "ground_truth": "[\"import doctest\\nimport unittest\\n\\ndef add(a, b):\\n    \\\"\\\"\\\"\\n    Returns the sum of `a` and `b`.\\n\\n    >>> add(2, 3)\\n    5\\n    >>> add(-1, 1)\\n    0\\n    >>> add(1.5, 2.5)\\n    4.0\\n    \\\"\\\"\\\"\\n    return a + b\\n\\ndef subtract(a, b):\\n    \\\"\\\"\\\"\\n    Returns the difference of `a` and `b`.\\n\\n    >>> subtract(5, 3)\\n    2\\n    >>> subtract(2, 5)\\n    -3\\n    >>> subtract(5.5, 2.0)\\n    3.5\\n    \\\"\\\"\\\"\\n    return a - b\\n\\ndef multiply(a, b):\\n    \\\"\\\"\\\"\\n    Returns the product of `a` and `b`.\\n\\n    >>> multiply(3, 4)\\n    12\\n    >>> multiply(-2, 3)\\n    -6\\n    >>> multiply(2.5, 2)\\n    5.0\\n    \\\"\\\"\\\"\\n    return a * b\\n\\ndef divide(a, b):\\n    \\\"\\\"\\\"\\n    Returns the division of `a` by `b`. Raises ValueError if `b` is zero.\\n\\n    >>> divide(6, 3)\\n    2.0\\n    >>> divide(5, 2)\\n    2.5\\n    >>> divide(1, 0)\\n    Traceback (most recent call last):\\n        ...\\n    ValueError: division by zero\\n    \\\"\\\"\\\"\\n    if b == 0:\\n        raise ValueError(\\\"division by zero\\\")\\n    return a / b\\n\\nclass TrailingNewlineOutputChecker(doctest.OutputChecker):\\n    def check_output(self, want, got, optionflags):\\n        if want.rstrip() == got.rstrip():\\n            return True\\n        return super().check_output(want, got, optionflags)\\n\\ndef load_tests(loader, tests, ignore):\\n    tests.addTests(doctest.DocTestSuite(checker=TrailingNewlineOutputChecker()))\\n    return tests\\n\\nif __name__ == \\\"__main__\\\":\\n    import sys\\n    if len(sys.argv) > 1 and sys.argv[1] == 'unittest':\\n        unittest.main()\\n    else:\\n        doctest.testmod(optionflags=doctest.REPORT_ONLY_FIRST_FAILURE)\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_add():\\n    assert add(2, 3) == 5\\n    assert add(-1, 1) == 0\\n    assert add(1.5, 2.5) == 4.0\\n\\ndef test_subtract():\\n    assert subtract(5, 3) == 2\\n    assert subtract(2, 5) == -3\\n    assert subtract(5.5, 2.0) == 3.5\\n\\ndef test_multiply():\\n    assert multiply(3, 4) == 12\\n    assert multiply(-2, 3) == -6\\n    assert multiply(2.5, 2) == 5.0\\n\\ndef test_divide():\\n    assert divide(6, 3) == 2.0\\n    assert divide(5, 2) == 2.5\\n    \\n    try:\\n        divide(1, 0)\\n    except ValueError as ve:\\n        assert str(ve) == \\\"division by zero\\\"\"}]", "tag": "KodCode"}
{"id": "94d4fa1b385edb9809ffe7945b777f0b3e6d680749ae0d7d1c1a3a6345f60ef2", "source": "KodCode", "difficulty": "0.4", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: You are required to implement a function named `max_subarray_product` that takes an array of integers as input and returns the maximum product of any contiguous subarray. Your solution should efficiently handle both positive and negative numbers.\n\n**Function Signature:**\n```python\ndef max_subarray_product(nums: list[int]) -> int:\n    # Your code here\n```\n\n**Requirements:**\n1. Implement the function without using any built-in Python functions that directly solve the problem.\n2. Aim for a solution with a time complexity of O(n).\n3. Handle edge cases such as arrays with all negative numbers, single-element arrays, and arrays that include zero.\n\n**Example:**\n```python\ninput_array = [2, 3, -2, 4]\noutput = max_subarray_product(input_array) \n# Expected output: 6\n\ninput_array = [-2, 0, -1]\noutput = max_subarray_product(input_array) \n# Expected output: 0\n\ninput_array = [-1, -3, -10, 0, 60]\noutput = max_subarray_product(input_array) \n# Expected output: 60\n```\n\n**Important Notes:**\n- Consider both the maximum and the minimum products at each step since a negative number can turn a small positive product into a large product.\n- You do not need to handle input validation beyond the constraints.\n- Ensure that your solution is well-tested against various edge cases.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef max_subarray_product(nums: list[int]) -> int:\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: You are required to implement a function named `max_subarray_product` that takes an array of integers as input and returns the maximum product of any contiguous subarray. Your solution should efficiently handle both positive and negative numbers.\\n\\n**Function Signature:**\\n```python\\ndef max_subarray_product(nums: list[int]) -> int:\\n    # Your code here\\n```\\n\\n**Requirements:**\\n1. Implement the function without using any built-in Python functions that directly solve the problem.\\n2. Aim for a solution with a time complexity of O(n).\\n3. Handle edge cases such as arrays with all negative numbers, single-element arrays, and arrays that include zero.\\n\\n**Example:**\\n```python\\ninput_array = [2, 3, -2, 4]\\noutput = max_subarray_product(input_array) \\n# Expected output: 6\\n\\ninput_array = [-2, 0, -1]\\noutput = max_subarray_product(input_array) \\n# Expected output: 0\\n\\ninput_array = [-1, -3, -10, 0, 60]\\noutput = max_subarray_product(input_array) \\n# Expected output: 60\\n```\\n\\n**Important Notes:**\\n- Consider both the maximum and the minimum products at each step since a negative number can turn a small positive product into a large product.\\n- You do not need to handle input validation beyond the constraints.\\n- Ensure that your solution is well-tested against various edge cases.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef max_subarray_product(nums: list[int]) -> int:\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def max_subarray_product(nums: list[int]) -> int:\\n    if not nums:\\n        return 0\\n    \\n    max_prod = min_prod = max_result = nums[0]\\n    \\n    for num in nums[1:]:\\n        if num < 0:\\n            max_prod, min_prod = min_prod, max_prod\\n\\n        max_prod = max(num, max_prod * num)\\n        min_prod = min(num, min_prod * num)\\n        max_result = max(max_result, max_prod)\\n\\n    return max_result\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\nimport pytest\\n\\ndef test_max_subarray_product_positive_numbers():\\n    assert max_subarray_product([2, 3, -2, 4]) == 6\\n\\ndef test_max_subarray_product_negative_and_zero():\\n    assert max_subarray_product([-2, 0, -1]) == 0\\n\\ndef test_max_subarray_product_all_negative_numbers():\\n    assert max_subarray_product([-1, -3, -10, 0, 60]) == 60\\n\\ndef test_max_subarray_product_single_element():\\n    assert max_subarray_product([5]) == 5\\n    assert max_subarray_product([-5]) == -5\\n\\ndef test_max_subarray_product_mixed_numbers():\\n    assert max_subarray_product([2, -5, -2, -4, 3]) == 24\\n\\ndef test_max_subarray_product_with_zeros():\\n    assert max_subarray_product([0, 2]) == 2\\n    assert max_subarray_product([0, -2, -3, 0, 4, 0]) == 6\\n\\ndef test_max_subarray_product_empty_list():\\n    assert max_subarray_product([]) == 0\\n\\nif __name__ == \\\"__main__\\\":\\n    pytest.main()\"}]", "tag": "KodCode"}
{"id": "b14dfc7c11d51ab585b4bfe4fba9ead7bc9614a47afdca8d5d6135453678f16b", "source": "KodCode", "difficulty": "0.3", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: ### Advanced Coding Assessment Question: Multiprocessing in Python\n\n#### Objective\nDesign a python program that utilizes the multiprocessing package to process and analyze a large dataset concurrently, demonstrating comprehension of creating processes, using queues for inter-process communication, and applying synchronization mechanisms.\n\n#### Problem Statement\nYou are given an extremely large list of numbers, and your task is to calculate the sum of squares of all even numbers and the sum of cubes of all odd numbers. Given the size of the list, a single-threaded approach is inefficient. Instead, you should leverage the multiprocessing module to parallelize the task.\n\n#### Requirements\n1. Create a function `compute_sums` that will:\n   - Spawn `n` worker processes to process chunks of the list concurrently.\n   - Use a `Queue` to manage tasks and to collect results from worker processes.\n   - Use a `Lock` to ensure the proper printing of results from multiple processes.\n\n2. Create a function `worker` that will:\n   - Fetch a chunk of numbers from the input queue.\n   - Compute the sum of squares for even numbers and the sum of cubes for odd numbers within the chunk.\n   - Place the results back in the output queue.\n\n3. Implement a `main` function to:\n   - Divide the list into `n` chunks.\n   - Create and start the worker processes.\n   - Collect and combine results from all worker processes.\n   - Print the final results in a thread-safe manner.\n\n#### Input\n- `numbers` (list of int): The large list of numbers to be processed.\n- `n` (int): Number of worker processes.\n\n#### Output\n- Print the combined result of the sum of squares of all even numbers and the sum of cubes of all odd numbers.\n\n#### Function Signature\n```python\ndef compute_sums(numbers: list, n: int) -> None:\n    pass\n```\n\n### Sample Usage\n```python\nif __name__ == '__main__':\n    numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] * 1000  # example large list\n    n = 4  # number of worker processes\n    compute_sums(numbers, n)\n```\n\n#### Constraints\n- The solution must demonstrate the use of `multiprocessing.Process`, `Queue`, and `Lock`.\n- Efficiently handle the given large dataset to prevent memory overflow and to ensure each process works independently on its subset of data.\n- Ensure thread-safe operations while printing the results.\n\n#### Notes\n- You may need to use splitting functions to divide the list into balanced chunks.\n- Make use of the `if __name__ == '__main__'` guard to ensure proper execution when using multiprocessing on Windows.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\np = multiprocessing.Process(target=worker, args=(input_queue, output_queue, lock))\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: ### Advanced Coding Assessment Question: Multiprocessing in Python\\n\\n#### Objective\\nDesign a python program that utilizes the multiprocessing package to process and analyze a large dataset concurrently, demonstrating comprehension of creating processes, using queues for inter-process communication, and applying synchronization mechanisms.\\n\\n#### Problem Statement\\nYou are given an extremely large list of numbers, and your task is to calculate the sum of squares of all even numbers and the sum of cubes of all odd numbers. Given the size of the list, a single-threaded approach is inefficient. Instead, you should leverage the multiprocessing module to parallelize the task.\\n\\n#### Requirements\\n1. Create a function `compute_sums` that will:\\n   - Spawn `n` worker processes to process chunks of the list concurrently.\\n   - Use a `Queue` to manage tasks and to collect results from worker processes.\\n   - Use a `Lock` to ensure the proper printing of results from multiple processes.\\n\\n2. Create a function `worker` that will:\\n   - Fetch a chunk of numbers from the input queue.\\n   - Compute the sum of squares for even numbers and the sum of cubes for odd numbers within the chunk.\\n   - Place the results back in the output queue.\\n\\n3. Implement a `main` function to:\\n   - Divide the list into `n` chunks.\\n   - Create and start the worker processes.\\n   - Collect and combine results from all worker processes.\\n   - Print the final results in a thread-safe manner.\\n\\n#### Input\\n- `numbers` (list of int): The large list of numbers to be processed.\\n- `n` (int): Number of worker processes.\\n\\n#### Output\\n- Print the combined result of the sum of squares of all even numbers and the sum of cubes of all odd numbers.\\n\\n#### Function Signature\\n```python\\ndef compute_sums(numbers: list, n: int) -> None:\\n    pass\\n```\\n\\n### Sample Usage\\n```python\\nif __name__ == '__main__':\\n    numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] * 1000  # example large list\\n    n = 4  # number of worker processes\\n    compute_sums(numbers, n)\\n```\\n\\n#### Constraints\\n- The solution must demonstrate the use of `multiprocessing.Process`, `Queue`, and `Lock`.\\n- Efficiently handle the given large dataset to prevent memory overflow and to ensure each process works independently on its subset of data.\\n- Ensure thread-safe operations while printing the results.\\n\\n#### Notes\\n- You may need to use splitting functions to divide the list into balanced chunks.\\n- Make use of the `if __name__ == '__main__'` guard to ensure proper execution when using multiprocessing on Windows.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\np = multiprocessing.Process(target=worker, args=(input_queue, output_queue, lock))\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"import multiprocessing\\nfrom multiprocessing import Queue, Lock\\n\\ndef worker(input_queue, output_queue, lock):\\n    while True:\\n        numbers_chunk = input_queue.get()\\n        if numbers_chunk is None:\\n            break\\n        sum_of_squares = sum(x**2 for x in numbers_chunk if x % 2 == 0)\\n        sum_of_cubes = sum(x**3 for x in numbers_chunk if x % 2 != 0)\\n        with lock:\\n            output_queue.put((sum_of_squares, sum_of_cubes))\\n\\ndef compute_sums(numbers, n):\\n    chunk_size = len(numbers) // n\\n    input_queue = Queue()\\n    output_queue = Queue()\\n    lock = Lock()\\n\\n    # Dividing the numbers into chunks\\n    chunks = [numbers[i * chunk_size:(i + 1) * chunk_size] for i in range(n)]\\n    if len(numbers) % n != 0:\\n        chunks.append(numbers[n * chunk_size:])\\n\\n    # Spawning worker processes\\n    processes = []\\n    for _ in range(n):\\n        p = multiprocessing.Process(target=worker, args=(input_queue, output_queue, lock))\\n        p.start()\\n        processes.append(p)\\n\\n    # Putting chunks into the input queue\\n    for chunk in chunks:\\n        input_queue.put(chunk)\\n    \\n    # Adding 'None' to indicate end of tasks\\n    for _ in range(n):\\n        input_queue.put(None)\\n\\n    # Gathering results\\n    total_sum_of_squares = 0\\n    total_sum_of_cubes = 0\\n    for _ in chunks:\\n        sum_of_squares, sum_of_cubes = output_queue.get()\\n        total_sum_of_squares += sum_of_squares\\n        total_sum_of_cubes += sum_of_cubes\\n\\n    # Ensuring all processes have finished\\n    for p in processes:\\n        p.join()\\n\\n    with lock:\\n        print(f\\\"Sum of squares of even numbers: {total_sum_of_squares}\\\")\\n        print(f\\\"Sum of cubes of odd numbers: {total_sum_of_cubes}\\\")\\n\\n# Example usage (uncomment and run in a proper environment)\\n# if __name__ == '__main__':\\n#     numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] * 1000\\n#     n = 4\\n#     compute_sums(numbers, n)\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\nimport multiprocessing\\n\\ndef test_compute_sums_basic():\\n    numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\\n    n = 2\\n    expected_sum_of_squares = sum(x**2 for x in numbers if x % 2 == 0)\\n    expected_sum_of_cubes = sum(x**3 for x in numbers if x % 2 != 0)\\n\\n    compute_sums(numbers, n)\\n\\ndef test_compute_sums_larger_list():\\n    numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] * 100\\n    n = 5\\n    expected_sum_of_squares = sum(x**2 for x in numbers if x % 2 == 0)\\n    expected_sum_of_cubes = sum(x**3 for x in numbers if x % 2 != 0)\\n\\n    compute_sums(numbers, n)\\n\\ndef test_compute_sums_single_process():\\n    numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\\n    n = 1\\n    expected_sum_of_squares = sum(x**2 for x in numbers if x % 2 == 0)\\n    expected_sum_of_cubes = sum(x**3 for x in numbers if x % 2 != 0)\\n\\n    compute_sums(numbers, n)\\n\\ndef test_compute_sums_empty_list():\\n    numbers = []\\n    n = 4\\n    expected_sum_of_squares = 0\\n    expected_sum_of_cubes = 0\\n\\n    compute_sums(numbers, n)\\n\\ndef test_compute_sums_single_element_list():\\n    numbers = [2]\\n    n = 1\\n    expected_sum_of_squares = 4\\n    expected_sum_of_cubes = 0\\n\\n    compute_sums(numbers, n)\\n\\ndef test_compute_sums_odd_single_element_list():\\n    numbers = [3]\\n    n = 1\\n    expected_sum_of_squares = 0\\n    expected_sum_of_cubes = 27\\n\\n    compute_sums(numbers, n)\"}]", "tag": "KodCode"}
{"id": "a04fbec351a08f213da3a107773a05299eee484d43fb66865c7b8d1df30181a4", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: ### Question\n\n#### Problem Statement\nGiven a matrix of `m` x `n` elements (m rows, n columns), write a function `spiral_traversal(matrix)` that returns all elements of the matrix in spiral order.\n\n#### Context\nYou are working on a project involving image processing, and you need a way to traverse a matrix representing pixel values in a specific spiral pattern starting from the top-left corner.\n\n#### Implementation Details\n* Implement the function `spiral_traversal(matrix)` that:\n  - Accepts a 2D list `matrix`.\n  - Returns a list of elements in spiral order starting from the top-left corner.\n  \n#### Example\nGiven the following matrix:\n\n```\n[\n [1, 2, 3],\n [4, 5, 6],\n [7, 8, 9]\n]\n```\n\nYour function should return:\n\n```\n[1, 2, 3, 6, 9, 8, 7, 4, 5]\n```\n\n#### Constraints\n1. The dimensions of the matrix will not exceed 100x100.\n2. The matrix may contain negative and positive integers.\n3. Ensure the function handles the edge cases where the matrix may be empty or have varying row lengths.\n\n#### Edge Cases to Consider\n* `[]`: Empty matrix\n* `[[1]]`: Matrix with a single element\n* `[[1, 2], [3, 4]]`: Matrix with even number of rows and columns\n* `[[1, 2, 3], [4, 5, 6], [7, 8, 9]]`: Non-empty square matrix\n* `[[1], [2], [3]]`: Single column matrix\n* `[[1, 2, 3]]`: Single row matrix\n\n#### Function Signature\n```python\ndef spiral_traversal(matrix):\n    # Your code here\n```\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef spiral_traversal(matrix):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: ### Question\\n\\n#### Problem Statement\\nGiven a matrix of `m` x `n` elements (m rows, n columns), write a function `spiral_traversal(matrix)` that returns all elements of the matrix in spiral order.\\n\\n#### Context\\nYou are working on a project involving image processing, and you need a way to traverse a matrix representing pixel values in a specific spiral pattern starting from the top-left corner.\\n\\n#### Implementation Details\\n* Implement the function `spiral_traversal(matrix)` that:\\n  - Accepts a 2D list `matrix`.\\n  - Returns a list of elements in spiral order starting from the top-left corner.\\n  \\n#### Example\\nGiven the following matrix:\\n\\n```\\n[\\n [1, 2, 3],\\n [4, 5, 6],\\n [7, 8, 9]\\n]\\n```\\n\\nYour function should return:\\n\\n```\\n[1, 2, 3, 6, 9, 8, 7, 4, 5]\\n```\\n\\n#### Constraints\\n1. The dimensions of the matrix will not exceed 100x100.\\n2. The matrix may contain negative and positive integers.\\n3. Ensure the function handles the edge cases where the matrix may be empty or have varying row lengths.\\n\\n#### Edge Cases to Consider\\n* `[]`: Empty matrix\\n* `[[1]]`: Matrix with a single element\\n* `[[1, 2], [3, 4]]`: Matrix with even number of rows and columns\\n* `[[1, 2, 3], [4, 5, 6], [7, 8, 9]]`: Non-empty square matrix\\n* `[[1], [2], [3]]`: Single column matrix\\n* `[[1, 2, 3]]`: Single row matrix\\n\\n#### Function Signature\\n```python\\ndef spiral_traversal(matrix):\\n    # Your code here\\n```\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef spiral_traversal(matrix):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def spiral_traversal(matrix):\\n    \\\"\\\"\\\"\\n    Given an m x n matrix, return all elements of the matrix in spiral order.\\n    \\n    :param matrix: List[List[int]]\\n    :return: List[int]\\n    \\\"\\\"\\\"\\n    # Check for an empty matrix\\n    if not matrix or not matrix[0]:\\n        return []\\n\\n    result = []\\n    m, n = len(matrix), len(matrix[0])  # dimensions of the matrix\\n    top, bottom, left, right = 0, m - 1, 0, n - 1  # boundaries\\n\\n    while top <= bottom and left <= right:\\n        # Traverse from left to right\\n        for col in range(left, right + 1):\\n            result.append(matrix[top][col])\\n        top += 1\\n\\n        # Traverse downwards\\n        for row in range(top, bottom + 1):\\n            result.append(matrix[row][right])\\n        right -= 1\\n\\n        # Make sure we are now on a different row\\n        if top <= bottom:\\n            # Traverse from right to left\\n            for col in range(right, left - 1, -1):\\n                result.append(matrix[bottom][col])\\n            bottom -= 1\\n\\n        # Make sure we are now on a different column\\n        if left <= right:\\n            # Traverse upwards\\n            for row in range(bottom, top - 1, -1):\\n                result.append(matrix[row][left])\\n            left += 1\\n\\n    return result\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_empty_matrix():\\n    assert spiral_traversal([]) == []\\n\\ndef test_single_element_matrix():\\n    assert spiral_traversal([[1]]) == [1]\\n\\ndef test_even_number_matrix():\\n    assert spiral_traversal([[1, 2], [3, 4]]) == [1, 2, 4, 3]\\n\\ndef test_square_matrix():\\n    assert spiral_traversal([[1, 2, 3], [4, 5, 6], [7, 8, 9]]) == [1, 2, 3, 6, 9, 8, 7, 4, 5]\\n\\ndef test_single_column_matrix():\\n    assert spiral_traversal([[1], [2], [3]]) == [1, 2, 3]\\n\\ndef test_single_row_matrix():\\n    assert spiral_traversal([[1, 2, 3]]) == [1, 2, 3]\\n\\ndef test_rectangular_matrix():\\n    assert spiral_traversal([[1, 2, 3], [4, 5, 6]]) == [1, 2, 3, 6, 5, 4]\\n    \\ndef test_large_matrix():\\n    large_matrix = [\\n        [1, 2, 3, 4],\\n        [5, 6, 7, 8],\\n        [9, 10, 11, 12],\\n        [13, 14, 15, 16]\\n    ]\\n    assert spiral_traversal(large_matrix) == [1, 2, 3, 4, 8, 12, 16, 15, 14, 13, 9, 5, 6, 7, 11, 10]\\n\\ndef test_various_size_matrices():\\n    assert spiral_traversal([[1, 2], [3, 4], [5, 6]]) == [1, 2, 4, 6, 5, 3]\\n    assert spiral_traversal([[1, 2, 3], [4, 5, 6], [7, 8, 9], [10, 11, 12]]) == [1, 2, 3, 6, 9, 12, 11, 10, 7, 4, 5, 8]\"}]", "tag": "KodCode"}
{"id": "60ebecb97197264ba7611248de8842372940efee11f6604ec1e85f5a4c521ca1", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Your task is to implement an algorithm to distribute workers evenly based on their proficiency levels for a specific task. Each worker has a certain proficiency score.\n\nWe want to distribute the workers into teams so that the difference in the total proficiency scores of any two teams is minimized.\n\n-----Input-----\n\nThe first line of the input contains an integer $t$ ($1 \\le t \\le 100$) - the number of test cases. The description of each test case follows.\n\nEach test case begins with an integer $n$ ($1 \\le n \\le 2000$) - the number of workers. The next line contains $n$ integers where the $i$-th integer represents the proficiency score of the $i$-th worker ($1 \\le \\text{proficiency}_i \\le 10^5$).\n\nIt's guaranteed that the sum of $n$ over all test cases does not exceed $10000$.\n\n-----Output-----\n\nFor each test case, print a single integer - the minimum possible difference between the total proficiency scores of any two teams.\n\n-----Examples-----\n\nInput\n2\n4\n10 20 15 5\n3\n8 12 5\nOutput\n0\n1\n\n-----Note------\n\n* In the first test case, we can divide the workers into two teams with proficiency scores [10, 15] and [20, 5]. Both teams have a total score of 25, so the difference is 0.\n* In the second test case, we can divide the workers into two teams with proficiency scores [8, 5] and [12]. The teams have total scores of 13 and 12, respectively, making the difference 1.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef min_difference(num_cases, cases):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Your task is to implement an algorithm to distribute workers evenly based on their proficiency levels for a specific task. Each worker has a certain proficiency score.\\n\\nWe want to distribute the workers into teams so that the difference in the total proficiency scores of any two teams is minimized.\\n\\n-----Input-----\\n\\nThe first line of the input contains an integer $t$ ($1 \\\\le t \\\\le 100$) - the number of test cases. The description of each test case follows.\\n\\nEach test case begins with an integer $n$ ($1 \\\\le n \\\\le 2000$) - the number of workers. The next line contains $n$ integers where the $i$-th integer represents the proficiency score of the $i$-th worker ($1 \\\\le \\\\text{proficiency}_i \\\\le 10^5$).\\n\\nIt's guaranteed that the sum of $n$ over all test cases does not exceed $10000$.\\n\\n-----Output-----\\n\\nFor each test case, print a single integer - the minimum possible difference between the total proficiency scores of any two teams.\\n\\n-----Examples-----\\n\\nInput\\n2\\n4\\n10 20 15 5\\n3\\n8 12 5\\nOutput\\n0\\n1\\n\\n-----Note------\\n\\n* In the first test case, we can divide the workers into two teams with proficiency scores [10, 15] and [20, 5]. Both teams have a total score of 25, so the difference is 0.\\n* In the second test case, we can divide the workers into two teams with proficiency scores [8, 5] and [12]. The teams have total scores of 13 and 12, respectively, making the difference 1.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef min_difference(num_cases, cases):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def min_difference(num_cases, cases):\\n    \\\"\\\"\\\"\\n    Distributes workers into teams so that the difference in proficiency scores of the teams is minimized.\\n    \\n    Parameters:\\n    num_cases (int): The number of test cases\\n    cases (List[Tuple[int, List[int]]]): A list of tuples where each tuple contains an integer 'n' and a list of 'n' proficiency scores\\n    \\n    Returns:\\n    List[int]: A list containing the minimum possible difference for each test case\\n    \\\"\\\"\\\"\\n    \\n    def min_subset_sum_diff(proficiencies):\\n        total = sum(proficiencies)\\n        half = total // 2\\n        dp = [0] * (half + 1)\\n        \\n        for prof in proficiencies:\\n            for i in range(half, prof - 1, -1):\\n                dp[i] = max(dp[i], dp[i - prof] + prof)\\n        \\n        return total - 2 * dp[half]\\n    \\n    results = []\\n    for n, proficiencies in cases:\\n        min_diff = min_subset_sum_diff(proficiencies)\\n        results.append(min_diff)\\n    \\n    return results\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_example_cases():\\n    assert min_difference(2, [(4, [10, 20, 15, 5]), (3, [8, 12, 5])]) == [0, 1]\\n\\ndef test_single_worker():\\n    assert min_difference(1, [(1, [100])]) == [100]\\n\\ndef test_all_equal_proficiency():\\n    assert min_difference(1, [(4, [10, 10, 10, 10])]) == [0]\\n\\ndef test_large_difference():\\n    assert min_difference(1, [(2, [1, 100000])]) == [99999]\\n\\ndef test_minimum_workers():\\n    assert min_difference(1, [(2, [1, 2])]) == [1]\\n\\ndef test_proficiencies_sum_to_odd():\\n    assert min_difference(1, [(5, [1, 2, 3, 4, 5])]) == [1]\"}]", "tag": "KodCode"}
{"id": "3005a51caae97bb99fcfa510009d9cd6355410ebbfc098861958b47ddeb00f63", "source": "KodCode", "difficulty": "0.7", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef find_closest_index(arr, x):\n    \"\"\"\n    Returns the index of the element that is closest to the target value x.\n    If there are two elements equally close, return the index of the smaller element.\n\n    >>> find_closest_index([1, 2, 3, 4, 5], 3) == 2\n    >>> find_closest_index([1, 3, 5, 7, 9], 1) == 0\n    >>> find_closest_index([1, 3, 5, 7, 9], 9) == 4\n    >>> find_closest_index([1, 2, 3, 4, 5], 6) == 4\n    >>> find_closest_index([1, 3, 5, 7, 9], 8) == 3\n    >>> find_closest_index([1, 3, 5, 7, 9], 4) == 1\n    >>> find_closest_index([10, 20, 30, 40], 25) == 1\n    >>> find_closest_index([1, 3, 5, 7, 9], 6) == 2\n    >>> find_closest_index([10, 20, 30, 40], 15) == 0\n    >>> find_closest_index([], 5) == -1\n    >>> find_closest_index([5], 5) == 0\n    >>> find_closest_index([10], 5) == 0\n    >>> find_closest_index([10], 15) == 0\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef find_closest_index(arr, x):\\n    \\\"\\\"\\\"\\n    Returns the index of the element that is closest to the target value x.\\n    If there are two elements equally close, return the index of the smaller element.\\n\\n    >>> find_closest_index([1, 2, 3, 4, 5], 3) == 2\\n    >>> find_closest_index([1, 3, 5, 7, 9], 1) == 0\\n    >>> find_closest_index([1, 3, 5, 7, 9], 9) == 4\\n    >>> find_closest_index([1, 2, 3, 4, 5], 6) == 4\\n    >>> find_closest_index([1, 3, 5, 7, 9], 8) == 3\\n    >>> find_closest_index([1, 3, 5, 7, 9], 4) == 1\\n    >>> find_closest_index([10, 20, 30, 40], 25) == 1\\n    >>> find_closest_index([1, 3, 5, 7, 9], 6) == 2\\n    >>> find_closest_index([10, 20, 30, 40], 15) == 0\\n    >>> find_closest_index([], 5) == -1\\n    >>> find_closest_index([5], 5) == 0\\n    >>> find_closest_index([10], 5) == 0\\n    >>> find_closest_index([10], 15) == 0\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def find_closest_index(arr, x):\\n    \\\"\\\"\\\"\\n    Returns the index of the element that is closest to the target value x.\\n    If there are two elements equally close, return the index of the smaller element.\\n    \\\"\\\"\\\"\\n    n = len(arr)\\n    if n == 0:\\n        return -1\\n    \\n    low, high = 0, n - 1\\n    while low <= high:\\n        mid = (low + high) // 2\\n        if arr[mid] == x:\\n            return mid\\n        elif arr[mid] < x:\\n            low = mid + 1\\n        else:\\n            high = mid - 1\\n    \\n    if low >= n: # target is greater than all elements\\n        return high\\n    if high < 0: # target is less than all elements\\n        return low\\n    \\n    if (x - arr[high]) <= (arr[low] - x):\\n        return high\\n    else:\\n        return low\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_target_in_array():\\n    assert find_closest_index([1, 2, 3, 4, 5], 3) == 2\\n    assert find_closest_index([1, 3, 5, 7, 9], 1) == 0\\n    assert find_closest_index([1, 3, 5, 7, 9], 9) == 4\\n\\ndef test_target_not_in_array():\\n    assert find_closest_index([1, 2, 3, 4, 5], 6) == 4\\n    assert find_closest_index([1, 3, 5, 7, 9], 8) == 3\\n    assert find_closest_index([1, 3, 5, 7, 9], 4) == 1\\n\\ndef test_target_closer_to_lower():\\n    assert find_closest_index([1, 3, 5, 7, 9], 4) == 1\\n    assert find_closest_index([10, 20, 30, 40], 25) == 1\\n\\ndef test_target_closer_to_higher():\\n    assert find_closest_index([1, 3, 5, 7, 9], 6) == 2\\n    assert find_closest_index([10, 20, 30, 40], 15) == 0\\n\\ndef test_empty_array():\\n    assert find_closest_index([], 5) == -1\\n\\ndef test_single_element_array():\\n    assert find_closest_index([5], 5) == 0\\n    assert find_closest_index([10], 5) == 0\\n    assert find_closest_index([10], 15) == 0\"}]", "tag": "KodCode"}
{"id": "a517190e4a65c717bd050624078d06900339628a1b58865eae29a808aa6dfb3b", "source": "KodCode", "difficulty": "0.7", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: You are given two strings s and t. Your task is to determine whether string t is a subsequence of string s.\n\nA subsequence of a string is a new string generated from the original string by deleting some (or no) characters without changing the relative order of the remaining characters.\n\nThe first line contains a string s (1 ≤ |s| ≤ 105) — the original string.\n\nThe second line contains a string t (1 ≤ |t| ≤ 105) — the string to check as a subsequence of s.\n\nPrint \"YES\" (without quotes) if t is a subsequence of s, otherwise print \"NO\".\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef is_subsequence(s, t):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: You are given two strings s and t. Your task is to determine whether string t is a subsequence of string s.\\n\\nA subsequence of a string is a new string generated from the original string by deleting some (or no) characters without changing the relative order of the remaining characters.\\n\\nThe first line contains a string s (1 ≤ |s| ≤ 105) — the original string.\\n\\nThe second line contains a string t (1 ≤ |t| ≤ 105) — the string to check as a subsequence of s.\\n\\nPrint \\\"YES\\\" (without quotes) if t is a subsequence of s, otherwise print \\\"NO\\\".\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef is_subsequence(s, t):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def is_subsequence(s, t):\\n    \\\"\\\"\\\"\\n    Determines whether string t is a subsequence of string s.\\n    \\n    :param s: The original string.\\n    :param t: The string to check as a subsequence of s.\\n    :return: \\\"YES\\\" if t is a subsequence of s, otherwise \\\"NO\\\"\\n    \\\"\\\"\\\"\\n    t_index = 0\\n\\n    for char in s:\\n        if t_index < len(t) and char == t[t_index]:\\n            t_index += 1\\n            \\n    return \\\"YES\\\" if t_index == len(t) else \\\"NO\\\"\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_is_subsequence_single_char():\\n    assert is_subsequence(\\\"abc\\\", \\\"a\\\") == \\\"YES\\\"\\n    assert is_subsequence(\\\"abc\\\", \\\"b\\\") == \\\"YES\\\"\\n    assert is_subsequence(\\\"abc\\\", \\\"c\\\") == \\\"YES\\\"\\n    assert is_subsequence(\\\"abc\\\", \\\"d\\\") == \\\"NO\\\"\\n\\ndef test_is_subsequence_multiple_chars():\\n    assert is_subsequence(\\\"abcde\\\", \\\"ace\\\") == \\\"YES\\\"\\n    assert is_subsequence(\\\"abcde\\\", \\\"aec\\\") == \\\"NO\\\"\\n    \\ndef test_is_subsequence_identical_strings():\\n    assert is_subsequence(\\\"abc\\\", \\\"abc\\\") == \\\"YES\\\"\\n    \\ndef test_is_subsequence_empty_t():\\n    assert is_subsequence(\\\"abc\\\", \\\"\\\") == \\\"YES\\\"\\n\\ndef test_is_subsequence_non_subsequence():\\n    assert is_subsequence(\\\"abc\\\", \\\"abcd\\\") == \\\"NO\\\"\\n    assert is_subsequence(\\\"abcdef\\\", \\\"azf\\\") == \\\"NO\\\"\\n\\ndef test_is_subsequence_complex_cases():\\n    assert is_subsequence(\\\"a\\\"*105, \\\"a\\\"*50) == \\\"YES\\\"\\n    assert is_subsequence(\\\"aabbcc\\\", \\\"abc\\\") == \\\"YES\\\"\\n    assert is_subsequence(\\\"a\\\"*100 + \\\"b\\\"*5, \\\"ab\\\") == \\\"YES\\\"\\n    assert is_subsequence(\\\"a\\\"*100 + \\\"b\\\"*5, \\\"ba\\\") == \\\"NO\\\"\"}]", "tag": "KodCode"}
{"id": "4adabe583341ebbf9d466f2e70b182508293000e13fcb33adb7664484105b7c9", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: You are given a matrix of size $n \\times m$ consisting of integers. Your goal is to find the sum of all unique elements in the matrix. An element is considered unique if it appears exactly once in the matrix.\n\nWrite a program that reads the matrix from the input, determines all unique elements, and calculates their sum.\n\n-----Input-----\n\nThe first line contains two integers $n$ and $m$ ($1 \\leq n, m \\leq 100$) — the number of rows and columns in the matrix, respectively.\n\nThe next $n$ lines contain $m$ integers each — the elements of the matrix.\n\n-----Output-----\n\nOutput a single integer — the sum of all unique elements in the matrix. If there are no unique elements, output $0$.\n\n-----Example-----\nInput\n3 3\n1 2 3\n2 1 4\n5 6 1\n\nOutput\n18\n\nExplanation:\n\nIn the given matrix, the elements 3, 4, 5, and 6 appear exactly once. Their sum is 3 + 4 + 5 + 6 = 18.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef sum_of_unique_elements(n, m, matrix):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: You are given a matrix of size $n \\\\times m$ consisting of integers. Your goal is to find the sum of all unique elements in the matrix. An element is considered unique if it appears exactly once in the matrix.\\n\\nWrite a program that reads the matrix from the input, determines all unique elements, and calculates their sum.\\n\\n-----Input-----\\n\\nThe first line contains two integers $n$ and $m$ ($1 \\\\leq n, m \\\\leq 100$) — the number of rows and columns in the matrix, respectively.\\n\\nThe next $n$ lines contain $m$ integers each — the elements of the matrix.\\n\\n-----Output-----\\n\\nOutput a single integer — the sum of all unique elements in the matrix. If there are no unique elements, output $0$.\\n\\n-----Example-----\\nInput\\n3 3\\n1 2 3\\n2 1 4\\n5 6 1\\n\\nOutput\\n18\\n\\nExplanation:\\n\\nIn the given matrix, the elements 3, 4, 5, and 6 appear exactly once. Their sum is 3 + 4 + 5 + 6 = 18.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef sum_of_unique_elements(n, m, matrix):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def sum_of_unique_elements(n, m, matrix):\\n    \\\"\\\"\\\"\\n    Returns the sum of all unique elements in the matrix.\\n    \\\"\\\"\\\"\\n    from collections import Counter\\n    \\n    # Flatten the matrix and create a counter for elements\\n    elements = [item for sublist in matrix for item in sublist]\\n    element_count = Counter(elements)\\n    \\n    # Sum elements that appear exactly once\\n    unique_sum = sum(num for num, count in element_count.items() if count == 1)\\n    \\n    return unique_sum\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_sum_of_unique_elements_example():\\n    matrix = [\\n        [1, 2, 3],\\n        [2, 1, 4],\\n        [5, 6, 1]\\n    ]\\n    assert sum_of_unique_elements(3, 3, matrix) == 18\\n\\ndef test_sum_of_unique_elements_no_unique():\\n    matrix = [\\n        [1, 1],\\n        [1, 1]\\n    ]\\n    assert sum_of_unique_elements(2, 2, matrix) == 0\\n\\ndef test_sum_of_unique_elements_all_unique():\\n    matrix = [\\n        [1, 2],\\n        [3, 4]\\n    ]\\n    assert sum_of_unique_elements(2, 2, matrix) == 10\\n\\ndef test_sum_of_unique_elements_some_unique():\\n    matrix = [\\n        [1, 2, 2],\\n        [3, 4, 1]\\n    ]\\n    assert sum_of_unique_elements(2, 3, matrix) == 7\\n\\ndef test_sum_of_unique_elements_edge_case():\\n    matrix = [\\n        [10]\\n    ]\\n    assert sum_of_unique_elements(1, 1, matrix) == 10\"}]", "tag": "KodCode"}
{"id": "70cc37c1e9e33543de1d61ed6006214034df749b42ed34b6ec645e02095cb166", "source": "KodCode", "difficulty": "0.333", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\nimport random\n\ndef miller_rabin_test(n, k):\n    \"\"\"Check if a number is prime using the Rabin-Miller primality test.\n    \n    Args:\n    n (int): The number to check.\n    k (int): Number of trials to reduce the false positive rate.\n    \n    Returns:\n    bool: True if n is prime, False otherwise.\n    \"\"\"\n    # Implementation for Rabin-Miller test\n    \ndef find_primes_in_range(low, high, k):\n    \"\"\"Find all prime numbers in a given range using Rabin-Miller primality test.\n    \n    Args:\n    low (int): The lower bound of the range.\n    high (int): The upper bound of the range.\n    k (int): The number of trials for the Rabin-Miller test.\n    \n    Returns:\n    List[int]: A list of prime numbers in the given range.\n    \n    >>> find_primes_in_range(10, 50, 10)\n    [11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47]\n    >>> find_primes_in_range(1, 20, 5)\n    [2, 3, 5, 7, 11, 13, 17, 19]\n    >>> find_primes_in_range(100, 200, 15)\n    [101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199]\n    \"\"\"\n    primes = []\n    for num in range(low, high + 1):\n        if miller_rabin_test(num, k):\n            primes.append(num)\n    return primes\n\ndef test_find_primes_in_range_example1():\n    assert find_primes_in_range(10, 50, 10) == [11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47]\n\ndef test_find_primes_in_range_example2():\n    assert find_primes_in_range(1, 20, 5) == [2, 3, 5, 7, 11, 13, 17, 19]\n\ndef test_find_primes_in_range_example3():\n    assert find_primes_in_range(100, 200, 15) == [101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199]\n\ndef test_find_primes_in_range_small_range():\n    assert find_primes_in_range(1, 10, 10) == [2, 3, 5, 7]\n\ndef test_find_primes_in_range_large_single_prime():\n    assert find_primes_in_range(104729, 104729, 20) == [104729]\n\ndef test_find_primes_in_range_no_primes():\n    assert find_primes_in_range(14, 16, 10) == []\n\ndef test_find_primes_in_range_single_non_prime():\n    assert find_primes_in_range(4, 4, 5) == []", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\nimport random\\n\\ndef miller_rabin_test(n, k):\\n    \\\"\\\"\\\"Check if a number is prime using the Rabin-Miller primality test.\\n    \\n    Args:\\n    n (int): The number to check.\\n    k (int): Number of trials to reduce the false positive rate.\\n    \\n    Returns:\\n    bool: True if n is prime, False otherwise.\\n    \\\"\\\"\\\"\\n    # Implementation for Rabin-Miller test\\n    \\ndef find_primes_in_range(low, high, k):\\n    \\\"\\\"\\\"Find all prime numbers in a given range using Rabin-Miller primality test.\\n    \\n    Args:\\n    low (int): The lower bound of the range.\\n    high (int): The upper bound of the range.\\n    k (int): The number of trials for the Rabin-Miller test.\\n    \\n    Returns:\\n    List[int]: A list of prime numbers in the given range.\\n    \\n    >>> find_primes_in_range(10, 50, 10)\\n    [11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47]\\n    >>> find_primes_in_range(1, 20, 5)\\n    [2, 3, 5, 7, 11, 13, 17, 19]\\n    >>> find_primes_in_range(100, 200, 15)\\n    [101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199]\\n    \\\"\\\"\\\"\\n    primes = []\\n    for num in range(low, high + 1):\\n        if miller_rabin_test(num, k):\\n            primes.append(num)\\n    return primes\\n\\ndef test_find_primes_in_range_example1():\\n    assert find_primes_in_range(10, 50, 10) == [11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47]\\n\\ndef test_find_primes_in_range_example2():\\n    assert find_primes_in_range(1, 20, 5) == [2, 3, 5, 7, 11, 13, 17, 19]\\n\\ndef test_find_primes_in_range_example3():\\n    assert find_primes_in_range(100, 200, 15) == [101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199]\\n\\ndef test_find_primes_in_range_small_range():\\n    assert find_primes_in_range(1, 10, 10) == [2, 3, 5, 7]\\n\\ndef test_find_primes_in_range_large_single_prime():\\n    assert find_primes_in_range(104729, 104729, 20) == [104729]\\n\\ndef test_find_primes_in_range_no_primes():\\n    assert find_primes_in_range(14, 16, 10) == []\\n\\ndef test_find_primes_in_range_single_non_prime():\\n    assert find_primes_in_range(4, 4, 5) == []\"}]", "ground_truth": "[\"import random\\n\\ndef miller_rabin_test(n, k):\\n    if n <= 1:\\n        return False\\n    if n <= 3:\\n        return True\\n    if n % 2 == 0:\\n        return False\\n    \\n    def power_mod(b, e, m):\\n        res = 1\\n        b = b % m\\n        while e > 0:\\n            if e % 2 == 1:\\n                res = (res * b) % m\\n            e = e >> 1\\n            b = (b * b) % m\\n        return res\\n    \\n    def is_composite(a, d, n, s):\\n        x = power_mod(a, d, n)\\n        if x == 1 or x == n - 1:\\n            return False\\n        for _ in range(s - 1):\\n            x = (x * x) % n\\n            if x == n - 1:\\n                return False\\n        return True\\n\\n    d = n - 1\\n    s = 0\\n    while d % 2 == 0:\\n        d //= 2\\n        s += 1\\n    \\n    for _ in range(k):\\n        a = random.randint(2, n - 2)\\n        if is_composite(a, d, n, s):\\n            return False\\n    return True\\n\\ndef find_primes_in_range(low, high, k):\\n    primes = []\\n    for num in range(low, high + 1):\\n        if miller_rabin_test(num, k):\\n            primes.append(num)\\n    return primes\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_find_primes_in_range_example1():\\n    assert find_primes_in_range(10, 50, 10) == [11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47]\\n\\ndef test_find_primes_in_range_example2():\\n    assert find_primes_in_range(1, 20, 5) == [2, 3, 5, 7, 11, 13, 17, 19]\\n\\ndef test_find_primes_in_range_example3():\\n    assert find_primes_in_range(100, 200, 15) == [101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199]\\n\\ndef test_find_primes_in_range_small_range():\\n    assert find_primes_in_range(1, 10, 10) == [2, 3, 5, 7]\\n\\ndef test_find_primes_in_range_large_single_prime():\\n    assert find_primes_in_range(104729, 104729, 20) == [104729]\\n\\ndef test_find_primes_in_range_no_primes():\\n    assert find_primes_in_range(14, 16, 10) == []\\n    \\ndef test_find_primes_in_range_single_non_prime():\\n    assert find_primes_in_range(4, 4, 5) == []\"}]", "tag": "KodCode"}
{"id": "19d471966d169845a02a5e2f166a8741c25e94e11378c54fd9351c01124b7058", "source": "KodCode", "difficulty": "0.667", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef num_decoding_ways(s: str) -> int:\n    \"\"\" Determines the total number of ways to decode an encoded message of digits. \n    >>> num_decoding_ways(\"12\")\n    2\n    >>> num_decoding_ways(\"226\")\n    3\n    >>> num_decoding_ways(\"06\")\n    0\n    >>> num_decoding_ways(\"110\")\n    1\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef num_decoding_ways(s: str) -> int:\\n    \\\"\\\"\\\" Determines the total number of ways to decode an encoded message of digits. \\n    >>> num_decoding_ways(\\\"12\\\")\\n    2\\n    >>> num_decoding_ways(\\\"226\\\")\\n    3\\n    >>> num_decoding_ways(\\\"06\\\")\\n    0\\n    >>> num_decoding_ways(\\\"110\\\")\\n    1\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def num_decoding_ways(s: str) -> int:\\n    if not s or s[0] == '0':\\n        return 0\\n\\n    n = len(s)\\n    dp = [0] * (n + 1)\\n    dp[0] = 1\\n    dp[1] = 1\\n\\n    for i in range(2, n + 1):\\n        one_digit = int(s[i - 1])\\n        two_digits = int(s[i - 2:i])\\n\\n        if 1 <= one_digit <= 9:\\n            dp[i] += dp[i - 1]\\n        if 10 <= two_digits <= 26:\\n            dp[i] += dp[i - 2]\\n\\n    return dp[n]\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_example_1():\\n    assert num_decoding_ways(\\\"12\\\") == 2\\n\\ndef test_example_2():\\n    assert num_decoding_ways(\\\"226\\\") == 3\\n\\ndef test_example_3():\\n    assert num_decoding_ways(\\\"06\\\") == 0\\n\\ndef test_example_4():\\n    assert num_decoding_ways(\\\"110\\\") == 1\\n\\ndef test_single_digit():\\n    assert num_decoding_ways(\\\"1\\\") == 1\\n    assert num_decoding_ways(\\\"9\\\") == 1\\n\\ndef test_leading_zero():\\n    assert num_decoding_ways(\\\"0\\\") == 0\\n    assert num_decoding_ways(\\\"01\\\") == 0\\n\\ndef test_large_valid_input():\\n    assert num_decoding_ways(\\\"1111111111\\\") == 89\\n    \\ndef test_mixed_input():\\n    assert num_decoding_ways(\\\"101\\\") == 1\\n    assert num_decoding_ways(\\\"2101\\\") == 1\"}]", "tag": "KodCode"}
{"id": "97c4b0e78f0172d32452895f4b27c5813e4a53c98ef066fab2c3afa88ab24f79", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: ### Coin Change Combination Count\n\n#### Context:\nYou are given a value `value` and an array of coin denominations `coins`. Your task is to determine how many ways you can combine these coins to sum up to `value`. The order of the coins does not matter, and you have an infinite supply of each coin denomination.\n\n#### Task:\nImplement a function `count(coins: List[int], value: int) -> int` which returns the number of ways to combine the coins to sum up to the given value.\n\n#### Input Format:\n- `coins`: A list of integers representing the denominations of the coins.\n- `value`: An integer representing the total value you need to form using the given coins.\n\n#### Output Format:\n- Return an integer representing the number of possible combinations to make the `value`.\n\n#### Constraints:\n- The `value` will be a non-negative integer.\n- Each coin in the `coins` list will be a positive integer.\n\n#### Examples:\n1. **Input**: `value = 4`, `coins = [1, 2, 3]`\n   - **Output**: 4\n   - **Explanation**: The possible combinations are [1, 1, 1, 1], [1, 1, 2], [2, 2], [1, 3].\n\n2. **Input**: `value = 10`, `coins = [2, 5, 3, 6]`\n   - **Output**: 5\n   - **Explanation**: The possible combinations are [2, 2, 2, 2, 2], [2, 2, 3, 3], [2, 2, 6], [2, 3, 5], [5, 5].\n\n#### Notes:\n- Consider edge cases such as when `value` is 0 or when the `coins` list is empty.\n- Ensure your algorithm handles large values efficiently.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef count(coins: List[int], value: int) -> int:\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: ### Coin Change Combination Count\\n\\n#### Context:\\nYou are given a value `value` and an array of coin denominations `coins`. Your task is to determine how many ways you can combine these coins to sum up to `value`. The order of the coins does not matter, and you have an infinite supply of each coin denomination.\\n\\n#### Task:\\nImplement a function `count(coins: List[int], value: int) -> int` which returns the number of ways to combine the coins to sum up to the given value.\\n\\n#### Input Format:\\n- `coins`: A list of integers representing the denominations of the coins.\\n- `value`: An integer representing the total value you need to form using the given coins.\\n\\n#### Output Format:\\n- Return an integer representing the number of possible combinations to make the `value`.\\n\\n#### Constraints:\\n- The `value` will be a non-negative integer.\\n- Each coin in the `coins` list will be a positive integer.\\n\\n#### Examples:\\n1. **Input**: `value = 4`, `coins = [1, 2, 3]`\\n   - **Output**: 4\\n   - **Explanation**: The possible combinations are [1, 1, 1, 1], [1, 1, 2], [2, 2], [1, 3].\\n\\n2. **Input**: `value = 10`, `coins = [2, 5, 3, 6]`\\n   - **Output**: 5\\n   - **Explanation**: The possible combinations are [2, 2, 2, 2, 2], [2, 2, 3, 3], [2, 2, 6], [2, 3, 5], [5, 5].\\n\\n#### Notes:\\n- Consider edge cases such as when `value` is 0 or when the `coins` list is empty.\\n- Ensure your algorithm handles large values efficiently.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef count(coins: List[int], value: int) -> int:\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"from typing import List\\n\\ndef count(coins: List[int], value: int) -> int:\\n    \\\"\\\"\\\"\\n    Returns the number of ways to combine the coins to sum up to the given value.\\n    \\\"\\\"\\\"\\n    # Initialize a list to store the number of combinations for each value\\n    combinations = [0] * (value + 1)\\n    \\n    # There is one way to make the value 0, that is using no coins\\n    combinations[0] = 1\\n    \\n    # Iterate through each coin and update the combinations array\\n    for coin in coins:\\n        for i in range(coin, value + 1):\\n            combinations[i] += combinations[i - coin]\\n    \\n    return combinations[value]\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_coin_change_example_1():\\n    coins = [1, 2, 3]\\n    value = 4\\n    assert count(coins, value) == 4\\n\\ndef test_coin_change_example_2():\\n    coins = [2, 5, 3, 6]\\n    value = 10\\n    assert count(coins, value) == 5\\n\\ndef test_coin_change_value_zero():\\n    coins = [1, 2, 3]\\n    value = 0\\n    assert count(coins, value) == 1\\n\\ndef test_coin_change_empty_coins():\\n    coins = []\\n    value = 5\\n    assert count(coins, value) == 0\\n\\ndef test_coin_change_large_value():\\n    coins = [1, 2, 3]\\n    value = 100\\n    # The exact number might be large and is pre-calculated\\n    assert count(coins, value) == 884\\n\\ndef test_coin_change_single_coin():\\n    coins = [5]\\n    value = 10\\n    assert count(coins, value) == 1\\n\\ndef test_coin_change_no_solution():\\n    coins = [7]\\n    value = 5\\n    assert count(coins, value) == 0\"}]", "tag": "KodCode"}
{"id": "aa728246a12153b8b9b0f724bef806c6609600f8b20cf836cd6e6a27f118e0c6", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: **Problem Statement:**\n\nYou are required to implement functionality that mimics part of the \"mailcap\" module's behavior. Please follow the instructions below to accomplish this task. \n\n### Part 1: Implement the `parse_mailcap_files` function\n\nImplement a function `parse_mailcap_files(files: List[str]) -> Dict[str, List[Dict[str, str]]]` that reads and parses mailcap files and returns a dictionary in a similar format to `mailcap.getcaps()`. \n\n1. **Input:**\n   - `files`: A list of strings where each string represents the path of a mailcap file.\n\n2. **Output:**\n   - A dictionary mapping MIME types to a list of mailcap file entries. Each entry is a dictionary with fields parsed from the corresponding mailcap entry.\n   \n3. **Constraints:**\n   - A mailcap file contains lines where each line specifies a MIME type and its associated command and parameters.\n   - Lines starting with `#` are comments and should be ignored.\n   - Each line is of the format: `MIME/type; command; key=value; ...`\n   - Example entries:\n     ```\n     text/plain; cat %s\n     text/html; lynx %s; compose=ex_composer; edit=ex_editor\n     ```\n\n### Part 2: Implement the `find_command` function\n\nImplement a function `find_command(caps: Dict[str, List[Dict[str, str]]], MIMEtype: str, key: str = 'view', filename: str = '/dev/null', plist: List[str] = []) -> Tuple[Optional[str], Optional[Dict[str, str]]]` that finds a matching mailcap entry for a specified MIME type and returns the equivalent command and entry. \n\n1. **Input:**\n   - `caps`: A dictionary returned by the `parse_mailcap_files` function.\n   - `MIMEtype`: The MIME type to search for.\n   - `key`: The type of activity to be performed, default is 'view'. Other possible values could be 'compose' and 'edit'.\n   - `filename`: The filename to be substituted for \"%s\" in the command line.\n   - `plist`: A list of named parameters where each element is a string in the format \"name=value\". \n\n2. **Output:**\n   - A tuple where the first element is the command line to be executed (after substitutions) and the second element is the mailcap entry (as a dictionary). If no matching entry is found, return `(None, None)`.\n   \n3. **Constraints:**\n   - Replace occurrences of `%s` in the command line with the `filename`.\n   - Replace occurrences of `%{name}` in the command line with the value of the corresponding parameter in `plist`.\n   - If any disallowed character (ASCII characters other than alphanumerics and \"@+=:,./-_\") appears in `filename` or in `plist` values, return `(None, None)`.\n\n### Example Usage:\n\n```python\n# Part 1: Parse mailcap files\nfiles = [\"user_mailcap\", \"system_mailcap\"]\ncaps = parse_mailcap_files(files)\n\n# Part 2: Find command\ncommand, entry = find_command(caps, 'video/mpeg', filename='video1234.mpeg', plist=[])\nprint(command)  # Expected output: \"xmpeg video1234.mpeg\"\nprint(entry)    # Expected output: {'view': 'xmpeg %s'}\n```\n\n### Notes:\n- You should implement file reading and handle exceptions appropriately.\n- Ensure your solution is efficient and well-structured.\n- Test your functions with different inputs to validate correctness.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef parse_mailcap_files(files: List[str]) -> Dict[str, List[Dict[str, str]]]:\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: **Problem Statement:**\\n\\nYou are required to implement functionality that mimics part of the \\\"mailcap\\\" module's behavior. Please follow the instructions below to accomplish this task. \\n\\n### Part 1: Implement the `parse_mailcap_files` function\\n\\nImplement a function `parse_mailcap_files(files: List[str]) -> Dict[str, List[Dict[str, str]]]` that reads and parses mailcap files and returns a dictionary in a similar format to `mailcap.getcaps()`. \\n\\n1. **Input:**\\n   - `files`: A list of strings where each string represents the path of a mailcap file.\\n\\n2. **Output:**\\n   - A dictionary mapping MIME types to a list of mailcap file entries. Each entry is a dictionary with fields parsed from the corresponding mailcap entry.\\n   \\n3. **Constraints:**\\n   - A mailcap file contains lines where each line specifies a MIME type and its associated command and parameters.\\n   - Lines starting with `#` are comments and should be ignored.\\n   - Each line is of the format: `MIME/type; command; key=value; ...`\\n   - Example entries:\\n     ```\\n     text/plain; cat %s\\n     text/html; lynx %s; compose=ex_composer; edit=ex_editor\\n     ```\\n\\n### Part 2: Implement the `find_command` function\\n\\nImplement a function `find_command(caps: Dict[str, List[Dict[str, str]]], MIMEtype: str, key: str = 'view', filename: str = '/dev/null', plist: List[str] = []) -> Tuple[Optional[str], Optional[Dict[str, str]]]` that finds a matching mailcap entry for a specified MIME type and returns the equivalent command and entry. \\n\\n1. **Input:**\\n   - `caps`: A dictionary returned by the `parse_mailcap_files` function.\\n   - `MIMEtype`: The MIME type to search for.\\n   - `key`: The type of activity to be performed, default is 'view'. Other possible values could be 'compose' and 'edit'.\\n   - `filename`: The filename to be substituted for \\\"%s\\\" in the command line.\\n   - `plist`: A list of named parameters where each element is a string in the format \\\"name=value\\\". \\n\\n2. **Output:**\\n   - A tuple where the first element is the command line to be executed (after substitutions) and the second element is the mailcap entry (as a dictionary). If no matching entry is found, return `(None, None)`.\\n   \\n3. **Constraints:**\\n   - Replace occurrences of `%s` in the command line with the `filename`.\\n   - Replace occurrences of `%{name}` in the command line with the value of the corresponding parameter in `plist`.\\n   - If any disallowed character (ASCII characters other than alphanumerics and \\\"@+=:,./-_\\\") appears in `filename` or in `plist` values, return `(None, None)`.\\n\\n### Example Usage:\\n\\n```python\\n# Part 1: Parse mailcap files\\nfiles = [\\\"user_mailcap\\\", \\\"system_mailcap\\\"]\\ncaps = parse_mailcap_files(files)\\n\\n# Part 2: Find command\\ncommand, entry = find_command(caps, 'video/mpeg', filename='video1234.mpeg', plist=[])\\nprint(command)  # Expected output: \\\"xmpeg video1234.mpeg\\\"\\nprint(entry)    # Expected output: {'view': 'xmpeg %s'}\\n```\\n\\n### Notes:\\n- You should implement file reading and handle exceptions appropriately.\\n- Ensure your solution is efficient and well-structured.\\n- Test your functions with different inputs to validate correctness.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef parse_mailcap_files(files: List[str]) -> Dict[str, List[Dict[str, str]]]:\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"import os\\nfrom typing import List, Dict, Tuple, Optional\\n\\ndef parse_mailcap_files(files: List[str]) -> Dict[str, List[Dict[str, str]]]:\\n    caps = {}\\n    for file in files:\\n        if os.path.exists(file):\\n            with open(file, 'r') as f:\\n                for line in f:\\n                    # Ignore comments and empty lines\\n                    stripped_line = line.strip()\\n                    if stripped_line.startswith('#') or not stripped_line:\\n                        continue\\n                    \\n                    # Split MIME type and command/parameters\\n                    parts = stripped_line.split(';')\\n                    if len(parts) < 2:\\n                        continue\\n                    \\n                    mimetype = parts[0].strip()\\n                    command = parts[1].strip()\\n                    \\n                    entry = {'view': command}\\n                    for param in parts[2:]:\\n                        key_value = param.strip().split('=', 1)\\n                        if len(key_value) == 2:\\n                            entry[key_value[0].strip()] = key_value[1].strip()\\n                    \\n                    if mimetype not in caps:\\n                        caps[mimetype] = []\\n                    caps[mimetype].append(entry)\\n    return caps\\n\\ndef find_command(caps: Dict[str, List[Dict[str, str]]], MIMEtype: str, key: str = 'view', filename: str = '/dev/null', plist: List[str] = []) -> Tuple[Optional[str], Optional[Dict[str, str]]]:\\n    valid_chars = set('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@+=:,./-_')\\n    \\n    # Validate filename\\n    if not set(filename).issubset(valid_chars):\\n        return (None, None)\\n    \\n    # Validate plist\\n    params = {}\\n    for item in plist:\\n        name_value = item.split('=', 1)\\n        if len(name_value) != 2 or not set(name_value[1]).issubset(valid_chars):\\n            return (None, None)\\n        params[name_value[0]] = name_value[1]\\n    \\n    if MIMEtype in caps:\\n        for entry in caps[MIMEtype]:\\n            if key in entry:\\n                command = entry[key]\\n                # Replace %s in command with filename\\n                command = command.replace('%s', filename)\\n                \\n                # Replace %{name} with the value from params\\n                for name, value in params.items():\\n                    command = command.replace(f'%{{{name}}}', value)\\n                \\n                return (command, entry)\\n    \\n    return (None, None)\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_parse_mailcap_files():\\n    files = [\\\"test_mailcap1\\\", \\\"test_mailcap2\\\"]\\n    # create test files\\n    with open(\\\"test_mailcap1\\\", 'w') as f:\\n        f.write(\\\"text/plain; cat %s\\\\ntext/html; lynx %s; compose=ex_composer; edit=ex_editor\\\\n\\\")\\n    with open(\\\"test_mailcap2\\\", 'w') as f:\\n        f.write(\\\"# This is a comment\\\\naudio/mpeg; play %s\\\\n\\\")\\n    \\n    caps = parse_mailcap_files(files)\\n    \\n    assert \\\"text/plain\\\" in caps\\n    assert \\\"text/html\\\" in caps\\n    assert \\\"audio/mpeg\\\" in caps\\n    \\n    assert caps[\\\"text/plain\\\"][0][\\\"view\\\"] == \\\"cat %s\\\"\\n    assert caps[\\\"text/html\\\"][0][\\\"view\\\"] == \\\"lynx %s\\\"\\n    assert caps[\\\"text/html\\\"][0][\\\"compose\\\"] == \\\"ex_composer\\\"\\n    assert caps[\\\"text/html\\\"][0][\\\"edit\\\"] == \\\"ex_editor\\\"\\n    assert caps[\\\"audio/mpeg\\\"][0][\\\"view\\\"] == \\\"play %s\\\"\\n    \\ndef test_find_command():\\n    caps = {\\n        \\\"text/plain\\\": [{\\\"view\\\": \\\"cat %s\\\"}],\\n        \\\"text/html\\\": [{\\\"view\\\": \\\"lynx %s\\\", \\\"compose\\\": \\\"ex_composer\\\", \\\"edit\\\": \\\"ex_editor\\\"}],\\n        \\\"audio/mpeg\\\": [{\\\"view\\\": \\\"play %s\\\"}]\\n    }\\n    \\n    command, entry = find_command(caps, 'text/plain', filename='example.txt')\\n    assert command == \\\"cat example.txt\\\"\\n    assert entry == {\\\"view\\\": \\\"cat %s\\\"}\\n    \\n    command, entry = find_command(caps, 'text/html', key='compose', filename='index.html')\\n    assert command == \\\"ex_composer\\\"\\n    assert entry == {\\\"view\\\": \\\"lynx %s\\\", \\\"compose\\\": \\\"ex_composer\\\", \\\"edit\\\": \\\"ex_editor\\\"}\\n    \\n    command, entry = find_command(caps, 'audio/mpeg', filename='song.mp3')\\n    assert command == \\\"play song.mp3\\\"\\n    assert entry == {\\\"view\\\": \\\"play %s\\\"}\\n    \\n    # Test invalid filename\\n    command, entry = find_command(caps, 'text/plain', filename='example$txt')\\n    assert command == None\\n    assert entry == None\\n    \\n    # Test invalid plist\\n    command, entry = find_command(caps, 'text/html', filename='index.html', plist=['param=invalid$value'])\\n    assert command == None\\n    assert entry == None\\n    \\n    # Test plist replacement\\n    command, entry = find_command(caps, 'text/html', filename='index.html', plist=['arg=test'])\\n    assert command == \\\"lynx index.html\\\"\\n    assert entry == {\\\"view\\\": \\\"lynx %s\\\", \\\"compose\\\": \\\"ex_composer\\\", \\\"edit\\\": \\\"ex_editor\\\"}\\n\\ndef test_find_command_with_plist():\\n    caps = {\\n        \\\"application/x-example\\\": [{\\\"view\\\": \\\"example_view %s --param %{param}\\\", \\\"edit\\\": \\\"example_edit %{arg1} %{arg2}\\\"}]\\n    }\\n    \\n    command, entry = find_command(caps, 'application/x-example', filename='example.file', plist=['param=value'])\\n    assert command == \\\"example_view example.file --param value\\\"\\n    assert entry == {\\\"view\\\": \\\"example_view %s --param %{param}\\\", \\\"edit\\\": \\\"example_edit %{arg1} %{arg2}\\\"}\\n    \\n    command, entry = find_command(caps, 'application/x-example', key='edit', filename='example.file', plist=['arg1=value1', 'arg2=value2'])\\n    assert command == \\\"example_edit value1 value2\\\"\\n    assert entry == {\\\"view\\\": \\\"example_view %s --param %{param}\\\", \\\"edit\\\": \\\"example_edit %{arg1} %{arg2}\\\"}\"}]", "tag": "KodCode"}
{"id": "a42538a694474a75e19ce9e51e1bda5499dbc8ac8119688a9c1e77d6fa35b911", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Create a Python program that generates a random 80-character string using a combination of lowercase letters, uppercase letters, numbers, and special characters. Then, extract all unique characters from this string and display them in sorted order. Additionally, identify and display the count of different types of characters used in the string (i.e., how many digits, lowercase letters, uppercase letters, and special characters).\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\nspecials = len(string) - digits - lowercase - uppercase\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Create a Python program that generates a random 80-character string using a combination of lowercase letters, uppercase letters, numbers, and special characters. Then, extract all unique characters from this string and display them in sorted order. Additionally, identify and display the count of different types of characters used in the string (i.e., how many digits, lowercase letters, uppercase letters, and special characters).\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\nspecials = len(string) - digits - lowercase - uppercase\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"import random\\nimport string\\n\\ndef generate_random_string(length=80):\\n    \\\"\\\"\\\"\\n    Generates a radom string of given length using a combination of\\n    lowercase letters, uppercase letters, numbers, and special characters.\\n    \\\"\\\"\\\"\\n    characters = string.ascii_letters + string.digits + string.punctuation\\n    random_string = ''.join(random.choice(characters) for _ in range(length))\\n    return random_string\\n\\ndef extract_unique_sorted(string):\\n    \\\"\\\"\\\"\\n    Extracts unique characters from the given string and returns them in sorted order.\\n    \\\"\\\"\\\"\\n    unique_characters = sorted(set(string))\\n    return ''.join(unique_characters)\\n\\ndef count_character_types(string):\\n    \\\"\\\"\\\"\\n    Counts the number of digits, lowercase letters, uppercase letters, and special characters in the string.\\n    \\\"\\\"\\\"\\n    digits = sum(c.isdigit() for c in string)\\n    lowercase = sum(c.islower() for c in string)\\n    uppercase = sum(c.isupper() for c in string)\\n    specials = len(string) - digits - lowercase - uppercase\\n    return {\\n        \\\"digits\\\": digits,\\n        \\\"lowercase\\\": lowercase,\\n        \\\"uppercase\\\": uppercase,\\n        \\\"specials\\\": specials\\n    }\\n\\n# Example Usage\\nif __name__ == \\\"__main__\\\":\\n    random_string = generate_random_string()\\n    print(\\\"Random String:\\\", random_string)\\n    \\n    unique_sorted_chars = extract_unique_sorted(random_string)\\n    print(\\\"Unique Sorted Characters:\\\", unique_sorted_chars)\\n    \\n    char_type_counts = count_character_types(random_string)\\n    print(\\\"Character Types Count:\\\", char_type_counts)\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_generate_random_string_length():\\n    assert len(generate_random_string()) == 80\\n    assert len(generate_random_string(100)) == 100\\n\\ndef test_extract_unique_sorted():\\n    test_str = \\\"aabbcc123!!\\\"\\n    assert extract_unique_sorted(test_str) == \\\"!123abc\\\"\\n\\ndef test_count_character_types():\\n    test_str = \\\"Aa1!\\\"\\n    counts = count_character_types(test_str)\\n    assert counts[\\\"digits\\\"] == 1\\n    assert counts[\\\"lowercase\\\"] == 1\\n    assert counts[\\\"uppercase\\\"] == 1\\n    assert counts[\\\"specials\\\"] == 1\\n\\ndef test_count_character_types_with_more_chars():\\n    test_str = \\\"abcABC123!@#\\\"\\n    counts = count_character_types(test_str)\\n    assert counts[\\\"digits\\\"] == 3\\n    assert counts[\\\"lowercase\\\"] == 3\\n    assert counts[\\\"uppercase\\\"] == 3\\n    assert counts[\\\"specials\\\"] == 3\"}]", "tag": "KodCode"}
{"id": "a5b52de84e79c5a5457b5471c93f100d9e64f4b52c6bf9cfdf5ce2f6b49327f2", "source": "KodCode", "difficulty": "0.8", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\nimport heapq\nfrom typing import Dict, List, Tuple\n\ndef dijkstra(graph: Dict[str, List[Tuple[str, int]]], start: str) -> Dict[str, int]:\n    \"\"\"\n    Find the shortest path in an undirected weighted graph using Dijkstra's algorithm.\n    \n    :param graph: A dictionary where keys are node names and values are lists of tuples\n                  (neighbour, weight) representing the edges.\n    :param start: The starting node for the path search.\n    :return: A dictionary where keys are nodes and values are the shortest distance from\n             the start node to that node.\n\n    >>> graph = {\n    ... 'A': [('B', 1), ('C', 4)],\n    ... 'B': [('A', 1), ('C', 2), ('D', 5)],\n    ... 'C': [('A', 4), ('B', 2), ('D', 1)],\n    ... 'D': [('B', 5), ('C', 1)]\n    ... }\n    >>> dijkstra(graph, 'A')\n    {'A': 0, 'B': 1, 'C': 3, 'D': 4}\n\n    >>> graph = {\n    ... 'A': [('B', 7), ('C', 9), ('F', 14)],\n    ... 'B': [('A', 7), ('C', 10), ('D', 15)],\n    ... 'C': [('A', 9), ('B', 10), ('D', 11), ('F', 2)],\n    ... 'D': [('B', 15), ('C', 11), ('E', 6)],\n    ... 'E': [('D', 6), ('F', 9)],\n    ... 'F': [('A', 14), ('C', 2), ('E', 9)]\n    ... }\n    >>> dijkstra(graph, 'A')\n    {'A': 0, 'B': 7, 'C': 9, 'D': 20, 'E': 20, 'F': 11}\n\n    >>> graph = {\n    ... 'A': [('B', 1), ('C', 4)],\n    ... 'B': [('A', 1), ('C', 2), ('D', 5)],\n    ... 'C': [('A', 4), ('B', 2), ('D', 1)],\n    ... 'D': [('B', 5), ('C', 1)]\n    ... }\n    >>> dijkstra(graph, 'B')\n    {'A': 1, 'B': 0, 'C': 2, 'D': 3}\n\n    >>> graph = {\n    ... 'A': [('B', 1)],\n    ... 'B': [('A', 1), ('C', 2)],\n    ... 'C': [('B', 2)],\n    ... 'D': []\n    ... }\n    >>> dijkstra(graph, 'A')\n    {'A': 0, 'B': 1, 'C': 3, 'D': float('inf')}\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\nimport heapq\\nfrom typing import Dict, List, Tuple\\n\\ndef dijkstra(graph: Dict[str, List[Tuple[str, int]]], start: str) -> Dict[str, int]:\\n    \\\"\\\"\\\"\\n    Find the shortest path in an undirected weighted graph using Dijkstra's algorithm.\\n    \\n    :param graph: A dictionary where keys are node names and values are lists of tuples\\n                  (neighbour, weight) representing the edges.\\n    :param start: The starting node for the path search.\\n    :return: A dictionary where keys are nodes and values are the shortest distance from\\n             the start node to that node.\\n\\n    >>> graph = {\\n    ... 'A': [('B', 1), ('C', 4)],\\n    ... 'B': [('A', 1), ('C', 2), ('D', 5)],\\n    ... 'C': [('A', 4), ('B', 2), ('D', 1)],\\n    ... 'D': [('B', 5), ('C', 1)]\\n    ... }\\n    >>> dijkstra(graph, 'A')\\n    {'A': 0, 'B': 1, 'C': 3, 'D': 4}\\n\\n    >>> graph = {\\n    ... 'A': [('B', 7), ('C', 9), ('F', 14)],\\n    ... 'B': [('A', 7), ('C', 10), ('D', 15)],\\n    ... 'C': [('A', 9), ('B', 10), ('D', 11), ('F', 2)],\\n    ... 'D': [('B', 15), ('C', 11), ('E', 6)],\\n    ... 'E': [('D', 6), ('F', 9)],\\n    ... 'F': [('A', 14), ('C', 2), ('E', 9)]\\n    ... }\\n    >>> dijkstra(graph, 'A')\\n    {'A': 0, 'B': 7, 'C': 9, 'D': 20, 'E': 20, 'F': 11}\\n\\n    >>> graph = {\\n    ... 'A': [('B', 1), ('C', 4)],\\n    ... 'B': [('A', 1), ('C', 2), ('D', 5)],\\n    ... 'C': [('A', 4), ('B', 2), ('D', 1)],\\n    ... 'D': [('B', 5), ('C', 1)]\\n    ... }\\n    >>> dijkstra(graph, 'B')\\n    {'A': 1, 'B': 0, 'C': 2, 'D': 3}\\n\\n    >>> graph = {\\n    ... 'A': [('B', 1)],\\n    ... 'B': [('A', 1), ('C', 2)],\\n    ... 'C': [('B', 2)],\\n    ... 'D': []\\n    ... }\\n    >>> dijkstra(graph, 'A')\\n    {'A': 0, 'B': 1, 'C': 3, 'D': float('inf')}\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"import heapq\\n\\ndef dijkstra(graph, start):\\n    \\\"\\\"\\\"\\n    Find the shortest path in an undirected weighted graph using Dijkstra's algorithm.\\n    \\n    :param graph: A dictionary where keys are node names and values are lists of tuples\\n                  (neighbour, weight) representing the edges.\\n    :param start: The starting node for the path search.\\n    :return: A dictionary where keys are nodes and values are the shortest distance from\\n             the start node to that node.\\n    \\\"\\\"\\\"\\n    queue = [(0, start)]\\n    distances = {node: float('inf') for node in graph}\\n    distances[start] = 0\\n    visited = set()\\n    \\n    while queue:\\n        current_distance, current_node = heapq.heappop(queue)\\n        \\n        if current_node in visited:\\n            continue\\n        \\n        visited.add(current_node)\\n        \\n        for neighbor, weight in graph[current_node]:\\n            distance = current_distance + weight\\n            \\n            if distance < distances[neighbor]:\\n                distances[neighbor] = distance\\n                heapq.heappush(queue, (distance, neighbor))\\n                \\n    return distances\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_dijkstra_simple_graph():\\n    graph = {\\n        'A': [('B', 1), ('C', 4)],\\n        'B': [('A', 1), ('C', 2), ('D', 5)],\\n        'C': [('A', 4), ('B', 2), ('D', 1)],\\n        'D': [('B', 5), ('C', 1)]\\n    }\\n    assert dijkstra(graph, 'A') == {'A': 0, 'B': 1, 'C': 3, 'D': 4}\\n\\ndef test_dijkstra_with_more_complex_graph():\\n    graph = {\\n        'A': [('B', 7), ('C', 9), ('F', 14)],\\n        'B': [('A', 7), ('C', 10), ('D', 15)],\\n        'C': [('A', 9), ('B', 10), ('D', 11), ('F', 2)],\\n        'D': [('B', 15), ('C', 11), ('E', 6)],\\n        'E': [('D', 6), ('F', 9)],\\n        'F': [('A', 14), ('C', 2), ('E', 9)]\\n    }\\n    assert dijkstra(graph, 'A') == {'A': 0, 'B': 7, 'C': 9, 'D': 20, 'E': 20, 'F': 11}\\n\\ndef test_dijkstra_starting_point():\\n    graph = {\\n        'A': [('B', 1), ('C', 4)],\\n        'B': [('A', 1), ('C', 2), ('D', 5)],\\n        'C': [('A', 4), ('B', 2), ('D', 1)],\\n        'D': [('B', 5), ('C', 1)]\\n    }\\n    assert dijkstra(graph, 'B') == {'A': 1, 'B': 0, 'C': 2, 'D': 3}\\n\\ndef test_dijkstra_unconnected_node():\\n    graph = {\\n        'A': [('B', 1)],\\n        'B': [('A', 1), ('C', 2)],\\n        'C': [('B', 2)],\\n        'D': []\\n    }\\n    assert dijkstra(graph, 'A') == {'A': 0, 'B': 1, 'C': 3, 'D': float('inf')}\"}]", "tag": "KodCode"}
{"id": "0a634f15650d98c12788114ec0a473a075ec9c425d4ac5a33bfb6d4d41ffc786", "source": "KodCode", "difficulty": "0.667", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef is_prime(n):\n    \"\"\"Utility function to check if a number is prime.\"\"\"\n    # Your code here\n\ndef maximum_prime_sum(t, test_cases):\n    \"\"\"Determine the maximum score a villager can achieve by summing the subsets of numbers that form prime numbers.\n    >>> maximum_prime_sum(2, [(5, [3, 7, 11, 14, 17]), (4, [4, 6, 8, 10])])\n    [38, 0]\n    >>> maximum_prime_sum(1, [(4, [2, 3, 5, 7])])\n    [17]\n    \"\"\"\n    # Your code here\n\n# Example usage:\n# t = 2\n# test_cases = [(5, [3, 7, 11, 14, 17]), (4, [4, 6, 8, 10])]\n# print(maximum_prime_sum(t, test_cases))  # Output: [38, 0]", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef is_prime(n):\\n    \\\"\\\"\\\"Utility function to check if a number is prime.\\\"\\\"\\\"\\n    # Your code here\\n\\ndef maximum_prime_sum(t, test_cases):\\n    \\\"\\\"\\\"Determine the maximum score a villager can achieve by summing the subsets of numbers that form prime numbers.\\n    >>> maximum_prime_sum(2, [(5, [3, 7, 11, 14, 17]), (4, [4, 6, 8, 10])])\\n    [38, 0]\\n    >>> maximum_prime_sum(1, [(4, [2, 3, 5, 7])])\\n    [17]\\n    \\\"\\\"\\\"\\n    # Your code here\\n\\n# Example usage:\\n# t = 2\\n# test_cases = [(5, [3, 7, 11, 14, 17]), (4, [4, 6, 8, 10])]\\n# print(maximum_prime_sum(t, test_cases))  # Output: [38, 0]\"}]", "ground_truth": "[\"def is_prime(n):\\n    \\\"\\\"\\\"\\n    Utility function to check if a number is prime.\\n    \\\"\\\"\\\"\\n    if n <= 1:\\n        return False\\n    if n <= 3:\\n        return True\\n    if n % 2 == 0 or n % 3 == 0:\\n        return False\\n    i = 5\\n    while i * i <= n:\\n        if n % i == 0 or n % (i + 2) == 0:\\n            return False\\n        i += 6\\n    return True\\n\\ndef maximum_prime_sum(t, test_cases):\\n    results = []\\n    for i in range(t):\\n        n, numbers = test_cases[i]\\n        prime_numbers = [num for num in numbers if is_prime(num)]\\n        results.append(sum(prime_numbers))\\n    return results\\n\\n# Example usage:\\n# t = 2\\n# test_cases = [(5, [3, 7, 11, 14, 17]), (4, [4, 6, 8, 10])]\\n# print(maximum_prime_sum(t, test_cases))  # Output: [38, 0]\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_single_test_case_with_primes():\\n    assert maximum_prime_sum(1, [(5, [3, 7, 11, 14, 17])]) == [38]\\n\\ndef test_single_test_case_with_no_primes():\\n    assert maximum_prime_sum(1, [(4, [4, 6, 8, 10])]) == [0]\\n\\ndef test_multiple_test_cases():\\n    assert maximum_prime_sum(2, [(5, [3, 7, 11, 14, 17]), (4, [4, 6, 8, 10])]) == [38, 0]\\n\\ndef test_no_prime_numbers():\\n    assert maximum_prime_sum(1, [(3, [1, 4, 6])]) == [0]\\n\\ndef test_all_prime_numbers():\\n    assert maximum_prime_sum(1, [(4, [2, 3, 5, 7])]) == [17]\\n\\ndef test_mixed_numbers():\\n    assert maximum_prime_sum(1, [(6, [10, 3, 19, 30, 25, 17])]) == [39]\"}]", "tag": "KodCode"}
{"id": "1e4c5ad8156c8bb81a40b980bfef0a49c118e145d006b87bcd01a3727d9d860f", "source": "KodCode", "difficulty": "0.6", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef divisible_by_n(arr: List[int], n: int) -> List[int]:\n    \"\"\"\n    Returns a list of elements in 'arr' that are divisible by 'n'. \n    If no such elements exist, returns a list with a single element -1.\n    \n    >>> divisible_by_n([2, 4, 6, 8], 2)\n    [2, 4, 6, 8]\n    >>> divisible_by_n([1, 2, 3, 4, 5], 2)\n    [2, 4]\n    >>> divisible_by_n([1, 3, 5, 7], 2)\n    [-1]\n    >>> divisible_by_n([], 2)\n    [-1]\n    >>> divisible_by_n([10, 20, 30], 1)\n    [10, 20, 30]\n    >>> divisible_by_n([15, 30, 45, 50], 15)\n    [15, 30, 45]\n    >>> divisible_by_n([14, 25, 71, 88], 7)\n    [14]\n    >>> divisible_by_n([50, 60, 70, 40], 10)\n    [50, 60, 70, 40]\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef divisible_by_n(arr: List[int], n: int) -> List[int]:\\n    \\\"\\\"\\\"\\n    Returns a list of elements in 'arr' that are divisible by 'n'. \\n    If no such elements exist, returns a list with a single element -1.\\n    \\n    >>> divisible_by_n([2, 4, 6, 8], 2)\\n    [2, 4, 6, 8]\\n    >>> divisible_by_n([1, 2, 3, 4, 5], 2)\\n    [2, 4]\\n    >>> divisible_by_n([1, 3, 5, 7], 2)\\n    [-1]\\n    >>> divisible_by_n([], 2)\\n    [-1]\\n    >>> divisible_by_n([10, 20, 30], 1)\\n    [10, 20, 30]\\n    >>> divisible_by_n([15, 30, 45, 50], 15)\\n    [15, 30, 45]\\n    >>> divisible_by_n([14, 25, 71, 88], 7)\\n    [14]\\n    >>> divisible_by_n([50, 60, 70, 40], 10)\\n    [50, 60, 70, 40]\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def divisible_by_n(arr, n):\\n    \\\"\\\"\\\"\\n    Returns a list of elements in 'arr' that are divisible by 'n'. \\n    If no such elements exist, returns a list with a single element -1.\\n    \\\"\\\"\\\"\\n    result = [x for x in arr if x % n == 0]\\n    return result if result else [-1]\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_divisible_by_n_all_elements_divisible():\\n    assert divisible_by_n([2, 4, 6, 8], 2) == [2, 4, 6, 8]\\n\\ndef test_divisible_by_n_some_elements_divisible():\\n    assert divisible_by_n([1, 2, 3, 4, 5], 2) == [2, 4]\\n\\ndef test_divisible_by_n_no_elements_divisible():\\n    assert divisible_by_n([1, 3, 5, 7], 2) == [-1]\\n\\ndef test_divisible_by_n_none_elements_divisible_edge_case():\\n    assert divisible_by_n([], 2) == [-1]\\n\\ndef test_divisible_by_n_divisible_by_one():\\n    assert divisible_by_n([10, 20, 30], 1) == [10, 20, 30]\\n\\ndef test_divisible_by_n_multiple_conditions():\\n    assert divisible_by_n([15, 30, 45, 50], 15) == [15, 30, 45]\\n    assert divisible_by_n([14, 25, 71, 88], 7) == [14]\\n    assert divisible_by_n([50, 60, 70, 40], 10) == [50, 60, 70, 40]\"}]", "tag": "KodCode"}
{"id": "b1b49eb2bbc312050580e6ac0d89427e984c19694d59ac3b7f3b3898d8d7f75c", "source": "KodCode", "difficulty": "0.667", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\nfrom typing import Any\nimport shelve\n\nclass PersistentDict:\n    def __init__(self, filename: str, flag: str = 'c', protocol: int = None, writeback: bool = False) -> None:\n        \"\"\" Initializes the PersistentDict with the given filename and options. \"\"\"\n    \n    def add_entry(self, key: str, value: Any) -> None:\n        \"\"\" Adds a new entry to the shelf. \"\"\"\n    \n    def get_entry(self, key: str) -> Any:\n        \"\"\" Retrieves an entry from the shelf.\n        Raises a KeyError if the key does not exist.\n        \"\"\"\n    \n    def delete_entry(self, key: str) -> None:\n        \"\"\" Deletes an entry from the shelf.\n        Raises a KeyError if the key does not exist.\n        \"\"\"\n    \n    def update_entry(self, key: str, value: Any) -> None:\n        \"\"\" Updates a mutable entry, ensuring changes persist regardless of writeback. \"\"\"\n    \n    def safe_access(self, key: str, value: Any) -> None:\n        \"\"\" Performs a thread-safe read/write operation using file locking. \"\"\"\n    \n    def __enter__(self) -> \"PersistentDict\":\n        \"\"\" Allows the class to be used as a context manager. \"\"\"\n    \n    def __exit__(self, exc_type, exc_value, traceback) -> None:\n        \"\"\" Ensures the shelf is closed when exiting the context. \"\"\"\n\n# Usage example\nwith PersistentDict('mydata', writeback=True) as pd:\n    pd.add_entry('key1', [1, 2, 3])\n    print(pd.get_entry('key1'))\n    pd.update_entry('key1', 4)\n    print(pd.get_entry('key1'))\n\n\nUnit Test:\nfrom solution import PersistentDict\nimport os\nimport pytest\n\n@pytest.fixture\ndef persistent_dict():\n    filename = 'test_shelf'\n    # Ensure the file does not exist before starting the test\n    if os.path.exists(filename):\n        os.remove(filename)\n    yield PersistentDict(filename)\n    # Cleanup the file after the test\n    if os.path.exists(filename):\n        os.remove(filename)\n    if os.path.exists(filename + \".lock\"):\n        os.remove(filename + \".lock\")\n\ndef test_add_entry(persistent_dict):\n    with persistent_dict as pd:\n        pd.add_entry('key1', [1, 2, 3])\n        assert pd.get_entry('key1') == [1, 2, 3]\n\ndef test_get_entry(persistent_dict):\n    with persistent_dict as pd:\n        pd.add_entry('key2', [4, 5, 6])\n        assert pd.get_entry('key2') == [4, 5, 6]\n\ndef test_delete_entry(persistent_dict):\n    with persistent_dict as pd:\n        pd.add_entry('key3', [7, 8, 9])\n        pd.delete_entry('key3')\n        with pytest.raises(KeyError):\n            pd.get_entry('key3')\n\ndef test_update_entry(persistent_dict):\n    with persistent_dict as pd:\n        pd.add_entry('key4', [10, 11])\n        pd.update_entry('key4', 12)\n        assert pd.get_entry('key4') == [10, 11, 12]\n\ndef test_safe_access(persistent_dict):\n    with persistent_dict as pd:\n        pd.safe_access('key5', [13, 14])\n        assert pd.get_entry('key5') == [13, 14]", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\nfrom typing import Any\\nimport shelve\\n\\nclass PersistentDict:\\n    def __init__(self, filename: str, flag: str = 'c', protocol: int = None, writeback: bool = False) -> None:\\n        \\\"\\\"\\\" Initializes the PersistentDict with the given filename and options. \\\"\\\"\\\"\\n    \\n    def add_entry(self, key: str, value: Any) -> None:\\n        \\\"\\\"\\\" Adds a new entry to the shelf. \\\"\\\"\\\"\\n    \\n    def get_entry(self, key: str) -> Any:\\n        \\\"\\\"\\\" Retrieves an entry from the shelf.\\n        Raises a KeyError if the key does not exist.\\n        \\\"\\\"\\\"\\n    \\n    def delete_entry(self, key: str) -> None:\\n        \\\"\\\"\\\" Deletes an entry from the shelf.\\n        Raises a KeyError if the key does not exist.\\n        \\\"\\\"\\\"\\n    \\n    def update_entry(self, key: str, value: Any) -> None:\\n        \\\"\\\"\\\" Updates a mutable entry, ensuring changes persist regardless of writeback. \\\"\\\"\\\"\\n    \\n    def safe_access(self, key: str, value: Any) -> None:\\n        \\\"\\\"\\\" Performs a thread-safe read/write operation using file locking. \\\"\\\"\\\"\\n    \\n    def __enter__(self) -> \\\"PersistentDict\\\":\\n        \\\"\\\"\\\" Allows the class to be used as a context manager. \\\"\\\"\\\"\\n    \\n    def __exit__(self, exc_type, exc_value, traceback) -> None:\\n        \\\"\\\"\\\" Ensures the shelf is closed when exiting the context. \\\"\\\"\\\"\\n\\n# Usage example\\nwith PersistentDict('mydata', writeback=True) as pd:\\n    pd.add_entry('key1', [1, 2, 3])\\n    print(pd.get_entry('key1'))\\n    pd.update_entry('key1', 4)\\n    print(pd.get_entry('key1'))\\n\\n\\nUnit Test:\\nfrom solution import PersistentDict\\nimport os\\nimport pytest\\n\\n@pytest.fixture\\ndef persistent_dict():\\n    filename = 'test_shelf'\\n    # Ensure the file does not exist before starting the test\\n    if os.path.exists(filename):\\n        os.remove(filename)\\n    yield PersistentDict(filename)\\n    # Cleanup the file after the test\\n    if os.path.exists(filename):\\n        os.remove(filename)\\n    if os.path.exists(filename + \\\".lock\\\"):\\n        os.remove(filename + \\\".lock\\\")\\n\\ndef test_add_entry(persistent_dict):\\n    with persistent_dict as pd:\\n        pd.add_entry('key1', [1, 2, 3])\\n        assert pd.get_entry('key1') == [1, 2, 3]\\n\\ndef test_get_entry(persistent_dict):\\n    with persistent_dict as pd:\\n        pd.add_entry('key2', [4, 5, 6])\\n        assert pd.get_entry('key2') == [4, 5, 6]\\n\\ndef test_delete_entry(persistent_dict):\\n    with persistent_dict as pd:\\n        pd.add_entry('key3', [7, 8, 9])\\n        pd.delete_entry('key3')\\n        with pytest.raises(KeyError):\\n            pd.get_entry('key3')\\n\\ndef test_update_entry(persistent_dict):\\n    with persistent_dict as pd:\\n        pd.add_entry('key4', [10, 11])\\n        pd.update_entry('key4', 12)\\n        assert pd.get_entry('key4') == [10, 11, 12]\\n\\ndef test_safe_access(persistent_dict):\\n    with persistent_dict as pd:\\n        pd.safe_access('key5', [13, 14])\\n        assert pd.get_entry('key5') == [13, 14]\"}]", "ground_truth": "[\"from typing import Any\\nimport shelve\\nimport fcntl\\nimport os\\n\\nclass PersistentDict:\\n    def __init__(self, filename: str, flag: str = 'c', protocol: int = None, writeback: bool = False) -> None:\\n        self.filename = filename\\n        self.flag = flag\\n        self.protocol = protocol\\n        self.writeback = writeback\\n        self.shelf = shelve.open(filename, flag, protocol, writeback)\\n        self.lock_file = None\\n\\n    def __enter__(self) -> \\\"PersistentDict\\\":\\n        # Open the lock file\\n        self.lock_file = open(self.filename + \\\".lock\\\", \\\"w\\\")\\n        return self\\n\\n    def __exit__(self, exc_type, exc_value, traceback) -> None:\\n        # Close the shelf and the lock file\\n        self.shelf.close()\\n        self.lock_file.close()\\n\\n    def add_entry(self, key: str, value: Any) -> None:\\n        self.shelf[key] = value\\n        self.shelf.sync()\\n\\n    def get_entry(self, key: str) -> Any:\\n        return self.shelf[key]\\n\\n    def delete_entry(self, key: str) -> None:\\n        del self.shelf[key]\\n        self.shelf.sync()\\n\\n    def update_entry(self, key: str, value: Any) -> None:\\n        if self.writeback:\\n            self.shelf[key].append(value)\\n        else:\\n            temp = self.shelf[key]\\n            temp.append(value)\\n            self.shelf[key] = temp\\n        self.shelf.sync()\\n\\n    def safe_access(self, key: str, value: Any) -> None:\\n        fcntl.flock(self.lock_file, fcntl.LOCK_EX)\\n        try:\\n            self.add_entry(key, value)\\n        finally:\\n            fcntl.flock(self.lock_file, fcntl.LOCK_UN)\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\nimport os\\nimport pytest\\n\\n@pytest.fixture\\ndef persistent_dict():\\n    filename = 'test_shelf'\\n    # Ensure the file does not exist before starting the test\\n    if os.path.exists(filename):\\n        os.remove(filename)\\n    yield PersistentDict(filename)\\n    # Cleanup the file after the test\\n    if os.path.exists(filename):\\n        os.remove(filename)\\n    if os.path.exists(filename + \\\".lock\\\"):\\n        os.remove(filename + \\\".lock\\\")\\n\\ndef test_add_entry(persistent_dict):\\n    with persistent_dict as pd:\\n        pd.add_entry('key1', [1, 2, 3])\\n        assert pd.get_entry('key1') == [1, 2, 3]\\n\\ndef test_get_entry(persistent_dict):\\n    with persistent_dict as pd:\\n        pd.add_entry('key2', [4, 5, 6])\\n        assert pd.get_entry('key2') == [4, 5, 6]\\n\\ndef test_delete_entry(persistent_dict):\\n    with persistent_dict as pd:\\n        pd.add_entry('key3', [7, 8, 9])\\n        pd.delete_entry('key3')\\n        with pytest.raises(KeyError):\\n            pd.get_entry('key3')\\n\\ndef test_update_entry(persistent_dict):\\n    with persistent_dict as pd:\\n        pd.add_entry('key4', [10, 11])\\n        pd.update_entry('key4', 12)\\n        assert pd.get_entry('key4') == [10, 11, 12]\\n\\ndef test_safe_access(persistent_dict):\\n    with persistent_dict as pd:\\n        pd.safe_access('key5', [13, 14])\\n        assert pd.get_entry('key5') == [13, 14]\"}]", "tag": "KodCode"}
{"id": "5977a0caa217c762d7aeb06b989447b43131479ddc602749a5bc70d6e12dc548", "source": "KodCode", "difficulty": "0.333", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef deploy(soldiers_strength, k):\n    \"\"\"\n    Deploy soldiers into k units such that no unit exceeds 100% strength.\n    If it's not possible to form k units that satisfy the condition, return an empty list.\n    \n    :param soldiers_strength: List of integers representing the strength of each soldier.\n    :param k: Number of units to form.\n    \n    :return: List of k units, where each unit is a list of soldier strengths.\n    \n    >>> deploy([30, 20, 50, 40, 10], 3)\n    [[50], [40, 10], [30, 20]]\n    \n    >>> deploy([60, 50], 1)\n    []\n    \n    >>> deploy([10, 20, 30, 40], 1)\n    [[10, 20, 30, 40]]\n    \n    >>> deploy([10, 20, 30, 40], 4)\n    [[10], [20], [30], [40]]\n    \n    >>> deploy([25, 25, 25, 25], 2)\n    [[25, 25], [25, 25]]\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef deploy(soldiers_strength, k):\\n    \\\"\\\"\\\"\\n    Deploy soldiers into k units such that no unit exceeds 100% strength.\\n    If it's not possible to form k units that satisfy the condition, return an empty list.\\n    \\n    :param soldiers_strength: List of integers representing the strength of each soldier.\\n    :param k: Number of units to form.\\n    \\n    :return: List of k units, where each unit is a list of soldier strengths.\\n    \\n    >>> deploy([30, 20, 50, 40, 10], 3)\\n    [[50], [40, 10], [30, 20]]\\n    \\n    >>> deploy([60, 50], 1)\\n    []\\n    \\n    >>> deploy([10, 20, 30, 40], 1)\\n    [[10, 20, 30, 40]]\\n    \\n    >>> deploy([10, 20, 30, 40], 4)\\n    [[10], [20], [30], [40]]\\n    \\n    >>> deploy([25, 25, 25, 25], 2)\\n    [[25, 25], [25, 25]]\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def deploy(soldiers_strength, k):\\n    \\\"\\\"\\\"\\n    Deploy soldiers into k units such that no unit exceeds 100% strength.\\n    If it's not possible to form k units that satisfy the condition, return an empty list.\\n    \\n    :param soldiers_strength: List of integers representing the strength of each soldier.\\n    :param k: Number of units to form.\\n    \\n    :return: List of k units, where each unit is a list of soldier strengths.\\n    \\\"\\\"\\\"\\n    soldiers_strength.sort(reverse=True)\\n    units = [[] for _ in range(k)]\\n    unit_strength = [0] * k\\n    \\n    for strength in soldiers_strength:\\n        # Find the unit with the minimum total strength that can accommodate the current soldier\\n        min_unit_index = -1\\n        min_unit_strength = float('inf')\\n        \\n        for i in range(k):\\n            if unit_strength[i] + strength <= 100 and unit_strength[i] < min_unit_strength:\\n                min_unit_index = i\\n                min_unit_strength = unit_strength[i]\\n                \\n        if min_unit_index == -1:\\n            # Cannot place this soldier in any unit without exceeding the maximum strength\\n            return []\\n        \\n        units[min_unit_index].append(strength)\\n        unit_strength[min_unit_index] += strength\\n    \\n    return units\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_example_case():\\n    soldiers = [30, 20, 50, 40, 10]\\n    k = 3\\n    result = deploy(soldiers, k)\\n    expected = [[50], [40, 10], [30, 20]]\\n    result_sorted = [sorted(unit) for unit in result]\\n    expected_sorted = [sorted(unit) for unit in expected]\\n    assert sorted(result_sorted) == sorted(expected_sorted)\\n\\ndef test_impossible_case():\\n    soldiers = [60, 50]\\n    k = 1\\n    result = deploy(soldiers, k)\\n    expected = []\\n    assert result == expected\\n\\ndef test_all_soldiers_to_one_unit():\\n    soldiers = [10, 20, 30, 40]\\n    k = 1\\n    result = deploy(soldiers, k)\\n    expected = [[10, 20, 30, 40]]\\n    result_sorted = [sorted(unit) for unit in result]\\n    expected_sorted = [sorted(unit) for unit in expected]\\n    assert sorted(result_sorted) == sorted(expected_sorted)\\n\\ndef test_each_unit_with_single_soldier():\\n    soldiers = [10, 20, 30, 40]\\n    k = 4\\n    result = deploy(soldiers, k)\\n    expected = [[10], [20], [30], [40]]\\n    result_sorted = [sorted(unit) for unit in result]\\n    expected_sorted = [sorted(unit) for unit in expected]\\n    assert sorted(result_sorted) == sorted(expected_sorted)\\n\\ndef test_exact_fit_for_units():\\n    soldiers = [25, 25, 25, 25]\\n    k = 2\\n    result = deploy(soldiers, k)\\n    expected = [[25, 25], [25, 25]]\\n    result_sorted = [sorted(unit) for unit in result]\\n    expected_sorted = [sorted(unit) for unit in expected]\\n    assert sorted(result_sorted) == sorted(expected_sorted)\"}]", "tag": "KodCode"}
{"id": "a2d79ffa33b7d7fc6221d50e7b2917f42b7d31358c86e027c205120470d58d04", "source": "KodCode", "difficulty": "0.667", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef max_water_usage(n, w, water_required):\n    \"\"\" Determine the maximum number of liters of water Usha can use without exceeding her capacity in one watering session.\n    >>> max_water_usage(5, 100, [10, 20, 30, 40, 50]) == 100\n    >>> max_water_usage(4, 50, [15, 25, 35, 20]) == 40\n    >>> max_water_usage(6, 200, [10, 20, 30, 40, 50, 60]) == 200\n    \"\"\"\n    \ndef process_input(test_cases):\n    \"\"\" Process multiple test cases to determine the maximum water usage for each.\n    >>> process_input([(5, 100, [10, 20, 30, 40, 50]), (4, 50, [15, 25, 35, 20]), (6, 200, [10, 20, 30, 40, 50, 60])]) == [100, 40, 200]\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef max_water_usage(n, w, water_required):\\n    \\\"\\\"\\\" Determine the maximum number of liters of water Usha can use without exceeding her capacity in one watering session.\\n    >>> max_water_usage(5, 100, [10, 20, 30, 40, 50]) == 100\\n    >>> max_water_usage(4, 50, [15, 25, 35, 20]) == 40\\n    >>> max_water_usage(6, 200, [10, 20, 30, 40, 50, 60]) == 200\\n    \\\"\\\"\\\"\\n    \\ndef process_input(test_cases):\\n    \\\"\\\"\\\" Process multiple test cases to determine the maximum water usage for each.\\n    >>> process_input([(5, 100, [10, 20, 30, 40, 50]), (4, 50, [15, 25, 35, 20]), (6, 200, [10, 20, 30, 40, 50, 60])]) == [100, 40, 200]\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def max_water_usage(n, w, water_required):\\n    max_water = 0\\n    for start in range(n):\\n        current_sum = 0\\n        for end in range(start, n):\\n            current_sum += water_required[end]\\n            if current_sum > w:\\n                break\\n            max_water = max(max_water, current_sum)\\n    return max_water\\n\\ndef process_input(test_cases):\\n    results = []\\n    for n, w, water_required in test_cases:\\n        results.append(max_water_usage(n, w, water_required))\\n    return results\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_single_test_case():\\n    assert max_water_usage(5, 100, [10, 20, 30, 40, 50]) == 100\\n    assert max_water_usage(4, 50, [15, 25, 35, 20]) == 40\\n    assert max_water_usage(6, 200, [10, 20, 30, 40, 50, 60]) == 200\\n\\ndef test_multiple_test_cases():\\n    test_cases = [\\n        (5, 100, [10, 20, 30, 40, 50]),\\n        (4, 50, [15, 25, 35, 20]),\\n        (6, 200, [10, 20, 30, 40, 50, 60]),\\n    ]\\n    expected_results = [100, 40, 200]\\n    assert process_input(test_cases) == expected_results\\n\\ndef test_edge_cases():\\n    assert max_water_usage(1, 10, [10]) == 10\\n    assert max_water_usage(1, 5, [10]) == 0\\n    assert max_water_usage(3, 5, [2, 2, 2]) == 4\\n    assert max_water_usage(3, 7, [1, 2, 3]) == 6\"}]", "tag": "KodCode"}
{"id": "30e7f54e6f2dda50f8abdf9a058d353d76cb216677ecdf840834b0f27270313f", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: You are given an integer matrix `grid` of size `n x m` where each element represents the height of a building at that position. You need to determine the maximum possible view that a person standing on any building can have. The view of a building at position `(i, j)` is defined as the maximum height difference between the height of the building at `(i, j)` and any other building in the grid.\n\nYour task is to find the maximum view possible and the position of the building that provides this view.\n\nThe first line contains two integers `n` and `m` (1 ≤ n, m ≤ 100) — the dimensions of the grid. The following n lines contain m integers each, where the j-th integer in the i-th line represents the height `hij` (1 ≤ hij ≤ 10000) of the building at position (i, j).\n\nOutput the maximum view possible and the position (i, j) that provides this view. If there are multiple positions with the same maximum view, output the position with the smallest row number, and if there are still multiple positions, output the one with the smallest column number.\n\nExample:\n\nInput:\n3 3\n1 3 4\n2 5 6\n7 8 9\n\nOutput:\n8\n2 2\n\nExplanation:\nThe maximum view is achieved at the building at position (2, 2) with a height of 5. The maximum height difference here is 5 - 1 = 8, which is the highest possible difference in the grid.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\nprint(max_view(grid))\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: You are given an integer matrix `grid` of size `n x m` where each element represents the height of a building at that position. You need to determine the maximum possible view that a person standing on any building can have. The view of a building at position `(i, j)` is defined as the maximum height difference between the height of the building at `(i, j)` and any other building in the grid.\\n\\nYour task is to find the maximum view possible and the position of the building that provides this view.\\n\\nThe first line contains two integers `n` and `m` (1 ≤ n, m ≤ 100) — the dimensions of the grid. The following n lines contain m integers each, where the j-th integer in the i-th line represents the height `hij` (1 ≤ hij ≤ 10000) of the building at position (i, j).\\n\\nOutput the maximum view possible and the position (i, j) that provides this view. If there are multiple positions with the same maximum view, output the position with the smallest row number, and if there are still multiple positions, output the one with the smallest column number.\\n\\nExample:\\n\\nInput:\\n3 3\\n1 3 4\\n2 5 6\\n7 8 9\\n\\nOutput:\\n8\\n2 2\\n\\nExplanation:\\nThe maximum view is achieved at the building at position (2, 2) with a height of 5. The maximum height difference here is 5 - 1 = 8, which is the highest possible difference in the grid.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\nprint(max_view(grid))\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def max_view(grid):\\n    \\\"\\\"\\\"\\n    This function returns the maximum possible view and the position of the building that provides this view.\\n    \\n    :param grid: List[List[int]], n x m matrix representing the heights of buildings\\n    :return: Tuple(int, Tuple(int, int)), maximum view possible and position\\n    \\\"\\\"\\\"\\n    n = len(grid)\\n    m = len(grid[0])\\n    \\n    # Find the min and max height in the grid\\n    min_height = float('inf')\\n    max_height = float('-inf')\\n    \\n    for row in grid:\\n        for height in row:\\n            if height < min_height:\\n                min_height = height\\n            if height > max_height:\\n                max_height = height\\n                \\n    max_view = max_height - min_height\\n    \\n    # Find the position of the building that provides this view\\n    for i in range(n):\\n        for j in range(m):\\n            if grid[i][j] == min_height:\\n                return (max_view, (i, j))\\n\\n# Example usage\\ngrid = [\\n    [1, 3, 4],\\n    [2, 5, 6],\\n    [7, 8, 9]\\n]\\nprint(max_view(grid))\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_max_view_1():\\n    grid = [\\n        [1, 3, 4],\\n        [2, 5, 6],\\n        [7, 8, 9]\\n    ]\\n    assert max_view(grid) == (8, (0, 0))\\n\\ndef test_max_view_2():\\n    grid = [\\n        [10, 20],\\n        [30, 40]\\n    ]\\n    assert max_view(grid) == (30, (0, 0))\\n\\ndef test_max_view_3():\\n    grid = [\\n        [5, 2],\\n        [9, 7]\\n    ]\\n    assert max_view(grid) == (7, (0, 1))\\n\\ndef test_max_view_4():\\n    grid = [\\n        [1]\\n    ]\\n    assert max_view(grid) == (0, (0, 0))\\n\\ndef test_max_view_5():\\n    grid = [\\n        [1, 5, 9],\\n        [4, 6, 3],\\n        [7, 2, 8]\\n    ]\\n    assert max_view(grid) == (8, (0, 0))\"}]", "tag": "KodCode"}
{"id": "1534b249cf16e2829463b235d24c83a52f9e17d6f76d8b5805bc2999bdfe6aca", "source": "KodCode", "difficulty": "0.333", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef determine_winner(t: int, test_cases: list[tuple[int, list[int]]]) -> list[str]:\n    \"\"\"\n    Determines the winner of the game for each test case.\n\n    Parameters:\n    t (int): Number of test cases\n    test_cases (list of tuple): Each tuple contains (n, sequence) where n is the length of the sequence and sequence is the list of integers.\n\n    Returns:\n    list of str: List of results, \"Alice\" if Alice wins the game or \"Bob\" if Bob wins the game for each test case.\n    \n    >>> determine_winner(2, [(3, [1, 2, 3]), (4, [0, 0, 0, 0])])\n    [\"Alice\", \"Bob\"]\n    >>> determine_winner(1, [(5, [0, 0, 0, 0, 0])])\n    [\"Bob\"]\n    >>> determine_winner(1, [(5, [1, 2, 0, 3, 4])])\n    [\"Bob\"]\n    >>> determine_winner(1, [(5, [1, 2, 0, 0, 2])])\n    [\"Alice\"]\n    >>> determine_winner(2, [(1, [1]), (1, [0])])\n    [\"Alice\", \"Bob\"]\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef determine_winner(t: int, test_cases: list[tuple[int, list[int]]]) -> list[str]:\\n    \\\"\\\"\\\"\\n    Determines the winner of the game for each test case.\\n\\n    Parameters:\\n    t (int): Number of test cases\\n    test_cases (list of tuple): Each tuple contains (n, sequence) where n is the length of the sequence and sequence is the list of integers.\\n\\n    Returns:\\n    list of str: List of results, \\\"Alice\\\" if Alice wins the game or \\\"Bob\\\" if Bob wins the game for each test case.\\n    \\n    >>> determine_winner(2, [(3, [1, 2, 3]), (4, [0, 0, 0, 0])])\\n    [\\\"Alice\\\", \\\"Bob\\\"]\\n    >>> determine_winner(1, [(5, [0, 0, 0, 0, 0])])\\n    [\\\"Bob\\\"]\\n    >>> determine_winner(1, [(5, [1, 2, 0, 3, 4])])\\n    [\\\"Bob\\\"]\\n    >>> determine_winner(1, [(5, [1, 2, 0, 0, 2])])\\n    [\\\"Alice\\\"]\\n    >>> determine_winner(2, [(1, [1]), (1, [0])])\\n    [\\\"Alice\\\", \\\"Bob\\\"]\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def determine_winner(t, test_cases):\\n    \\\"\\\"\\\"\\n    Determines the winner of the game for each test case.\\n    \\n    Parameters:\\n    t (int): Number of test cases\\n    test_cases (list of tuple): Each tuple contains (n, sequence) where n is the length of the sequence and sequence is the list of integers.\\n    \\n    Returns:\\n    list of str: List of results, \\\"Alice\\\" if Alice wins the game or \\\"Bob\\\" if Bob wins the game for each test case.\\n    \\\"\\\"\\\"\\n    results = []\\n\\n    for n, sequence in test_cases:\\n        non_zero_count = sum(1 for x in sequence if x > 0)\\n        if non_zero_count % 2 == 1:\\n            results.append(\\\"Alice\\\")\\n        else:\\n            results.append(\\\"Bob\\\")\\n    \\n    return results\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_basic_cases():\\n    assert determine_winner(2, [\\n        (3, [1, 2, 3]),\\n        (4, [0, 0, 0, 0])\\n    ]) == [\\\"Alice\\\", \\\"Bob\\\"]\\n\\ndef test_single_element():\\n    assert determine_winner(2, [\\n        (1, [1]),\\n        (1, [0])\\n    ]) == [\\\"Alice\\\", \\\"Bob\\\"]\\n\\ndef test_all_zero_elements():\\n    assert determine_winner(1, [\\n        (5, [0, 0, 0, 0, 0])\\n    ]) == [\\\"Bob\\\"]\\n\\ndef test_even_non_zero_count():\\n    assert determine_winner(1, [\\n        (5, [1, 2, 0, 3, 4])\\n    ]) == [\\\"Bob\\\"]\\n\\ndef test_odd_non_zero_count():\\n    assert determine_winner(1, [\\n        (5, [1, 2, 0, 0, 2])\\n    ]) == [\\\"Alice\\\"]\"}]", "tag": "KodCode"}
{"id": "ac7130f59cd93654b244d2dce68eb3e46c4d2b69a6e1fa43d8c2e743537a7c76", "source": "KodCode", "difficulty": "0.667", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\nfrom typing import List\n\ndef enhanced_gnome_sort(arr: List[int]) -> List[int]:\n    \"\"\"\n    Enhanced version of gnome sort that optimizes performance by using \n    insertion sort principles.\n    \n    Parameters:\n    arr (List[int]): A list of integers to be sorted.\n    \n    Returns:\n    List[int]: The sorted list of integers.\n    \n    Examples:\n    >>> enhanced_gnome_sort([])\n    []\n    >>> enhanced_gnome_sort([3, 2, 1, 4, 5])\n    [1, 2, 3, 4, 5]\n    >>> enhanced_gnome_sort([1, 2, 3, 4, 5])\n    [1, 2, 3, 4, 5]\n    >>> enhanced_gnome_sort([5, 4, 3, 2, 1])\n    [1, 2, 3, 4, 5]\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\nfrom typing import List\\n\\ndef enhanced_gnome_sort(arr: List[int]) -> List[int]:\\n    \\\"\\\"\\\"\\n    Enhanced version of gnome sort that optimizes performance by using \\n    insertion sort principles.\\n    \\n    Parameters:\\n    arr (List[int]): A list of integers to be sorted.\\n    \\n    Returns:\\n    List[int]: The sorted list of integers.\\n    \\n    Examples:\\n    >>> enhanced_gnome_sort([])\\n    []\\n    >>> enhanced_gnome_sort([3, 2, 1, 4, 5])\\n    [1, 2, 3, 4, 5]\\n    >>> enhanced_gnome_sort([1, 2, 3, 4, 5])\\n    [1, 2, 3, 4, 5]\\n    >>> enhanced_gnome_sort([5, 4, 3, 2, 1])\\n    [1, 2, 3, 4, 5]\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"from typing import List\\n\\ndef enhanced_gnome_sort(arr: List[int]) -> List[int]:\\n    \\\"\\\"\\\"\\n    Enhanced version of gnome sort that optimizes performance by using \\n    insertion sort principles.\\n    \\n    Parameters:\\n    arr (List[int]): A list of integers to be sorted.\\n    \\n    Returns:\\n    List[int]: The sorted list of integers.\\n    \\\"\\\"\\\"\\n    n = len(arr)\\n    index = 0\\n    \\n    while index < n:\\n        if index == 0 or arr[index - 1] <= arr[index]:\\n            index += 1\\n        else:\\n            arr[index], arr[index - 1] = arr[index - 1], arr[index]\\n            index -= 1\\n            \\n            # Optimized approach: perform insertion sort step\\n            # to push elements further to the correct position\\n            while index > 0 and arr[index - 1] > arr[index]:\\n                arr[index], arr[index - 1] = arr[index - 1], arr[index]\\n                index -= 1\\n                \\n    return arr\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_empty_list():\\n    assert enhanced_gnome_sort([]) == []\\n\\ndef test_already_sorted():\\n    assert enhanced_gnome_sort([1, 2, 3, 4, 5]) == [1, 2, 3, 4, 5]\\n\\ndef test_reverse_sorted():\\n    assert enhanced_gnome_sort([5, 4, 3, 2, 1]) == [1, 2, 3, 4, 5]\\n\\ndef test_unsorted_list():\\n    assert enhanced_gnome_sort([3, 2, 1, 4, 5]) == [1, 2, 3, 4, 5]\\n\\ndef test_single_element():\\n    assert enhanced_gnome_sort([1]) == [1]\\n\\ndef test_large_numbers():\\n    assert enhanced_gnome_sort([999999999, -999999999, 0]) == [-999999999, 0, 999999999]\\n\\ndef test_duplicates():\\n    assert enhanced_gnome_sort([2, 3, 2, 1, 1]) == [1, 1, 2, 2, 3]\\n\\ndef test_already_sorted_with_duplicates():\\n    assert enhanced_gnome_sort([1, 1, 2, 2, 3, 3]) == [1, 1, 2, 2, 3, 3]\"}]", "tag": "KodCode"}
{"id": "aeb60e2c1bd9680469e9c1c14789de057d2b222526b9ac7bb0fb4fdf94c30ffd", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: A magical forest is populated by n stones placed in a straight line. Each stone contains a certain amount of magical energy, which is used to cast spells. You are a wizard who wants to maximize the total magical energy collected by summoning a magical bird to transfer the energy from the stones to you. However, the magical bird can only fly to stones that form a contiguous subarray.\n\nThe bird can only stop at stones where the cumulative magical energy up to and including that stone (from the start of the subarray) is non-negative at all times. Given this limitation, find the maximum total magical energy you can collect from any valid subarray.\n\nInput\nThe first line contains an integer n (1 ≤ n ≤ 10^5) — the number of stones.\nThe second line contains n integers a1, a2, ..., an (-10^4 ≤ ai ≤ 10^4) — the amount of magical energy in each stone.\n\nOutput\nPrint a single integer — the maximum total magical energy you can collect.\n\nExamples\n\nInput\n5\n3 -2 4 -1 2\n\nOutput\n6\n\nInput\n4\n-1 -2 -3 -4\n\nOutput\n0\n\nNote\nIn the first example, the bird should collect the energy from the subarray [3, -2, 4, -1, 2], which has a total magical energy of 6.\nIn the second example, since all stones have negative energy, the bird can't collect energy from any subarray, resulting in 0 energy collected.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef max_magical_energy(n, stones):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: A magical forest is populated by n stones placed in a straight line. Each stone contains a certain amount of magical energy, which is used to cast spells. You are a wizard who wants to maximize the total magical energy collected by summoning a magical bird to transfer the energy from the stones to you. However, the magical bird can only fly to stones that form a contiguous subarray.\\n\\nThe bird can only stop at stones where the cumulative magical energy up to and including that stone (from the start of the subarray) is non-negative at all times. Given this limitation, find the maximum total magical energy you can collect from any valid subarray.\\n\\nInput\\nThe first line contains an integer n (1 ≤ n ≤ 10^5) — the number of stones.\\nThe second line contains n integers a1, a2, ..., an (-10^4 ≤ ai ≤ 10^4) — the amount of magical energy in each stone.\\n\\nOutput\\nPrint a single integer — the maximum total magical energy you can collect.\\n\\nExamples\\n\\nInput\\n5\\n3 -2 4 -1 2\\n\\nOutput\\n6\\n\\nInput\\n4\\n-1 -2 -3 -4\\n\\nOutput\\n0\\n\\nNote\\nIn the first example, the bird should collect the energy from the subarray [3, -2, 4, -1, 2], which has a total magical energy of 6.\\nIn the second example, since all stones have negative energy, the bird can't collect energy from any subarray, resulting in 0 energy collected.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef max_magical_energy(n, stones):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def max_magical_energy(n, stones):\\n    \\\"\\\"\\\"\\n    Returns the maximum total magical energy that can be collected from any valid subarray.\\n    \\n    Parameters:\\n    n (int): Number of stones.\\n    stones (list): List containing the magical energy of each stone.\\n    \\n    Returns:\\n    int: The maximum total magical energy.\\n    \\\"\\\"\\\"\\n    max_energy = 0\\n    current_energy = 0\\n    \\n    for energy in stones:\\n        current_energy += energy\\n        if current_energy < 0:\\n            current_energy = 0\\n        max_energy = max(max_energy, current_energy)\\n    \\n    return max_energy\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_max_magical_energy_example_1():\\n    assert max_magical_energy(5, [3, -2, 4, -1, 2]) == 6\\n\\ndef test_max_magical_energy_example_2():\\n    assert max_magical_energy(4, [-1, -2, -3, -4]) == 0\\n\\ndef test_max_magical_energy_all_non_negative():\\n    assert max_magical_energy(5, [1, 2, 3, 4, 5]) == 15\\n\\ndef test_max_magical_energy_mix():\\n    assert max_magical_energy(6, [-1, 2, -3, 4, -2, 5]) == 7\\n\\ndef test_max_magical_energy_negative_on_start():\\n    assert max_magical_energy(6, [-4, -1, 2, 3, -2, 1]) == 5\\n\\ndef test_max_magical_energy_all_zeros():\\n    assert max_magical_energy(5, [0, 0, 0, 0, 0]) == 0\\n\\ndef test_max_magical_energy_large_input():\\n    n = 10**5\\n    stones = [1] * n\\n    assert max_magical_energy(n, stones) == 100000\"}]", "tag": "KodCode"}
{"id": "b99534d02884924168587f20d0942277684adda0aae7b67ad0bbc0e52e7dced9", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Import python packages to create a CUDA kernel that calculates the square of a number.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\nsquare_array[blocks_per_grid, threads_per_block](d_out, d_in)\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Import python packages to create a CUDA kernel that calculates the square of a number.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\nsquare_array[blocks_per_grid, threads_per_block](d_out, d_in)\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"import numpy as np\\nfrom numba import cuda\\n\\n@cuda.jit\\ndef square_array(d_out, d_in):\\n    idx = cuda.grid(1)\\n    if idx < d_in.size:\\n        d_out[idx] = d_in[idx] ** 2\\n\\ndef calculate_square(input_array):\\n    n = input_array.size\\n    d_in = cuda.to_device(input_array)\\n    d_out = cuda.device_array(n)\\n    \\n    threads_per_block = 256\\n    blocks_per_grid = (n + threads_per_block - 1) // threads_per_block\\n    \\n    square_array[blocks_per_grid, threads_per_block](d_out, d_in)\\n    \\n    return d_out.copy_to_host()\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\nimport numpy as np\\n\\ndef test_calculate_square_positive_numbers():\\n    input_array = np.array([1, 2, 3, 4, 5], dtype=np.float32)\\n    result = calculate_square(input_array)\\n    expected = np.array([1, 4, 9, 16, 25], dtype=np.float32)\\n    assert np.allclose(result, expected)\\n\\ndef test_calculate_square_negative_numbers():\\n    input_array = np.array([-1, -2, -3, -4, -5], dtype=np.float32)\\n    result = calculate_square(input_array)\\n    expected = np.array([1, 4, 9, 16, 25], dtype=np.float32)\\n    assert np.allclose(result, expected)\\n\\ndef test_calculate_square_zeros():\\n    input_array = np.array([0, 0, 0, 0, 0], dtype=np.float32)\\n    result = calculate_square(input_array)\\n    expected = np.array([0, 0, 0, 0, 0], dtype=np.float32)\\n    assert np.allclose(result, expected)\\n\\ndef test_calculate_square_mixed_numbers():\\n    input_array = np.array([1, -2, 3, -4, 5], dtype=np.float32)\\n    result = calculate_square(input_array)\\n    expected = np.array([1, 4, 9, 16, 25], dtype=np.float32)\\n    assert np.allclose(result, expected)\"}]", "tag": "KodCode"}
{"id": "70300d70d7a8496a0ee28e258a5041e032b308a0922aaf968e5943dbe46ff028", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: ### Sentence Segmentation Using a Dictionary\n\n**Objective**: Given a string and a dictionary of valid words, implement a function to count how many possible sentences can be formed from the string. Each word in the sentence must be contained in the dictionary.\n\n### Function Specification\n\n```python\ndef count_sentences(s: str, dictionary: set) -> int:\n    # Your implementation here\n    pass\n```\n\n### Input\n* `s`: A string containing the source text without spaces (1 ≤ |s| ≤ 50).\n* `dictionary`: A set containing valid dictionary words (0 ≤ |dictionary| ≤ 1000).\n\n### Output\nThe function should return an integer representing the number of different possible sentences that can be formed.\n\n### Constraints\n* Each word in the resulting sentence must be in the given dictionary.\n* It's not guaranteed that all characters of the input string can be used to form valid sentences.\n\n### Examples\n\n1. `s = \"appletablet\", dictionary = {\"apple\", \"tablet\", \"applet\", \"apple\", \"table\", \"t\"}` \n    - Output: 4 (`\"appletablet\"`, `\"apple table t\"`, `\"applet ablet\"`, `\"apple t able t\"`)\n    \n2. `s = \"thing\", dictionary = {\"thing\"}` \n    - Output: 1 (`\"thing\"`)\n\n### Requirements\n- Implement the function to traverse all possible segmentations of the given string.\n- Ensure that repeated computations are avoided through optimization strategies like memoization.\n\n### Scenario\nImagine you are helping to develop an auto-correct feature that suggests ways to split a concatenated string into meaningful phrases based on a dictionary. Your solution will help in identifying and counting all possible meaningful sentences.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef count_sentences(s: str, dictionary: set) -> int:\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: ### Sentence Segmentation Using a Dictionary\\n\\n**Objective**: Given a string and a dictionary of valid words, implement a function to count how many possible sentences can be formed from the string. Each word in the sentence must be contained in the dictionary.\\n\\n### Function Specification\\n\\n```python\\ndef count_sentences(s: str, dictionary: set) -> int:\\n    # Your implementation here\\n    pass\\n```\\n\\n### Input\\n* `s`: A string containing the source text without spaces (1 ≤ |s| ≤ 50).\\n* `dictionary`: A set containing valid dictionary words (0 ≤ |dictionary| ≤ 1000).\\n\\n### Output\\nThe function should return an integer representing the number of different possible sentences that can be formed.\\n\\n### Constraints\\n* Each word in the resulting sentence must be in the given dictionary.\\n* It's not guaranteed that all characters of the input string can be used to form valid sentences.\\n\\n### Examples\\n\\n1. `s = \\\"appletablet\\\", dictionary = {\\\"apple\\\", \\\"tablet\\\", \\\"applet\\\", \\\"apple\\\", \\\"table\\\", \\\"t\\\"}` \\n    - Output: 4 (`\\\"appletablet\\\"`, `\\\"apple table t\\\"`, `\\\"applet ablet\\\"`, `\\\"apple t able t\\\"`)\\n    \\n2. `s = \\\"thing\\\", dictionary = {\\\"thing\\\"}` \\n    - Output: 1 (`\\\"thing\\\"`)\\n\\n### Requirements\\n- Implement the function to traverse all possible segmentations of the given string.\\n- Ensure that repeated computations are avoided through optimization strategies like memoization.\\n\\n### Scenario\\nImagine you are helping to develop an auto-correct feature that suggests ways to split a concatenated string into meaningful phrases based on a dictionary. Your solution will help in identifying and counting all possible meaningful sentences.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef count_sentences(s: str, dictionary: set) -> int:\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def count_sentences(s: str, dictionary: set) -> int:\\n    memo = {}\\n\\n    def dfs(start):\\n        if start == len(s):\\n            return 1\\n        if start in memo:\\n            return memo[start]\\n        \\n        count = 0\\n        for end in range(start + 1, len(s) + 1):\\n            if s[start:end] in dictionary:\\n                count += dfs(end)\\n        \\n        memo[start] = count\\n        return count\\n\\n    return dfs(0)\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_single_word_no_split():\\n    assert count_sentences(\\\"thing\\\", {\\\"thing\\\"}) == 1\\n\\ndef test_two_words():\\n    assert count_sentences(\\\"appletablet\\\", {\\\"apple\\\", \\\"tablet\\\"}) == 1\\n\\ndef test_multiple_segments():\\n    assert count_sentences(\\\"appletablet\\\", {\\\"apple\\\", \\\"tablet\\\", \\\"a\\\", \\\"p\\\", \\\"ple\\\", \\\"tab\\\", \\\"let\\\"}) >= 4\\n\\ndef test_empty_string():\\n    assert count_sentences(\\\"\\\", {\\\"a\\\", \\\"b\\\"}) == 1\\n\\ndef test_no_valid_segment():\\n    assert count_sentences(\\\"abcd\\\", {\\\"a\\\", \\\"ab\\\", \\\"abc\\\"}) == 0\\n\\ndef test_repeated_words():\\n    assert count_sentences(\\\"appleapple\\\", {\\\"apple\\\"}) == 1\\n\\ndef test_multiple_sentences():\\n    assert count_sentences(\\\"appletable\\\", {\\\"apple\\\", \\\"table\\\", \\\"tab\\\", \\\"le\\\", \\\"a\\\", \\\"pp\\\", \\\"let\\\", \\\"t\\\", \\\"able\\\"}) > 4\\n\\ndef test_large_input():\\n    s = \\\"a\\\" * 50\\n    dictionary = {\\\"a\\\" * i for i in range(1, 51)}\\n    assert count_sentences(s, dictionary) > 0\"}]", "tag": "KodCode"}
{"id": "1befc0c50934acac73b9587ca2c7b7aeea2fc13c401c3c1b7345e2ddc850511f", "source": "KodCode", "difficulty": "0.8", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\ndef trap(height: List[int]) -> int:\n    \"\"\" \n    Calculate how much water it can trap after raining.\n\n    :param height: List[int], list of non-negative integers representing the heights of the bars.\n    :return: int, total amount of trapped water.\n\n    >>> trap([0,1,0,2,1,0,1,3,2,1,2,1])\n    6\n    >>> trap([])\n    0\n    >>> trap([1, 1, 1, 1])\n    0\n    >>> trap([2, 2, 2, 2])\n    0\n    >>> trap([0,2,0,2])\n    2\n    >>> trap([3, 0, 0, 0, 3])\n    9\n    >>> trap([5, 4, 3, 2, 1])\n    0\n    >>> trap([4, 2, 0, 3, 2, 5])\n    9\n    \"\"\"", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\ndef trap(height: List[int]) -> int:\\n    \\\"\\\"\\\" \\n    Calculate how much water it can trap after raining.\\n\\n    :param height: List[int], list of non-negative integers representing the heights of the bars.\\n    :return: int, total amount of trapped water.\\n\\n    >>> trap([0,1,0,2,1,0,1,3,2,1,2,1])\\n    6\\n    >>> trap([])\\n    0\\n    >>> trap([1, 1, 1, 1])\\n    0\\n    >>> trap([2, 2, 2, 2])\\n    0\\n    >>> trap([0,2,0,2])\\n    2\\n    >>> trap([3, 0, 0, 0, 3])\\n    9\\n    >>> trap([5, 4, 3, 2, 1])\\n    0\\n    >>> trap([4, 2, 0, 3, 2, 5])\\n    9\\n    \\\"\\\"\\\"\"}]", "ground_truth": "[\"def trap(height):\\n    \\\"\\\"\\\"\\n    Calculate how much water it can trap after raining.\\n    \\n    :param height: List[int], list of non-negative integers representing the heights of the bars.\\n    :return: int, total amount of trapped water.\\n    \\\"\\\"\\\"\\n    if not height or len(height) < 3:\\n        return 0\\n\\n    n = len(height)\\n    left_max = [0] * n\\n    right_max = [0] * n\\n\\n    left_max[0] = height[0]\\n    for i in range(1, n):\\n        left_max[i] = max(left_max[i - 1], height[i])\\n\\n    right_max[n - 1] = height[n - 1]\\n    for i in range(n - 2, -1, -1):\\n        right_max[i] = max(right_max[i + 1], height[i])\\n\\n    water_trapped = 0\\n    for i in range(n):\\n        water_trapped += min(left_max[i], right_max[i]) - height[i]\\n\\n    return water_trapped\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_trap_example():\\n    height = [0, 1, 0, 2, 1, 0, 1, 3, 2, 1, 2, 1]\\n    assert trap(height) == 6\\n\\ndef test_trap_empty():\\n    height = []\\n    assert trap(height) == 0\\n\\ndef test_trap_no_possible_trapping():\\n    height = [1, 1, 1, 1]\\n    assert trap(height) == 0\\n\\ndef test_trap_flat_surface():\\n    height = [2, 2, 2, 2]\\n    assert trap(height) == 0\\n\\ndef test_trap_small_elevation():\\n    height = [0, 2, 0, 2]\\n    assert trap(height) == 2\\n\\ndef test_trap_peak_at_ends():\\n    height = [3, 0, 0, 0, 3]\\n    assert trap(height) == 9\\n\\ndef test_trap_decreasing_steps():\\n    height = [5, 4, 3, 2, 1]\\n    assert trap(height) == 0\\n\\ndef test_trap_varied_heights():\\n    height = [4, 2, 0, 3, 2, 5]\\n    assert trap(height) == 9\"}]", "tag": "KodCode"}
{"id": "3ba9db0e27b278f36f60894f35f8bc0abb1809cdaab74f4e08f3bb7bccb4646a", "source": "KodCode", "difficulty": "0.667", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: In a forest, there is a network of interconnected trees represented as a graph. Each tree is a node, and each connection between trees is an undirected edge. Your task is to determine if it is possible to color each tree in such a way that no two connected trees share the same color, using exactly 2 colors. If it is possible, print the two groups of tree indices for each color. If it is not possible, print -1.\n\n-----Input-----\n\nThe first line of input contains two integers $n$ and $m$ ($1 \\le n \\le 10^5$, $0 \\le m \\le 10^5$), where $n$ denotes the number of trees (nodes) and $m$ denotes the number of connections (edges).\n\nThe next $m$ lines contain two integers $u_i$ and $v_i$ ($1 \\le u_i, v_i \\le n$), denoting an undirected edge between trees $u_i$ and $v_i$.\n\n-----Output-----\n\nIf it is possible to color the trees as described, print two lines. The first line contains the indices of all trees colored with the first color, separated by spaces. The second line contains the indices of all trees colored with the second color, separated by spaces.\n\nIf it is not possible, print -1.\n\n-----Examples-----\n\nInput:\n5 4\n1 2\n1 3\n2 4\n3 5\nOutput:\n1 4 5\n2 3\n\nInput:\n3 3\n1 2\n2 3\n3 1\nOutput:\n-1\n\n-----Note-----\n\nIn the first example, one possible valid coloring is to assign color 1 to trees 1, 4, and 5, and color 2 to trees 2 and 3. There is no conflict because no two adjacent trees share the same color.\n\nIn the second example, the three trees form a cycle of length 3, making it impossible to color them with exactly 2 colors without having two connected trees share the same color. Therefore, the output is -1.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\nall_group1, all_group2 = set(), set()\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: In a forest, there is a network of interconnected trees represented as a graph. Each tree is a node, and each connection between trees is an undirected edge. Your task is to determine if it is possible to color each tree in such a way that no two connected trees share the same color, using exactly 2 colors. If it is possible, print the two groups of tree indices for each color. If it is not possible, print -1.\\n\\n-----Input-----\\n\\nThe first line of input contains two integers $n$ and $m$ ($1 \\\\le n \\\\le 10^5$, $0 \\\\le m \\\\le 10^5$), where $n$ denotes the number of trees (nodes) and $m$ denotes the number of connections (edges).\\n\\nThe next $m$ lines contain two integers $u_i$ and $v_i$ ($1 \\\\le u_i, v_i \\\\le n$), denoting an undirected edge between trees $u_i$ and $v_i$.\\n\\n-----Output-----\\n\\nIf it is possible to color the trees as described, print two lines. The first line contains the indices of all trees colored with the first color, separated by spaces. The second line contains the indices of all trees colored with the second color, separated by spaces.\\n\\nIf it is not possible, print -1.\\n\\n-----Examples-----\\n\\nInput:\\n5 4\\n1 2\\n1 3\\n2 4\\n3 5\\nOutput:\\n1 4 5\\n2 3\\n\\nInput:\\n3 3\\n1 2\\n2 3\\n3 1\\nOutput:\\n-1\\n\\n-----Note-----\\n\\nIn the first example, one possible valid coloring is to assign color 1 to trees 1, 4, and 5, and color 2 to trees 2 and 3. There is no conflict because no two adjacent trees share the same color.\\n\\nIn the second example, the three trees form a cycle of length 3, making it impossible to color them with exactly 2 colors without having two connected trees share the same color. Therefore, the output is -1.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\nall_group1, all_group2 = set(), set()\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"from collections import defaultdict, deque\\n\\ndef can_color_trees(n, m, edges):\\n    def bfs(start):\\n        queue = deque([start])\\n        colors[start] = 0\\n        group1, group2 = set([start+1]), set()\\n\\n        while queue:\\n            node = queue.popleft()\\n            curr_color = colors[node]\\n\\n            for neighbor in graph[node]:\\n                if neighbor not in colors:\\n                    colors[neighbor] = 1 - curr_color\\n                    if colors[neighbor] == 0:\\n                        group1.add(neighbor + 1)\\n                    else:\\n                        group2.add(neighbor + 1)\\n                    queue.append(neighbor)\\n                elif colors[neighbor] == curr_color:\\n                    return -1, -1\\n\\n        return group1, group2\\n\\n    graph = defaultdict(list)\\n    for u, v in edges:\\n        graph[u-1].append(v-1)\\n        graph[v-1].append(u-1)\\n\\n    colors = {}\\n    all_group1, all_group2 = set(), set()\\n    for node in range(n):\\n        if node not in colors:\\n            group1, group2 = bfs(node)\\n            if group1 == -1:\\n                return -1\\n            all_group1.update(group1)\\n            all_group2.update(group2)\\n\\n    return list(all_group1), list(all_group2)\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_example1():\\n    n = 5\\n    m = 4\\n    edges = [(1, 2), (1, 3), (2, 4), (3, 5)]\\n    group1, group2 = can_color_trees(n, m, edges)\\n    assert set(group1) == {1, 4, 5}\\n    assert set(group2) == {2, 3}\\n\\ndef test_example2():\\n    n = 3\\n    m = 3\\n    edges = [(1, 2), (2, 3), (3, 1)]\\n    result = can_color_trees(n, m, edges)\\n    assert result == -1\\n\\ndef test_single_tree():\\n    n = 1\\n    m = 0\\n    edges = []\\n    group1, group2 = can_color_trees(n, m, edges)\\n    assert group1 == [1]\\n    assert group2 == []\\n\\ndef test_disconnected_graph():\\n    n = 4\\n    m = 2\\n    edges = [(1, 2), (3, 4)]\\n    group1, group2 = can_color_trees(n, m, edges)\\n    assert set(group1) == {1, 3}\\n    assert set(group2) == {2, 4}\\n\\ndef test_all_disconnected_nodes():\\n    n = 5\\n    m = 0\\n    edges = []\\n    group1, group2 = can_color_trees(n, m, edges)\\n    assert set(group1) == set(range(1, 6))\\n    assert group2 == []\\n\\ndef test_large_graph_impossible():\\n    n = 5\\n    m = 5\\n    edges = [(1, 2), (2, 3), (3, 4), (4, 5), (5, 1)]\\n    result = can_color_trees(n, m, edges)\\n    assert result == -1\"}]", "tag": "KodCode"}
{"id": "98534e9e3cd023f689e5aac2eaae6a7e353b580dff1ab1354097a1b9f4f68121", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Write a Python function that takes a list of integers and returns a new list containing only the elements that appear exactly twice in the original list. The order of the elements in the returned list should be the same as their first occurrence in the original list. For example, given the list `[1, 2, 2, 3, 3, 3, 4, 4, 5]`, the function should return `[2, 4]` because these are the elements that appear exactly twice.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef elements_appearing_twice(lst):\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Write a Python function that takes a list of integers and returns a new list containing only the elements that appear exactly twice in the original list. The order of the elements in the returned list should be the same as their first occurrence in the original list. For example, given the list `[1, 2, 2, 3, 3, 3, 4, 4, 5]`, the function should return `[2, 4]` because these are the elements that appear exactly twice.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef elements_appearing_twice(lst):\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def elements_appearing_twice(lst):\\n    \\\"\\\"\\\"\\n    Returns a list of elements that appear exactly twice in the input list.\\n    \\\"\\\"\\\"\\n    from collections import Counter\\n    count = Counter(lst)\\n    result = [item for item in lst if count[item] == 2]\\n    # Use a set to keep track of elements already added to avoid duplicates\\n    seen = set()\\n    final_result = []\\n    for item in result:\\n        if item not in seen:\\n            final_result.append(item)\\n            seen.add(item)\\n    return final_result\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_elements_appearing_twice():\\n    assert elements_appearing_twice([1, 2, 2, 3, 3, 3, 4, 4, 5]) == [2, 4]\\n    assert elements_appearing_twice([1, 1, 2, 3, 4, 4, 5, 5, 6]) == [1, 4, 5]\\n    assert elements_appearing_twice([1, 2, 3, 4, 5]) == []\\n    assert elements_appearing_twice([1, 1, 1, 2, 2, 3, 3, 4, 5, 6, 6]) == [2, 3, 6]\\n    assert elements_appearing_twice([5, 5, 1, 1, 2, 3, 4, 4, 6, 6]) == [5, 1, 4, 6]\\n    assert elements_appearing_twice([]) == []\\n    assert elements_appearing_twice([1]) == []\\n    assert elements_appearing_twice([1, 1]) == [1]\"}]", "tag": "KodCode"}
{"id": "8b3c02afbd27c1b83e9d59d303db0c04a8627ae25d74032f8fd0db2ed80266d1", "source": "KodCode", "difficulty": "0.333", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: Consider a grid of size `N x N` comprising only '.' (dots) and '#' (hashes). Each line in the grid corresponds to a row and contains exactly `N` characters. Your task is to find out the largest square filled with only '.' characters in the grid, and determine its side length.\n\nInput\nThe first line contains an integer `T`, the number of test cases. Each test case consists of two parts:\n1. An integer `N` — the size of the grid.\n2. `N` lines of `N` characters containing '.' and number signs ('#').\n\nOutput\nFor each test case, output a single integer in a new line indicating the side length of the largest square filled with '.' characters in the grid.\n\nConstraints\n1 <= T <= 100\n1 <= N <= 50\n\nExample\nInput:\n2\n3\n...\n..#\n###\n4\n..#.\n..#.\n....\n####\n\nOutput:\n2\n2\n\nNote:\n- In the first test case, the largest square filled with '.' characters is of size 2x2.\n- In the second test case, the largest square filled with '.' characters is also of size 2x2.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\nprint(largest_square_in_grid(T, test_cases))  # Output: [2, 2]\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: Consider a grid of size `N x N` comprising only '.' (dots) and '#' (hashes). Each line in the grid corresponds to a row and contains exactly `N` characters. Your task is to find out the largest square filled with only '.' characters in the grid, and determine its side length.\\n\\nInput\\nThe first line contains an integer `T`, the number of test cases. Each test case consists of two parts:\\n1. An integer `N` — the size of the grid.\\n2. `N` lines of `N` characters containing '.' and number signs ('#').\\n\\nOutput\\nFor each test case, output a single integer in a new line indicating the side length of the largest square filled with '.' characters in the grid.\\n\\nConstraints\\n1 <= T <= 100\\n1 <= N <= 50\\n\\nExample\\nInput:\\n2\\n3\\n...\\n..#\\n###\\n4\\n..#.\\n..#.\\n....\\n####\\n\\nOutput:\\n2\\n2\\n\\nNote:\\n- In the first test case, the largest square filled with '.' characters is of size 2x2.\\n- In the second test case, the largest square filled with '.' characters is also of size 2x2.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\nprint(largest_square_in_grid(T, test_cases))  # Output: [2, 2]\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def largest_square_in_grid(T, test_cases):\\n    results = []\\n\\n    for case in test_cases:\\n        N, grid = case\\n        max_side_length = 0\\n        dp = [[0] * N for _ in range(N)]\\n        \\n        for i in range(N):\\n            for j in range(N):\\n                if grid[i][j] == '.':\\n                    if i == 0 or j == 0:\\n                        dp[i][j] = 1\\n                    else:\\n                        dp[i][j] = min(dp[i-1][j], dp[i][j-1], dp[i-1][j-1]) + 1\\n                    max_side_length = max(max_side_length, dp[i][j])\\n\\n        results.append(max_side_length)\\n    \\n    return results\\n\\n# Example usage\\nT = 2\\ntest_cases = [\\n    (3, [\\\"...\\\", \\\"..#\\\", \\\"###\\\"]),\\n    (4, [\\\"..#.\\\", \\\"..#.\\\", \\\"....\\\", \\\"####\\\"])\\n]\\nprint(largest_square_in_grid(T, test_cases))  # Output: [2, 2]\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_single_cell_grid():\\n    assert largest_square_in_grid(1, [(1, [\\\".\\\"])]) == [1]\\n    assert largest_square_in_grid(1, [(1, [\\\"#\\\"])]) == [0]\\n\\ndef test_all_dots_grid():\\n    assert largest_square_in_grid(1, [(3, [\\\"...\\\", \\\"...\\\", \\\"...\\\"])]) == [3]\\n\\ndef test_all_hashes_grid():\\n    assert largest_square_in_grid(1, [(4, [\\\"####\\\", \\\"####\\\", \\\"####\\\", \\\"####\\\"])]) == [0]\\n\\ndef test_mixed_grid_with_single_max_square():\\n    assert largest_square_in_grid(1, [(3, [\\\"...\\\", \\\"..#\\\", \\\"###\\\"])]) == [2]\\n    \\ndef test_mixed_grid_with_multiple_max_squares():\\n    assert largest_square_in_grid(1, [(4, [\\\"..#.\\\", \\\"..#.\\\", \\\"....\\\", \\\"####\\\"])]) == [2]\\n\\ndef test_t_shape():\\n    assert largest_square_in_grid(1, [(5, [\\n        \\\".....\\\",\\n        \\\".###.\\\",\\n        \\\".#.#.\\\",\\n        \\\".###.\\\",\\n        \\\".....\\\"\\n    ])]) == [1]\\n\\ndef test_grid_with_largest_square_in_corner():\\n    assert largest_square_in_grid(1, [(5, [\\n        \\\"#####\\\",\\n        \\\"#....\\\",\\n        \\\"#....\\\",\\n        \\\"#....\\\",\\n        \\\"#####\\\"\\n    ])]) == [3]\\n\\ndef test_multiple_test_cases():\\n    assert largest_square_in_grid(2, [\\n        (3, [\\\"...\\\", \\\"..#\\\", \\\"###\\\"]),\\n        (4, [\\\"..#.\\\", \\\"..#.\\\", \\\"....\\\", \\\"####\\\"])\\n    ]) == [2, 2]\"}]", "tag": "KodCode"}
{"id": "1d47516854aaa4d0f9f88f6ce4badb4cd736e0899f69d4e41f341cfb99ca052f", "source": "KodCode", "difficulty": "0.667", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\nfrom typing import List\n\ndef find_closest_volume(target: int, containers: List[int]) -> int:\n    \"\"\" \n    Helene the Husky Chef is preparing her famous soup recipe, which requires a specific target volume of mushrooms. \n    She has several containers of mushrooms, each with a different volume in liters. Helene needs to select containers such that their combined volume is as close as possible to the target volume.\n    In case there are two combined volumes equally close to the target volume, Helene will choose the greater one.\n    \n    Args: \n        target (int): The target volume in liters.\n        containers (List[int]): A list of integers where each represents the volume of a container.\n    \n    Returns: \n        int: The combined volume of selected containers closest to the target volume.\n        \n    Examples:\n    >>> find_closest_volume(1500, [500, 600, 700, 800, 300])\n    1500\n    >>> find_closest_volume(2000, [500, 600, 700, 800, 300])\n    2000\n    >>> find_closest_volume(1000, [500, 600, 700, 300])\n    1000\n    >>> find_closest_volume(600, [900, 100, 500])\n    600\n    >>> find_closest_volume(5000, [1000, 2000])\n    3000\n    >>> find_closest_volume(3000, [700, 800, 900, 1000, 1200])\n    3000\n    \"\"\"\n    pass", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\nfrom typing import List\\n\\ndef find_closest_volume(target: int, containers: List[int]) -> int:\\n    \\\"\\\"\\\" \\n    Helene the Husky Chef is preparing her famous soup recipe, which requires a specific target volume of mushrooms. \\n    She has several containers of mushrooms, each with a different volume in liters. Helene needs to select containers such that their combined volume is as close as possible to the target volume.\\n    In case there are two combined volumes equally close to the target volume, Helene will choose the greater one.\\n    \\n    Args: \\n        target (int): The target volume in liters.\\n        containers (List[int]): A list of integers where each represents the volume of a container.\\n    \\n    Returns: \\n        int: The combined volume of selected containers closest to the target volume.\\n        \\n    Examples:\\n    >>> find_closest_volume(1500, [500, 600, 700, 800, 300])\\n    1500\\n    >>> find_closest_volume(2000, [500, 600, 700, 800, 300])\\n    2000\\n    >>> find_closest_volume(1000, [500, 600, 700, 300])\\n    1000\\n    >>> find_closest_volume(600, [900, 100, 500])\\n    600\\n    >>> find_closest_volume(5000, [1000, 2000])\\n    3000\\n    >>> find_closest_volume(3000, [700, 800, 900, 1000, 1200])\\n    3000\\n    \\\"\\\"\\\"\\n    pass\"}]", "ground_truth": "[\"from itertools import combinations\\n\\ndef find_closest_volume(target, containers):\\n    n = len(containers)\\n    closest_volume = 0\\n    minimal_difference = float('inf')\\n    \\n    for i in range(1, n + 1):\\n        for combo in combinations(containers, i):\\n            current_volume = sum(combo)\\n            current_difference = abs(current_volume - target)\\n            \\n            if (current_difference < minimal_difference) or (current_difference == minimal_difference and current_volume > closest_volume):\\n                closest_volume = current_volume\\n                minimal_difference = current_difference\\n    \\n    return closest_volume\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_exact_match():\\n    assert find_closest_volume(1500, [500, 600, 700, 800, 300]) == 1500\\n\\ndef test_less_than_target():\\n    assert find_closest_volume(2000, [500, 600, 700, 800, 300]) == 2000\\n\\ndef test_more_than_target():\\n    assert find_closest_volume(1000, [500, 600, 700, 300]) == 1000\\n\\ndef test_combination_choices():\\n    assert find_closest_volume(600, [900, 100, 500]) == 600\\n\\ndef test_target_greater_than_sum():\\n    assert find_closest_volume(5000, [1000, 2000]) == 3000\\n\\ndef test_larger_combinations():\\n    assert find_closest_volume(3000, [700, 800, 900, 1000, 1200]) == 3000\"}]", "tag": "KodCode"}
{"id": "8820cad2baf65d49a834f90e3d3ed8de410e3db9d181adfd294f0b88b3f932e9", "source": "KodCode", "difficulty": "0.4", "prompt": "You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \n\n### Question: You are required to write a Python function named `find_nearest_palindrome` that, given an integer, finds the nearest palindrome number.\n\nThe function should:\n\n1. Accept an integer as input.\n2. Determine the nearest integer palindrome to the given input. If there are two palindrome numbers at the same distance, return the smaller one.\n3. Return the nearest palindrome as an integer.\n\nInput:\n- `num` (int): The input integer.\n\nOutput:\n- (int): The nearest palindrome number.\n\n**Function Signature:**\n\n```python\ndef find_nearest_palindrome(num: int) -> int:\n    pass\n```\n\n**Example Usage:**\n\n```python\nprint(find_nearest_palindrome(123))\n```\n\nThis should return `121` as it is the nearest palindrome to 123.\n\n**Example Usage:**\n\n```python\nprint(find_nearest_palindrome(100))\n```\n\nThis should return `99` as it is the nearest palindrome to 100.\n\n[Hint] You may need to write a helper function to check if a number is a palindrome and another helper function to generate the next palindrome candidate.\n\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\n```python\ndef find_nearest_palindrome(num: int) -> int:\n```\n\n### Answer: (use the provided format with backticks)", "messages": "[{\"role\": \"user\", \"content\": \"You are an expert Python programmer. You will be given a question (problem specification) and will generate a correct Python program that matches the specification and passes all tests. \\n\\n### Question: You are required to write a Python function named `find_nearest_palindrome` that, given an integer, finds the nearest palindrome number.\\n\\nThe function should:\\n\\n1. Accept an integer as input.\\n2. Determine the nearest integer palindrome to the given input. If there are two palindrome numbers at the same distance, return the smaller one.\\n3. Return the nearest palindrome as an integer.\\n\\nInput:\\n- `num` (int): The input integer.\\n\\nOutput:\\n- (int): The nearest palindrome number.\\n\\n**Function Signature:**\\n\\n```python\\ndef find_nearest_palindrome(num: int) -> int:\\n    pass\\n```\\n\\n**Example Usage:**\\n\\n```python\\nprint(find_nearest_palindrome(123))\\n```\\n\\nThis should return `121` as it is the nearest palindrome to 123.\\n\\n**Example Usage:**\\n\\n```python\\nprint(find_nearest_palindrome(100))\\n```\\n\\nThis should return `99` as it is the nearest palindrome to 100.\\n\\n[Hint] You may need to write a helper function to check if a number is a palindrome and another helper function to generate the next palindrome candidate.\\n\\n### Format: You will use the following starter code to write the solution to the problem and enclose your code within delimiters.\\n```python\\ndef find_nearest_palindrome(num: int) -> int:\\n```\\n\\n### Answer: (use the provided format with backticks)\"}]", "ground_truth": "[\"def is_palindrome(x: int) -> bool:\\n    s = str(x)\\n    return s == s[::-1]\\n\\ndef find_nearest_palindrome(num: int) -> int:\\n    if num < 0:\\n        raise ValueError(\\\"Input number must be non-negative\\\")\\n\\n    if is_palindrome(num):\\n        return num\\n\\n    lower_palindrome = num - 1\\n    upper_palindrome = num + 1\\n\\n    while not is_palindrome(lower_palindrome):\\n        lower_palindrome -= 1\\n\\n    while not is_palindrome(upper_palindrome):\\n        upper_palindrome += 1\\n\\n    if num - lower_palindrome <= upper_palindrome - num:\\n        return lower_palindrome\\n    else:\\n        return upper_palindrome\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_find_nearest_palindrome_lower():\\n    assert find_nearest_palindrome(123) == 121\\n\\ndef test_find_nearest_palindrome_upper():\\n    assert find_nearest_palindrome(130) == 131\\n\\ndef test_find_nearest_palindrome_equal_distance():\\n    assert find_nearest_palindrome(129) == 131  # Assuming return smaller as per question would choose 131 over 121\\n\\ndef test_find_nearest_palindrome_exact():\\n    assert find_nearest_palindrome(121) == 121\\n\\ndef test_find_nearest_palindrome_single_digit():\\n    assert find_nearest_palindrome(5) == 5\\n\\ndef test_find_nearest_palindrome_large_number():\\n    assert find_nearest_palindrome(10000) == 9999\\n\\ndef test_find_nearest_palindrome_negative():\\n    try:\\n        find_nearest_palindrome(-123)\\n    except ValueError:\\n        assert True\\n    else:\\n        assert False\"}]", "tag": "KodCode"}
{"id": "0ee15cf90d32fb2a429194f539086b1a71aedc7ebf17bf6774176047882eee9e", "source": "KodCode", "difficulty": "0.333", "prompt": "Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\nfrom collections import defaultdict\n\ndef longest_route(m, edges):\n    \"\"\"\n    Finds the length of the longest route in a directed graph.\n    \n    Args:\n    m (int): Number of directed paths.\n    edges (list of tuples): Each tuple contains two integers (u, v) representing the directed path from u to v.\n    \n    Returns:\n    int: Length of the longest route.\n    \"\"\"\n\ndef test_simple_case():\n    assert longest_route(3, [(1, 2), (2, 3), (3, 4)]) == 3\n\ndef test_single_path():\n    assert longest_route(1, [(1, 2)]) == 1\n\ndef test_cyclic_path():\n    assert longest_route(3, [(1, 2), (2, 3), (3, 1)]) == 2\n\ndef test_multiple_paths():\n    assert longest_route(5, [(1, 2), (1, 3), (2, 4), (3, 4), (4, 5)]) == 3\n\ndef test_no_path():\n    assert longest_route(0, []) == 0\n\ndef test_disconnected_graph():\n    assert longest_route(4, [(1, 2), (3, 4), (5, 6), (7, 8)]) == 1\n\ndef test_large_number_of_paths():\n    edges = [(i, i + 1) for i in range(1, 100)]\n    assert longest_route(99, edges) == 99", "messages": "[{\"role\": \"user\", \"content\": \"Read the following function signature and docstring, and fully implement the function described. Your response should only contain the code for this function.\\nfrom collections import defaultdict\\n\\ndef longest_route(m, edges):\\n    \\\"\\\"\\\"\\n    Finds the length of the longest route in a directed graph.\\n    \\n    Args:\\n    m (int): Number of directed paths.\\n    edges (list of tuples): Each tuple contains two integers (u, v) representing the directed path from u to v.\\n    \\n    Returns:\\n    int: Length of the longest route.\\n    \\\"\\\"\\\"\\n\\ndef test_simple_case():\\n    assert longest_route(3, [(1, 2), (2, 3), (3, 4)]) == 3\\n\\ndef test_single_path():\\n    assert longest_route(1, [(1, 2)]) == 1\\n\\ndef test_cyclic_path():\\n    assert longest_route(3, [(1, 2), (2, 3), (3, 1)]) == 2\\n\\ndef test_multiple_paths():\\n    assert longest_route(5, [(1, 2), (1, 3), (2, 4), (3, 4), (4, 5)]) == 3\\n\\ndef test_no_path():\\n    assert longest_route(0, []) == 0\\n\\ndef test_disconnected_graph():\\n    assert longest_route(4, [(1, 2), (3, 4), (5, 6), (7, 8)]) == 1\\n\\ndef test_large_number_of_paths():\\n    edges = [(i, i + 1) for i in range(1, 100)]\\n    assert longest_route(99, edges) == 99\"}]", "ground_truth": "[\"from collections import defaultdict\\n\\ndef longest_route(m, edges):\\n    \\\"\\\"\\\"\\n    Finds the length of the longest route in a directed graph.\\n    \\n    Args:\\n    m (int): Number of directed paths.\\n    edges (list of tuples): Each tuple contains two integers (u, v) representing the directed path from u to v.\\n    \\n    Returns:\\n    int: Length of the longest route.\\n    \\\"\\\"\\\"\\n    \\n    graph = defaultdict(list)\\n    for u, v in edges:\\n        graph[u].append(v)\\n    \\n    def dfs(vertex, visited, memo):\\n        if vertex in memo:\\n            return memo[vertex]\\n        \\n        max_length = 0\\n        visited.add(vertex)\\n        for neighbor in graph[vertex]:\\n            if neighbor not in visited:\\n                route_length = 1 + dfs(neighbor, visited, memo)\\n                max_length = max(max_length, route_length)\\n        visited.remove(vertex)\\n        \\n        memo[vertex] = max_length\\n        return max_length\\n    \\n    memo = {}\\n    max_route_length = 0\\n    for landmark in range(1, 101):\\n        visited = set()\\n        max_route_length = max(max_route_length, dfs(landmark, visited, memo))\\n    \\n    return max_route_length\"]", "case_type": "pytest", "test_case_function": " ", "test_cases": "[{\"assert_code\": \"\\n\\n\\ndef test_simple_case():\\n    assert longest_route(3, [(1, 2), (2, 3), (3, 4)]) == 3\\n\\ndef test_single_path():\\n    assert longest_route(1, [(1, 2)]) == 1\\n\\ndef test_cyclic_path():\\n    assert longest_route(3, [(1, 2), (2, 3), (3, 1)]) == 2\\n\\ndef test_multiple_paths():\\n    assert longest_route(5, [(1, 2), (1, 3), (2, 4), (3, 4), (4, 5)]) == 3\\n\\ndef test_no_path():\\n    assert longest_route(0, []) == 0\\n\\ndef test_disconnected_graph():\\n    assert longest_route(4, [(1, 2), (3, 4), (5, 6), (7, 8)]) == 1\\n\\ndef test_large_number_of_paths():\\n    edges = [(i, i + 1) for i in range(1, 100)]\\n    assert longest_route(99, edges) == 99\"}]", "tag": "KodCode"}
